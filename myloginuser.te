policy_module(myloginuser, 1.0.0)

## <desc>
##	<p>
##	Determine whether ssh logins are permitted.
##	</p>
## </desc>
gen_tunable(myloginuser_enable_ssh_login, true)

## <desc>
##	<p>
##	Determine whether local logins are permitted.
##	</p>
## </desc>
gen_tunable(myloginuser_enable_local_login, true)

## <desc>
##	<p>
##	Determine whether xdm logins are permitted.
##	</p>
## </desc>
gen_tunable(myloginuser_enable_xdm_login, true)

## <desc>
##	<p>
##	Determine whether numad can schedule
##	user tasks.
##	</p>
## </desc>
gen_tunable(myloginuser_numad_support, false)

## <desc>
##      <p>
##      Determine whether cgred can read 
##      user state files.
##      </p>
## </desc>
gen_tunable(myloginuser_cgred_support, false)

## <desc>
##      <p>
##      Determine whether unconfined can read 
##      user state files.
##      </p>
## </desc>
gen_tunable(myloginuser_unconfined_support, true)

## <desc>
##      <p>
##      Determine whether ksmtuned can read
##      user state files.
##      </p>
## </desc>
gen_tunable(myloginuser_ksmtuned_support, false)

########################################
#
# Global requirements
#

gen_require(`
	class context contains;
	class dbus { acquire_svc send_msg };
	class system status;

	attribute process_user_target, file_type, non_security_file_type;
	attribute non_auth_file_type, exec_type, application_exec_type;
	attribute domain, tmpfile, unreserved_port_type;
	attribute proc_type, filesystem_type, sysctl_type;
	attribute init_script_file_type, device_node, logfile;

	attribute user_tmp_type, user_home_type;
	
	type urandom_device_t, fs_t, devlog_t, syslogd_t;
	type net_conf_t, proc_t, sysfs_t, kernel_t;
	type passwd_file_t, var_lib_t, tmp_t, fonts_t;
	type fonts_cache_t, local_login_t, tty_device_t;
	type console_device_t, user_tty_device_t, init_t;
	type user_home_t, user_home_dir_t, home_root_t;
	type user_tmp_t, bin_t, shell_exec_t, cert_t;
	type random_device_t, textrel_shlib_t, virtio_device_t;
	type admin_home_t, ssh_port_t, ldap_port_t;
	type pgpkeyserver_port_t, user_devpts_t, bootloader_exec_t;
        type ld_so_t, lib_t, ld_so_cache_t, device_t;
	type devtty_t, ptmx_t, hwdata_t, locale_t;
	type null_device_t, security_t, usr_t, etc_t;
        type root_t, var_t, devpts_t, var_run_t;
	type cpu_online_t, sysctl_kernel_t, var_spool_t;
	type setrans_var_run_t, pam_var_console_t, syslogd_var_run_t;
        type ephemeral_port_t, shadow_t, chkpwd_exec_t;
	type vnc_port_t, default_context_t, selinux_config_t;
	type fuse_device_t, fusefs_t, debugfs_t;
	type cgroup_t, wireless_device_t, initrc_var_run_t;
	type init_var_run_t, restorecond_exec_t, cgroup_t;
	type sound_device_t, dnssec_port_t, sysctl_fs_t;
	type ipp_port_t, node_t, proc_net_t, mnt_t;
	type hugetlbfs_t, fixed_disk_device_t, initctl_t;
	type wtmp_t, smbd_port_t, http_port_t, auditd_log_t;
	type tmpfs_t, dri_device_t;
')

########################################
#
# Global declarations
#

attribute myloginuserprocess;
attribute myloginuser_application_executable_type;

attribute started_by_user_session_bus;
attribute started_by_user_session_bus_exec_type;

attribute started_by_user_gvfsd;
attribute started_by_user_gvfsd_exec_type;

attribute started_by_user;
attribute started_by_user_exec_type;

attribute started_by_user_gsession;
attribute started_by_user_gsession_exec_type;

attribute started_by_user_gsetd;
attribute started_by_user_gsetd_exec_type;

attribute started_by_user_gshell;
attribute started_by_user_gshell_exec_type;

attribute started_by_user_naut;
attribute started_by_user_naut_exec_type;

attribute started_by_user_gsetdlocaleexec;
attribute started_by_user_gsetdlocaleexec_exec_type;

attribute started_by_user_sshagent;
attribute started_by_user_sshagent_exec_type;

attribute runs_dbusd;
attribute runs_dbuslaunch;
attribute runs_gjsconsole;
attribute runs_gptyhelper;
attribute runs_gpg;
attribute runs_evince;
attribute runs_nautilus;
attribute runs_pulseaudio;
attribute runs_yelp;

attribute connects_to_server_with_unix_stream_socket;
attribute reads_xdm_runtime_files;

attribute traverses_tmp;
attribute lists_tmp;
attribute adds_entries_to_tmp_dirs;
attribute removes_entries_from_tmp_dirs;

attribute traverses_var_lib;
attribute traverses_system_dbusd_var_lib;

attribute reads_passwd_files;

attribute lists_ssh_home;
attribute reads_ssh_home_files;
attribute manages_ssh_home;
attribute adds_entries_to_ssh_home_dirs;

attribute gkrd_reads_state;

attribute reads_init_state;
attribute traverses_init_runtime;
attribute reads_initrc_runtime_files;

attribute reads_system_state_files;

attribute reads_kernel_sysctl_files;
attribute reads_cpu_online_files;

attribute reads_logind_sessions;
attribute reads_logind_runtime;

attribute reads_bash_home_files;
attribute reads_recentlyused_data_home_files;

attribute traverses_user_tmp;
attribute lists_user_tmp;
attribute adds_entries_to_user_tmp_dirs;
attribute removes_entries_from_user_tmp_dirs;

attribute traverses_admin_home_dir;
attribute adds_entries_to_admin_home_dirs;

attribute traverses_user_home_dir;
attribute lists_user_home_dir;
attribute adds_entries_to_user_home_dirs;
attribute removes_entries_from_user_home_dirs;

attribute traverses_all_user_home_content_dirs;
attribute lists_all_user_home_content_dirs;

attribute creates_config_home_dirs;
attribute traverses_config_home;
attribute lists_config_home;
attribute adds_entries_to_config_home_dirs;
attribute removes_entries_from_config_home_dirs;

attribute creates_data_home_dirs;
attribute traverses_data_home;
attribute lists_data_home;
attribute adds_entries_to_data_home_dirs;
attribute removes_entries_from_data_home_dirs;
attribute reads_metadata_data_home_files;

attribute creates_cache_home_dirs;
attribute traverses_cache_home;
attribute lists_cache_home;
attribute adds_entries_to_cache_home_dirs;
attribute removes_entries_from_cache_home_dirs;

attribute manages_recentlyused_data_home_files;
attribute manages_gtk_bookmarks;

attribute reads_esc_cache_home_files;

attribute reads_iceauth_home_files;

attribute reads_pulseaudio_home_files;

attribute appends_xdm_home_files;

attribute traverses_gtk_home;

attribute reads_gconf_config_files;

attribute traverses_thumb_home;
attribute lists_thumb_home;
attribute manages_thumb_home;
attribute gets_attributes_of_thumb_home_files;

attribute reads_myloginuserprocess_state;

attribute traverses_gconf_home;
attribute lists_gconf_home;
attribute adds_entries_to_gconf_home_dirs;
attribute creates_gconf_home_dirs;

attribute reads_xdg_config_home_files;
attribute reads_dconf_config_home_files;
attribute creates_dconf_runtime_files;

attribute creates_ibus_config_home_dirs;

attribute reads_fonts;
attribute reads_system_certificates;
attribute lists_system_certificates;

attribute reads_network_config_files;
attribute reads_udev_runtime_files;

attribute lists_sysfs;
attribute reads_sysfs;

attribute reads_hwdata;

attribute traverses_devpts;

attribute traverses_cgroup;
attribute lists_cgroup;

attribute traverses_sounds_data_home;
attribute lists_sounds_data_home;
attribute creates_sounds_data_home_dirs;

attribute logs_to_system;

attribute reads_urandom_device;
attribute reads_random_device;

attribute gsysmon_reads_process_state;

attribute is_pulseaudio_client;
attribute manages_pulseaudio_tmp_content;

attribute gets_attributes_of_xattr_fs;

attribute connects_to_cups;
attribute reads_cups_config_files;

attribute connects_to_system_bus;
attribute aqcuires_service_on_system_bus;

attribute connects_to_user_session_bus;
attribute aqcuires_service_on_user_session_bus;

attribute chats_with_hotplugsniff;
attribute chats_with_gkrd;
attribute chats_with_gvfsd;
attribute chats_with_gshell;
attribute chats_with_gsession;
attribute chats_with_pulseaudio;
attribute chats_with_gsetd;
attribute chats_with_nmappl;
attribute chats_with_trminerfs;
attribute chats_with_tpmc;
attribute chats_with_pkexec;
attribute chats_with_policykitauth;
attribute chats_with_atspi;
attribute chats_with_atspi2;
attribute chats_with_dconf;
attribute chats_with_gconfd2;
attribute chats_with_naut;
attribute chats_with_imsetd;
attribute chats_with_dejadupmon;
attribute chats_with_gvfsd_udiskmon;
attribute chats_with_gvfsd_gphotovolmon;
attribute chats_with_gvfsd_afcvolmon;
attribute chats_with_gvfsd_metadata;
attribute chats_with_gvfsd_trash;
attribute chats_with_gvfsd_http;
attribute chats_with_seappl;
attribute chats_with_gdtrackergdatam;
attribute chats_with_goad;
attribute chats_with_trstore;
attribute chats_with_evoalarm;
attribute chats_with_evosrcreg;
attribute chats_with_gconsrchp;
attribute chats_with_gshellcald;
attribute chats_with_abrtappl;
attribute chats_with_gtermd;
attribute chats_with_gjsconsole;
attribute chats_with_vinod;
attribute chats_with_gvfsd_network;
attribute chats_with_gvfsd_dnssd;
attribute chats_with_gvfsd_sftp;
attribute chats_with_baobab;
attribute chats_with_evince;

attribute connects_to_user_gkrd;

########################################
#
# myloginuser declarations
# 

type myloginuser_t, myloginuserprocess;
role myloginuser_r;
role myloginuser_r types myloginuser_t;
allow system_r myloginuser_r;

attribute inherits_user_fd;
attribute reads_user_state_files;

type bash_home_t;
typeattribute bash_home_t file_type;
typeattribute bash_home_t user_home_type;

########################################   
#
# myloginuserprocess
#

allow myloginuserprocess self:process { getsched setsched signal };
dontaudit myloginuserprocess myloginuserprocess:process { noatsecure siginh rlimitinh };

########################################
#
# myloginuserprocess grouped policy
#

allow reads_myloginuserprocess_state myloginuserprocess:dir { getattr search };
allow reads_myloginuserprocess_state myloginuserprocess:file { getattr read open };
allow reads_myloginuserprocess_state myloginuserprocess:lnk_file read;

########################################
#
# myloginuser
#

typeattribute myloginuser_t process_user_target;

typeattribute myloginuser_t traverses_config_home;
typeattribute myloginuser_t lists_config_home;
typeattribute myloginuser_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_t creates_config_home_dirs;

typeattribute myloginuser_t traverses_tmp;
typeattribute myloginuser_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_t traverses_user_home_dir;
typeattribute myloginuser_t lists_user_home_dir;
typeattribute myloginuser_t adds_entries_to_user_home_dirs;
typeattribute myloginuser_t removes_entries_from_user_home_dirs;
typeattribute myloginuser_t manages_ssh_home;

typeattribute myloginuser_t traverses_cache_home;
typeattribute myloginuser_t traverses_gconf_home;

typeattribute myloginuser_t reads_bash_home_files;

typeattribute myloginuser_t reads_system_state_files;
typeattribute myloginuser_t reads_myloginuserprocess_state;

typeattribute myloginuser_t reads_urandom_device;

typeattribute myloginuser_t reads_kernel_sysctl_files;
typeattribute myloginuser_t reads_cpu_online_files;

typeattribute myloginuser_t reads_initrc_runtime_files;

typeattribute myloginuser_t reads_hwdata;

typeattribute myloginuser_t reads_sysfs;
typeattribute myloginuser_t lists_sysfs;

typeattribute myloginuser_t reads_kernel_sysctl_files;
typeattribute myloginuser_t reads_cpu_online_files;
typeattribute myloginuser_t reads_initrc_runtime_files;
typeattribute myloginuser_t traverses_devpts;

typeattribute myloginuser_t appends_xdm_home_files;

allow myloginuser_t self:context contains;
allow myloginuser_t self:process { fork sigchld setpgid };
allow myloginuser_t self:fifo_file { read write getattr ioctl };
allow myloginuser_t self:unix_dgram_socket { create connect };
allow myloginuser_t self:unix_stream_socket { create connect };

dontaudit myloginuser_t self:netlink_audit_socket { create nlmsg_relay write };
dontaudit myloginuser_t devlog_t:sock_file write;

allow myloginuser_t bash_home_t:file { create setattr write append rename link unlink ioctl lock relabelto relabelfrom };
type_transition myloginuser_t user_home_dir_t:file bash_home_t ".bash_history";
type_transition myloginuser_t user_home_dir_t:file bash_home_t ".bash_logout";
type_transition myloginuser_t user_home_dir_t:file bash_home_t ".bash_profile";
type_transition myloginuser_t user_home_dir_t:file bash_home_t ".bashrc";

allow myloginuser_t { bin_t shell_exec_t }:file { read entrypoint };

allow myloginuser_t { user_tty_device_t user_devpts_t }:chr_file { getattr open read setattr write ioctl };
allow myloginuser_t devtty_t:chr_file { read write ioctl open };
allow myloginuser_t ptmx_t:chr_file { read write ioctl };

allow myloginuser_t init_t:process sigchld;

allow myloginuser_t initrc_var_run_t:file lock;

dontaudit myloginuser_t domain:dir getattr;

allow myloginuser_t myloginuserprocess:process getattr;
allow myloginuser_t myloginuserprocess:dir { read open };

allow myloginuser_t bootloader_exec_t:file { read getattr open execute };

allow myloginuser_t init_script_file_type:file { execute getattr };

allow myloginuser_t ld_so_t:file { read execute getattr open };
allow myloginuser_t ld_so_cache_t:file { read getattr open };

allow myloginuser_t lib_t:dir { read open search };
allow myloginuser_t lib_t:file { read open getattr execute };
allow myloginuser_t lib_t:lnk_file read;

allow myloginuser_t bin_t:dir { getattr search };
allow myloginuser_t { shell_exec_t bin_t }:file { read execute getattr open execute_no_trans ioctl };
allow myloginuser_t bin_t:lnk_file read;

allow myloginuser_t locale_t:dir { getattr search };
allow myloginuser_t locale_t:lnk_file read;
allow myloginuser_t locale_t:file { read getattr open };

allow myloginuser_t null_device_t:chr_file { write getattr open ioctl };

dontaudit myloginuser_t passwd_file_t:file getattr;
allow myloginuser_t passwd_file_t:file { read open };

allow myloginuser_t proc_t:dir { read open };

allow myloginuser_t security_t:dir { getattr search };
allow myloginuser_t security_t:filesystem getattr;
allow myloginuser_t security_t:file { read getattr open };

allow myloginuser_t usr_t:dir { getattr search read open };
allow myloginuser_t usr_t:file { read getattr open };

allow myloginuser_t etc_t:dir { getattr search };
allow myloginuser_t etc_t:file { read getattr open ioctl };
allow myloginuser_t etc_t:lnk_file read;

allow myloginuser_t home_root_t:dir search;
allow myloginuser_t user_home_dir_t:dir { setattr lock ioctl };
allow myloginuser_t user_home_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl relabelto relabelfrom };
allow myloginuser_t user_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock relabelto relabelfrom };
allow myloginuser_t user_home_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock relabelto relabelfrom };
type_transition myloginuser_t user_home_dir_t:{ dir file lnk_file } user_home_t;

allow myloginuser_t user_tmp_t:file { read create ioctl write getattr unlink open append };
type_transition myloginuser_t tmp_t:file user_tmp_t;

allow myloginuser_t { root_t var_t var_run_t var_spool_t }:dir search;
allow myloginuser_t var_run_t:lnk_file read;

allow myloginuser_t null_device_t:chr_file { open read };

allow myloginuser_t setrans_var_run_t:dir { getattr search };

allow myloginuser_t filesystem_type:filesystem getattr;

dontaudit myloginuser_t file_type:{ dir file } getattr;

allow myloginuser_t imsetd_cache_home_t:dir { getattr search write remove_name add_name };
allow myloginuser_t imsetd_cache_home_t:file { getattr open append rename write create unlink };

allow myloginuser_t imsets_config_home_t:dir { getattr create search };

allow myloginuser_t { myloginuser_gptyhelper_t myloginuser_gtermd_t myloginuser_gterm_t }:fd use;
allow myloginuser_t { myloginuser_gtermd_t myloginuser_gterm_t }:process sigchld;

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_t config_home_t:dir imsets_config_home_t "imsettings";
')

optional_policy(`
	gen_require(`
		type ssh_home_t;
	')

	allow myloginuser_t ssh_home_t:dir { relabelto relabelfrom };
	allow myloginuser_t ssh_home_t:file { relabelto relabelfrom };
')

optional_policy(`
	gen_require(`
		type mail_spool_t;
	')

	allow myloginuser_t mail_spool_t:dir { getattr search };
	allow myloginuser_t mail_spool_t:file getattr;
')

optional_policy(`
	gen_require(`
		type xdm_t, xdm_etc_t;
	')

	allow myloginuser_t xdm_etc_t:dir { getattr search };
	allow myloginuser_t xdm_etc_t:lnk_file read;

	allow myloginuser_t xdm_t:unix_stream_socket { getattr ioctl };
')

optional_policy(`
	gen_require(`
		type system_dbusd_var_run_t;
	')

	allow myloginuser_t system_dbusd_var_run_t:dir { getattr search };
')

########################################
# 
# myloginuser grouped policy
#

allow inherits_user_fd myloginuser_t:fd use;

allow reads_user_state_files myloginuser_t:dir { getattr search };
allow reads_user_state_files myloginuser_t:file { read getattr open };
allow reads_user_state_files myloginuser_t:lnk_file read;

allow lists_user_tmp user_tmp_t:dir { read open };
allow traverses_user_tmp user_tmp_t:dir { search getattr };
allow adds_entries_to_user_tmp_dirs user_tmp_t:dir { write add_name };
allow removes_entries_from_user_tmp_dirs user_tmp_t:dir { write remove_name };

allow lists_user_home_dir user_home_dir_t:dir { read open };
allow traverses_user_home_dir { home_root_t user_home_dir_t }:dir { getattr search };
allow adds_entries_to_user_home_dirs user_home_dir_t:dir { write add_name };
allow removes_entries_from_user_home_dirs user_home_dir_t:dir { write remove_name };

allow traverses_admin_home_dir admin_home_t:dir { getattr search };
allow adds_entries_to_admin_home_dirs admin_home_t:dir { write add_name };

allow reads_bash_home_files bash_home_t:file { getattr open read };

allow traverses_all_user_home_content_dirs user_home_type:dir { getattr search };
allow lists_all_user_home_content_dirs user_home_type:dir { open read };

########################################
#
# myloginuser policy (all user application domains)
#

allow started_by_user myloginuser_t:fd use;
allow started_by_user myloginuser_t:fifo_file { read write getattr ioctl };
allow started_by_user myloginuser_t:process sigchld;

allow myloginuser_t started_by_user_exec_type:file { getattr open read execute };
allow myloginuser_t started_by_user:process transition;

########################################
#
# hostname
#

optional_policy(`
	gen_require(`
		type hostname_t, hostname_exec_t;
	')

	typeattribute hostname_t inherits_user_fd;

	allow hostname_t myloginuser_sshagent_t:fd use;
	allow hostname_t { myloginuser_sshagent_t myloginuser_t }:fifo_file { read write getattr ioctl };
	allow hostname_t { myloginuser_sshagent_t myloginuser_t }:process sigchld;

	allow { myloginuser_sshagent_t myloginuser_t } hostname_exec_t:file { getattr open read execute };
	allow { myloginuser_sshagent_t myloginuser_t } hostname_t:process transition;
	dontaudit { myloginuser_sshagent_t myloginuser_t } hostname_t:process { noatsecure siginh rlimitinh };
	type_transition { myloginuser_sshagent_t myloginuser_t } hostname_exec_t:process hostname_t;

	role myloginuser_r types hostname_t;
')

########################################
#
# gkrd
#

type myloginuser_gkrd_t, myloginuserprocess;
typeattribute myloginuser_gkrd_t domain;
role myloginuser_r types myloginuser_gkrd_t;

type gkrd_tmp_t;
typeattribute gkrd_tmp_t file_type;
typeattribute gkrd_tmp_t tmpfile;
typeattribute gkrd_tmp_t user_tmp_type;

typeattribute myloginuser_gkrd_t process_user_target;

typeattribute myloginuser_gkrd_t started_by_user;
typeattribute myloginuser_gkrd_t started_by_user_gsession;

typeattribute myloginuser_gkrd_t traverses_user_tmp;
typeattribute myloginuser_gkrd_t lists_user_tmp;
typeattribute myloginuser_gkrd_t adds_entries_to_user_tmp_dirs;
typeattribute myloginuser_gkrd_t removes_entries_from_user_tmp_dirs;
typeattribute myloginuser_gkrd_t creates_dconf_runtime_files;

typeattribute myloginuser_gkrd_t traverses_user_home_dir;
typeattribute myloginuser_gkrd_t adds_entries_to_user_home_dirs;
typeattribute myloginuser_gkrd_t reads_ssh_home_files;
typeattribute myloginuser_gkrd_t lists_ssh_home;

typeattribute myloginuser_gkrd_t traverses_config_home;
typeattribute myloginuser_gkrd_t reads_dconf_config_home_files;

typeattribute myloginuser_gkrd_t adds_entries_to_gconf_home_dirs;
typeattribute myloginuser_gkrd_t creates_gconf_home_dirs;

typeattribute myloginuser_gkrd_t traverses_data_home;
typeattribute myloginuser_gkrd_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_gkrd_t creates_data_home_dirs;

typeattribute myloginuser_gkrd_t reads_passwd_files;

typeattribute myloginuser_gkrd_t reads_system_state_files;

typeattribute myloginuser_gkrd_t reads_urandom_device;
typeattribute myloginuser_gkrd_t reads_random_device;

typeattribute myloginuser_gkrd_t reads_system_certificates;
typeattribute myloginuser_gkrd_t lists_system_certificates;

typeattribute myloginuser_gkrd_t appends_xdm_home_files;

typeattribute myloginuser_gkrd_t logs_to_system;

typeattribute myloginuser_gkrd_t connects_to_user_session_bus;
typeattribute myloginuser_gkrd_t aqcuires_service_on_user_session_bus;

allow myloginuser_gkrd_t self:capability ipc_lock;
allow myloginuser_gkrd_t self:process setcap;
allow myloginuser_gkrd_t self:unix_stream_socket connectto;

allow myloginuser_gkrd_t user_tmp_t:dir { setattr lock ioctl };
allow myloginuser_gkrd_t gkrd_tmp_t:dir { write getattr search rmdir remove_name create add_name };
allow myloginuser_gkrd_t gkrd_tmp_t:sock_file { create unlink write getattr };
type_transition myloginuser_gkrd_t user_tmp_t:dir gkrd_tmp_t;

allow myloginuser_gkrd_t gkrd_reads_state:dir { getattr search };
allow myloginuser_gkrd_t gkrd_reads_state:file { getattr open read };
allow myloginuser_gkrd_t gkrd_reads_state:lnk_file read;

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	allow myloginuser_gkrd_t xdm_t:fifo_file { write read getattr };
	allow myloginuser_gkrd_t xdm_t:unix_stream_socket { getattr };
')

optional_policy(`
	gen_require(`
		type gkeyringd_exec_t;
	')

	typeattribute gkeyringd_exec_t started_by_user_exec_type;
	typeattribute gkeyringd_exec_t started_by_user_gsession_exec_type;

	type_transition { myloginuser_gsession_t myloginuser_t } gkeyringd_exec_t:process myloginuser_gkrd_t;

	allow myloginuser_gkrd_t gkeyringd_exec_t:file { read entrypoint }; 
	dontaudit myloginuser_t gkeyringd_exec_t:file entrypoint;
')

optional_policy(`
	gen_require(`
		type dbusd_exec_t;
	')

	allow myloginuser_gkrd_t dbusd_exec_t:file { read entrypoint };
')

optional_policy(`
	gen_require(`
		type gkeyringd_gnome_home_t, data_home_t;
	')

	allow myloginuser_gkrd_t gkeyringd_gnome_home_t:dir { create getattr search read write open add_name remove_name };
	allow myloginuser_gkrd_t gkeyringd_gnome_home_t:file { rename read create write getattr link unlink open };
	type_transition myloginuser_gkrd_t data_home_t:dir gkeyringd_gnome_home_t "keyrings";
')

########################################
#
# gkrd grouped policy
#

allow connects_to_user_gkrd gkrd_tmp_t:dir { getattr search };
allow connects_to_user_gkrd myloginuser_gkrd_t:unix_stream_socket connectto;
allow connects_to_user_gkrd gkrd_tmp_t:sock_file { getattr write };

########################################
#
# dbusd
#

type myloginuser_dbusd_t, myloginuserprocess;
typeattribute myloginuser_dbusd_t domain;
role myloginuser_r types myloginuser_dbusd_t;

typeattribute myloginuser_dbusd_t runs_nautilus;

typeattribute myloginuser_dbusd_t inherits_user_fd;

typeattribute myloginuser_dbusd_t traverses_admin_home_dir;
typeattribute myloginuser_dbusd_t traverses_user_home_dir;

typeattribute myloginuser_dbusd_t traverses_data_home;

typeattribute myloginuser_dbusd_t reads_passwd_files;

typeattribute myloginuser_dbusd_t reads_myloginuserprocess_state;

typeattribute myloginuser_dbusd_t reads_urandom_device;

typeattribute myloginuser_dbusd_t logs_to_system;

allow myloginuser_dbusd_t runs_dbusd:fd use;
allow myloginuser_dbusd_t runs_dbusd:fifo_file { read write getattr ioctl };
allow myloginuser_dbusd_t runs_dbusd:process sigchld;

allow runs_dbusd myloginuser_dbusd_t:process transition;

allow myloginuser_dbusd_t self:capability sys_resource;
allow myloginuser_dbusd_t self:capability2 block_suspend;
allow myloginuser_dbusd_t self:process { setrlimit sigkill };
allow myloginuser_dbusd_t self:netlink_selinux_socket { bind create read };

allow myloginuser_dbusd_t selinux_config_t:dir { getattr search };
allow myloginuser_dbusd_t selinux_config_t:file { read getattr open };

allow myloginuser_dbusd_t security_t:file { read open write };
allow myloginuser_dbusd_t security_t:security compute_av;

allow myloginuser_dbusd_t default_context_t:dir search;
allow myloginuser_dbusd_t default_context_t:file { read getattr open };

allow myloginuser_dbusd_t { myloginuser_t myloginuser_logview_t }:fifo_file write;

allow myloginuser_dbusd_t myloginuser_trminerfs_t:fifo_file { read write };

allow myloginuser_dbusd_t pam_var_console_t:dir { getattr search };

allow myloginuser_dbusd_t shell_exec_t:file execute;

optional_policy(`
	gen_require(`
		type dbusd_exec_t, dbusd_etc_t;
	')

	allow myloginuser_dbusd_t dbusd_exec_t:file { read entrypoint };

	allow runs_dbusd dbusd_exec_t:file { getattr open read execute };
	type_transition runs_dbusd dbusd_exec_t:process myloginuser_dbusd_t;

	allow myloginuser_dbusd_t dbusd_exec_t:file { getattr open execute execute_no_trans };

	allow myloginuser_dbusd_t dbusd_etc_t:dir { read search open };
	allow myloginuser_dbusd_t dbusd_etc_t:file { read getattr open };
')

optional_policy(`
	gen_require(`
		type thumb_t;
	')

	allow myloginuser_dbusd_t thumb_t:dir { getattr search };
	allow myloginuser_dbusd_t thumb_t:file { getattr read open };
	allow myloginuser_dbusd_t thumb_t:lnk_file read;
')

########################################
#
# dbusd (all user session bus domains)
#

allow started_by_user_session_bus myloginuser_dbusd_t:fd use;
allow started_by_user_session_bus myloginuser_dbusd_t:fifo_file { read write getattr ioctl };
allow started_by_user_session_bus myloginuser_dbusd_t:process sigchld;

allow myloginuser_dbusd_t started_by_user_session_bus_exec_type:file { getattr open read execute };
allow myloginuser_dbusd_t started_by_user_session_bus:process transition;

########################################
#
# dbusd grouped policy
#

allow connects_to_user_session_bus myloginuser_dbusd_t:unix_stream_socket connectto;
allow connects_to_user_session_bus myloginuser_dbusd_t:dbus send_msg;

allow runs_dbusd myloginuser_dbusd_t:process signal;

allow aqcuires_service_on_user_session_bus myloginuser_dbusd_t:dbus acquire_svc;
allow aqcuires_service_on_user_session_bus self:dbus send_msg;

allow aqcuires_service_on_system_bus self:dbus send_msg;

allow chats_with_hotplugsniff myloginuser_hotplugsniff_t:dbus send_msg;
allow myloginuser_hotplugsniff_t chats_with_hotplugsniff:dbus send_msg;

allow chats_with_gkrd myloginuser_gkrd_t:dbus send_msg;
allow myloginuser_gkrd_t chats_with_gkrd:dbus send_msg;

allow chats_with_gvfsd myloginuser_gvfsd_t:dbus send_msg;
allow myloginuser_gvfsd_t chats_with_gvfsd:dbus send_msg;

allow chats_with_gshell myloginuser_gshell_t:dbus send_msg;
allow myloginuser_gshell_t chats_with_gshell:dbus send_msg;

allow chats_with_gsession myloginuser_gsession_t:dbus send_msg;
allow myloginuser_gsession_t chats_with_gsession:dbus send_msg;

allow chats_with_pulseaudio myloginuser_pulseaudio_t:dbus send_msg;
allow myloginuser_pulseaudio_t chats_with_pulseaudio:dbus send_msg;

allow chats_with_gsetd myloginuser_gsetd_t:dbus send_msg;
allow myloginuser_gsetd_t chats_with_gsetd:dbus send_msg;

allow chats_with_nmappl myloginuser_nmappl_t:dbus send_msg;
allow myloginuser_nmappl_t chats_with_nmappl:dbus send_msg;

allow chats_with_trminerfs myloginuser_trminerfs_t:dbus send_msg;
allow myloginuser_trminerfs_t chats_with_trminerfs:dbus send_msg;

allow chats_with_tpmc myloginuser_tpmc_t:dbus send_msg;
allow myloginuser_tpmc_t chats_with_tpmc:dbus send_msg;

allow chats_with_pkexec myloginuser_pkexec_t:dbus send_msg;
allow myloginuser_pkexec_t chats_with_pkexec:dbus send_msg;

allow chats_with_policykitauth myloginuser_policykitauth_t:dbus send_msg;
allow myloginuser_policykitauth_t chats_with_policykitauth:dbus send_msg;

allow chats_with_atspi2 myloginuser_atspi2_t:dbus send_msg;
allow myloginuser_atspi2_t chats_with_atspi2:dbus send_msg;

allow chats_with_dconf myloginuser_dconf_t:dbus send_msg;
allow myloginuser_dconf_t chats_with_dconf:dbus send_msg;

allow chats_with_gconfd2 myloginuser_gconfd2_t:dbus send_msg;
allow myloginuser_gconfd2_t chats_with_gconfd2:dbus send_msg;

allow chats_with_naut myloginuser_naut_t:dbus send_msg;
allow myloginuser_naut_t chats_with_naut:dbus send_msg;

allow chats_with_atspi myloginuser_atspi_t:dbus send_msg;
allow myloginuser_atspi_t chats_with_atspi:dbus send_msg;

allow chats_with_imsetd myloginuser_imsetd_t:dbus send_msg;
allow myloginuser_imsetd_t chats_with_imsetd:dbus send_msg;

allow chats_with_dejadupmon myloginuser_dejadupmon_t:dbus send_msg;
allow myloginuser_dejadupmon_t chats_with_dejadupmon:dbus send_msg;

allow chats_with_gvfsd_udiskmon myloginuser_gvfsd_udiskmon_t:dbus send_msg;
allow myloginuser_gvfsd_udiskmon_t chats_with_gvfsd_udiskmon:dbus send_msg;

allow chats_with_gvfsd_gphotovolmon myloginuser_gvfsd_gphotovolmon_t:dbus send_msg;
allow myloginuser_gvfsd_gphotovolmon_t chats_with_gvfsd_gphotovolmon:dbus send_msg;

allow chats_with_gvfsd_afcvolmon myloginuser_gvfsd_afcvolmon_t:dbus send_msg;
allow myloginuser_gvfsd_afcvolmon_t chats_with_gvfsd_afcvolmon:dbus send_msg;

allow chats_with_gvfsd_metadata myloginuser_gvfsd_metadata_t:dbus send_msg;
allow myloginuser_gvfsd_metadata_t chats_with_gvfsd_metadata:dbus send_msg;

allow chats_with_seappl myloginuser_seappl_t:dbus send_msg;
allow myloginuser_seappl_t chats_with_seappl:dbus send_msg;

allow chats_with_gdtrackergdatam myloginuser_gdtrackergdatam_t:dbus send_msg;
allow myloginuser_gdtrackergdatam_t chats_with_gdtrackergdatam:dbus send_msg;

allow chats_with_goad myloginuser_goad_t:dbus send_msg;
allow myloginuser_goad_t chats_with_goad:dbus send_msg;

allow chats_with_trstore myloginuser_trstore_t:dbus send_msg;
allow myloginuser_trstore_t chats_with_trstore:dbus send_msg;

allow chats_with_evoalarm myloginuser_evoalarm_t:dbus send_msg;
allow myloginuser_evoalarm_t chats_with_evoalarm:dbus send_msg;

allow chats_with_evosrcreg myloginuser_evosrcreg_t:dbus send_msg;
allow myloginuser_evosrcreg_t chats_with_evosrcreg:dbus send_msg;

allow chats_with_gconsrchp myloginuser_gconsrchp_t:dbus send_msg;
allow myloginuser_gconsrchp_t chats_with_gconsrchp:dbus send_msg;

allow chats_with_gshellcald myloginuser_gshellcald_t:dbus send_msg;
allow myloginuser_gshellcald_t chats_with_gshellcald:dbus send_msg;

allow chats_with_abrtappl myloginuser_abrtappl_t:dbus send_msg;
allow myloginuser_abrtappl_t chats_with_abrtappl:dbus send_msg;

allow chats_with_gtermd myloginuser_gtermd_t:dbus send_msg;
allow myloginuser_gtermd_t chats_with_gtermd:dbus send_msg;

allow chats_with_gjsconsole myloginuser_gjsconsole_t:dbus send_msg;
allow myloginuser_gjsconsole_t chats_with_gjsconsole:dbus send_msg;

allow chats_with_vinod myloginuser_vinod_t:dbus send_msg;
allow myloginuser_vinod_t chats_with_vinod:dbus send_msg;

allow chats_with_gvfsd_network myloginuser_gvfsd_network_t:dbus send_msg;
allow myloginuser_gvfsd_network_t chats_with_gvfsd_network:dbus send_msg;

allow chats_with_gvfsd_dnssd myloginuser_gvfsd_dnssd_t:dbus send_msg;
allow myloginuser_gvfsd_dnssd_t chats_with_gvfsd_dnssd:dbus send_msg;

allow chats_with_gvfsd_sftp myloginuser_gvfsd_sftp_t:dbus send_msg;
allow myloginuser_gvfsd_sftp_t chats_with_gvfsd_sftp:dbus send_msg;

allow chats_with_gvfsd_trash myloginuser_gvfsd_trash_t:dbus send_msg;
allow myloginuser_gvfsd_trash_t chats_with_gvfsd_trash:dbus send_msg;

allow chats_with_gvfsd_http myloginuser_gvfsd_http_t:dbus send_msg;
allow myloginuser_gvfsd_http_t chats_with_gvfsd_http:dbus send_msg;

allow chats_with_baobab myloginuser_baobab_t:dbus send_msg;
allow myloginuser_baobab_t chats_with_baobab:dbus send_msg;

allow chats_with_evince myloginuser_evince_t:dbus send_msg;
allow myloginuser_evince_t chats_with_evince:dbus send_msg;

optional_policy(`
	gen_require(`
		type system_dbusd_t, system_dbusd_var_lib_t, system_dbusd_var_run_t;
	')

	allow connects_to_system_bus system_dbusd_t:unix_stream_socket connectto;
	allow connects_to_system_bus system_dbusd_var_run_t:dir { getattr search };
	allow connects_to_system_bus system_dbusd_var_run_t:sock_file write;
	allow connects_to_system_bus system_dbusd_t:dbus send_msg;

	allow traverses_system_dbusd_var_lib system_dbusd_var_lib_t:dir { getattr search };

	allow aqcuires_service_on_system_bus system_dbusd_t:dbus acquire_svc;
')

########################################
#
# consoletype
#

type myloginuser_consoletype_t, myloginuserprocess;
typeattribute myloginuser_consoletype_t domain;
role myloginuser_r types myloginuser_consoletype_t;

type consoletype_exec_t, myloginuser_application_executable_type;
typeattribute consoletype_exec_t file_type;
typeattribute consoletype_exec_t non_security_file_type;
typeattribute consoletype_exec_t non_auth_file_type;
typeattribute consoletype_exec_t exec_type;
typeattribute consoletype_exec_t application_exec_type;

allow myloginuser_consoletype_t consoletype_exec_t:file { read entrypoint };

typeattribute consoletype_exec_t started_by_user_exec_type;
typeattribute myloginuser_consoletype_t started_by_user;
type_transition myloginuser_t consoletype_exec_t:process myloginuser_consoletype_t;

########################################
#
# imsetd
#

type myloginuser_imsetd_t, myloginuserprocess;
typeattribute myloginuser_imsetd_t domain;
role myloginuser_r types myloginuser_imsetd_t;

type imsetd_exec_t, myloginuser_application_executable_type;
typeattribute imsetd_exec_t file_type;
typeattribute imsetd_exec_t non_security_file_type;
typeattribute imsetd_exec_t non_auth_file_type;
typeattribute imsetd_exec_t exec_type;
typeattribute imsetd_exec_t application_exec_type;

allow myloginuser_imsetd_t imsetd_exec_t:file { read entrypoint };

typeattribute imsetd_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_imsetd_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t imsetd_exec_t:process myloginuser_imsetd_t;

type imsetd_tmp_t;
typeattribute imsetd_tmp_t file_type;
typeattribute imsetd_tmp_t tmpfile;
typeattribute imsetd_tmp_t user_tmp_type;

type imsetd_cache_home_t;
typeattribute imsetd_cache_home_t file_type;
typeattribute imsetd_cache_home_t user_home_type;

typeattribute myloginuser_imsetd_t traverses_user_tmp;
typeattribute myloginuser_imsetd_t adds_entries_to_user_tmp_dirs;
typeattribute myloginuser_imsetd_t removes_entries_from_user_tmp_dirs;
typeattribute myloginuser_imsetd_t creates_dconf_runtime_files;

typeattribute myloginuser_imsetd_t traverses_user_home_dir;
typeattribute myloginuser_imsetd_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_imsetd_t traverses_config_home;
typeattribute myloginuser_imsetd_t reads_dconf_config_home_files;
typeattribute myloginuser_imsetd_t reads_xdg_config_home_files;

typeattribute myloginuser_imsetd_t traverses_data_home;

typeattribute myloginuser_imsetd_t traverses_cache_home;
typeattribute myloginuser_imsetd_t adds_entries_to_cache_home_dirs;
typeattribute myloginuser_imsetd_t creates_cache_home_dirs;

typeattribute myloginuser_imsetd_t traverses_tmp;
typeattribute myloginuser_imsetd_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_imsetd_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_imsetd_t reads_passwd_files;

typeattribute myloginuser_imsetd_t reads_system_state_files;

typeattribute myloginuser_imsetd_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_imsetd_t connects_to_user_session_bus;
typeattribute myloginuser_imsetd_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_imsetd_t chats_with_gvfsd;
typeattribute myloginuser_imsetd_t chats_with_gshell;
typeattribute myloginuser_imsetd_t chats_with_dconf;

allow myloginuser_imsetd_t { shell_exec_t bin_t }:file { execute execute_no_trans };

allow myloginuser_imsetd_t imsetd_cache_home_t:dir { create write add_name search };
allow myloginuser_imsetd_t imsetd_cache_home_t:file { create open getattr append };

allow myloginuser_imsetd_t dconf_tmp_t:dir create;
type_transition myloginuser_imsetd_t user_tmp_t:dir dconf_tmp_t "dconf";

allow myloginuser_imsetd_t imsetd_tmp_t:file { create write unlink open };
type_transition myloginuser_imsetd_t tmp_t:file imsetd_tmp_t;

allow myloginuser_imsetd_t tmpfs_t:filesystem getattr;

optional_policy(`
	gen_require(`
		type cache_home_t;
	')

	type_transition myloginuser_imsetd_t cache_home_t:dir imsetd_cache_home_t "imsettings";
')

########################################
#
# fusermount
#

type myloginuser_fusermount_t, myloginuserprocess;
typeattribute myloginuser_fusermount_t domain;
role myloginuser_r types myloginuser_fusermount_t;

typeattribute myloginuser_fusermount_t traverses_user_tmp;

typeattribute myloginuser_fusermount_t reads_passwd_files;

allow myloginuser_fusermount_t myloginuser_gvfsd_fuse_t:fd use;
allow myloginuser_fusermount_t myloginuser_gvfsd_fuse_t:fifo_file { read write getattr ioctl };
allow myloginuser_fusermount_t myloginuser_gvfsd_fuse_t:process sigchld;

allow myloginuser_gvfsd_fuse_t myloginuser_fusermount_t:process transition;

allow myloginuser_fusermount_t self:capability { sys_admin dac_override };

allow myloginuser_fusermount_t debugfs_t:dir { getattr search };

allow myloginuser_fusermount_t myloginuser_gvfsd_fuse_t:unix_stream_socket { read write };

allow myloginuser_fusermount_t fuse_device_t:chr_file { read write open };

allow myloginuser_fusermount_t fusefs_t:filesystem { unmount mount };

allow myloginuser_fusermount_t gvfs_tmp_t:dir { write search read open getattr mounton };

optional_policy(`
	gen_require(`
		type fusermount_exec_t;
	')

        typeattribute fusermount_exec_t started_by_user_session_bus_exec_type;
        typeattribute myloginuser_fusermount_t started_by_user_session_bus;
        type_transition myloginuser_dbusd_t fusermount_exec_t:process myloginuser_fusermount_t;

	allow myloginuser_fusermount_t fusermount_exec_t:file { read entrypoint };

	allow myloginuser_gvfsd_fuse_t fusermount_exec_t:file { getattr open read execute };
	type_transition myloginuser_gvfsd_fuse_t fusermount_exec_t:process myloginuser_fusermount_t;
')

########################################
#
# sshagent     
#

type myloginuser_sshagent_t, myloginuserprocess;
typeattribute myloginuser_sshagent_t domain;
role myloginuser_r types myloginuser_sshagent_t;

type sshagent_tmp_t;
typeattribute sshagent_tmp_t file_type;
typeattribute sshagent_tmp_t tmpfile;
typeattribute sshagent_tmp_t user_tmp_type;

typeattribute myloginuser_sshagent_t started_by_user;

typeattribute myloginuser_sshagent_t traverses_user_home_dir;

typeattribute myloginuser_sshagent_t traverses_tmp;
typeattribute myloginuser_sshagent_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_sshagent_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_sshagent_t reads_bash_home_files;

typeattribute myloginuser_sshagent_t reads_system_state_files;

typeattribute myloginuser_sshagent_t reads_system_certificates;

typeattribute myloginuser_sshagent_t reads_passwd_files;

typeattribute myloginuser_sshagent_t reads_hwdata;

typeattribute myloginuser_sshagent_t reads_sysfs;
typeattribute myloginuser_sshagent_t lists_sysfs;

typeattribute myloginuser_sshagent_t reads_urandom_device;
typeattribute myloginuser_sshagent_t reads_random_device;

allow myloginuser_sshagent_t self:process setrlimit;

allow myloginuser_sshagent_t { shell_exec_t bin_t }:file { execute execute_no_trans };

allow myloginuser_sshagent_t sshagent_tmp_t:dir { getattr search write create add_name remove_name rmdir };
allow myloginuser_sshagent_t sshagent_tmp_t:sock_file { create unlink };
type_transition myloginuser_sshagent_t tmp_t:dir sshagent_tmp_t;

optional_policy(`
	gen_require(`
		type ssh_agent_exec_t;
	')

        typeattribute ssh_agent_exec_t started_by_user_exec_type;
        type_transition myloginuser_t ssh_agent_exec_t:process myloginuser_sshagent_t;

	allow myloginuser_sshagent_t ssh_agent_exec_t:file { read entrypoint };
')

optional_policy(`
        gen_require(`
                type xdm_t;
        ')

        allow myloginuser_sshagent_t xdm_t:process sigchld;
')

########################################
#
# sshagent (all user sshagent domains)
# 

allow started_by_user_sshagent myloginuser_sshagent_t:fd use;
allow started_by_user_sshagent myloginuser_sshagent_t:fifo_file { read write getattr ioctl };
allow started_by_user_sshagent myloginuser_sshagent_t:process sigchld;

allow myloginuser_sshagent_t started_by_user_sshagent_exec_type:file { getattr open read execute };
allow myloginuser_sshagent_t started_by_user_sshagent:process transition;

########################################
#
# xrdb     
#

type myloginuser_xrdb_t, myloginuserprocess;
typeattribute myloginuser_xrdb_t domain;
role myloginuser_r types myloginuser_xrdb_t;

type xrdb_exec_t, myloginuser_application_executable_type;
typeattribute xrdb_exec_t file_type;
typeattribute xrdb_exec_t non_security_file_type;
typeattribute xrdb_exec_t non_auth_file_type;
typeattribute xrdb_exec_t exec_type;
typeattribute xrdb_exec_t application_exec_type;

allow myloginuser_xrdb_t xrdb_exec_t:file { read entrypoint };

typeattribute xrdb_exec_t started_by_user_exec_type;
typeattribute myloginuser_xrdb_t started_by_user;
type_transition myloginuser_t xrdb_exec_t:process myloginuser_xrdb_t;

typeattribute myloginuser_xrdb_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_xrdb_t reads_xdm_runtime_files;

allow myloginuser_xrdb_t bin_t:file execute;

########################################
#
# xmodmap     
#

type myloginuser_xmodmap_t, myloginuserprocess;
typeattribute myloginuser_xmodmap_t domain;
role myloginuser_r types myloginuser_xmodmap_t;

type xmodmap_exec_t, myloginuser_application_executable_type;
typeattribute xmodmap_exec_t file_type;
typeattribute xmodmap_exec_t non_security_file_type;
typeattribute xmodmap_exec_t non_auth_file_type;
typeattribute xmodmap_exec_t exec_type;
typeattribute xmodmap_exec_t application_exec_type;

allow myloginuser_xmodmap_t xmodmap_exec_t:file { read entrypoint };

typeattribute xmodmap_exec_t started_by_user_exec_type;
typeattribute myloginuser_xmodmap_t started_by_user;
type_transition myloginuser_t xmodmap_exec_t:process myloginuser_xmodmap_t;

typeattribute myloginuser_xmodmap_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_xmodmap_t reads_xdm_runtime_files;

########################################
#
# dbuslaunch     
#

type myloginuser_dbuslaunch_t, myloginuserprocess;
typeattribute myloginuser_dbuslaunch_t domain;
role myloginuser_r types myloginuser_dbuslaunch_t;

type dbuslaunch_exec_t, myloginuser_application_executable_type;
typeattribute dbuslaunch_exec_t file_type;
typeattribute dbuslaunch_exec_t non_security_file_type;
typeattribute dbuslaunch_exec_t non_auth_file_type;
typeattribute dbuslaunch_exec_t exec_type;
typeattribute dbuslaunch_exec_t application_exec_type;

allow myloginuser_dbuslaunch_t dbuslaunch_exec_t:file { read entrypoint };

typeattribute dbuslaunch_exec_t started_by_user_exec_type;
typeattribute myloginuser_dbuslaunch_t started_by_user;
type_transition myloginuser_t dbuslaunch_exec_t:process myloginuser_dbuslaunch_t;

typeattribute dbuslaunch_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_dbuslaunch_t started_by_user_gsession;
type_transition myloginuser_gsession_t dbuslaunch_exec_t:process myloginuser_dbuslaunch_t;

typeattribute myloginuser_dbuslaunch_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_dbuslaunch_t reads_xdm_runtime_files;

typeattribute myloginuser_dbuslaunch_t traverses_admin_home_dir;
typeattribute myloginuser_dbuslaunch_t adds_entries_to_admin_home_dirs;

typeattribute myloginuser_dbuslaunch_t traverses_user_home_dir;

typeattribute myloginuser_dbuslaunch_t traverses_var_lib;
typeattribute myloginuser_dbuslaunch_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_dbuslaunch_t reads_passwd_files;

typeattribute myloginuser_dbuslaunch_t runs_dbusd;

allow myloginuser_dbuslaunch_t runs_dbuslaunch:fd use;
allow myloginuser_dbuslaunch_t runs_dbuslaunch:fifo_file { read write getattr ioctl };
allow myloginuser_dbuslaunch_t runs_dbuslaunch:process sigchld;

allow runs_dbuslaunch dbuslaunch_exec_t:file { getattr open read execute };
allow runs_dbuslaunch myloginuser_dbuslaunch_t:process transition;
type_transition runs_dbuslaunch dbuslaunch_exec_t:process myloginuser_dbuslaunch_t;

allow myloginuser_dbuslaunch_t self:capability dac_override;

optional_policy(`
	gen_require(`
		type dbus_home_t;
	')

	allow myloginuser_dbuslaunch_t dbus_home_t:dir { getattr search write create add_name };
	allow myloginuser_dbuslaunch_t dbus_home_t:file { write create open getattr };
	type_transition myloginuser_dbuslaunch_t { user_home_dir_t admin_home_t }:dir dbus_home_t ".dbus";
')

########################################
#
# gvfsd     
#

type myloginuser_gvfsd_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_t domain;
role myloginuser_r types myloginuser_gvfsd_t;

type gvfsd_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_exec_t file_type;
typeattribute gvfsd_exec_t non_security_file_type;
typeattribute gvfsd_exec_t non_auth_file_type;
typeattribute gvfsd_exec_t exec_type;
typeattribute gvfsd_exec_t application_exec_type;

allow myloginuser_gvfsd_t gvfsd_exec_t:file { read entrypoint };

typeattribute gvfsd_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gvfsd_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gvfsd_exec_t:process myloginuser_gvfsd_t;

type gvfs_tmp_t;
typeattribute gvfs_tmp_t file_type;

typeattribute myloginuser_gvfsd_t traverses_user_tmp;
typeattribute myloginuser_gvfsd_t adds_entries_to_user_tmp_dirs;

typeattribute myloginuser_gvfsd_t reads_passwd_files;

typeattribute myloginuser_gvfsd_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_t chats_with_hotplugsniff;

allow myloginuser_gvfsd_t gvfs_tmp_t:dir create;
type_transition myloginuser_gvfsd_t user_tmp_t:dir gvfs_tmp_t "gvfs";

########################################
#
# gvfsd (all user gvfsd domains)
#

allow started_by_user_gvfsd myloginuser_gvfsd_t:fd use;
allow started_by_user_gvfsd myloginuser_gvfsd_t:fifo_file { read write getattr ioctl };
allow started_by_user_gvfsd myloginuser_gvfsd_t:process sigchld;

allow myloginuser_gvfsd_t started_by_user_gvfsd_exec_type:file { getattr open read execute };
allow myloginuser_gvfsd_t started_by_user_gvfsd:process transition;

########################################
#
# gvfsd_fuse    
#

type myloginuser_gvfsd_fuse_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_fuse_t domain;
role myloginuser_r types myloginuser_gvfsd_fuse_t;

type gvfsd_fuse_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_fuse_exec_t file_type;
typeattribute gvfsd_fuse_exec_t non_security_file_type;
typeattribute gvfsd_fuse_exec_t non_auth_file_type;
typeattribute gvfsd_fuse_exec_t exec_type;
typeattribute gvfsd_fuse_exec_t application_exec_type;

allow myloginuser_gvfsd_fuse_t gvfsd_fuse_exec_t:file { read entrypoint };

typeattribute gvfsd_fuse_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_fuse_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_fuse_exec_t:process myloginuser_gvfsd_fuse_t;

typeattribute myloginuser_gvfsd_fuse_t traverses_user_tmp;

typeattribute myloginuser_gvfsd_fuse_t reads_passwd_files;

typeattribute myloginuser_gvfsd_fuse_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_fuse_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_fuse_t chats_with_gshell;

allow myloginuser_gvfsd_fuse_t fuse_device_t:chr_file { read write open };

allow myloginuser_gvfsd_fuse_t gvfs_tmp_t:dir { read getattr open mounton };

allow myloginuser_gvfsd_fuse_t kernel_t:system module_request;

########################################
#
# atspi     
#

type myloginuser_atspi_t, myloginuserprocess;
typeattribute myloginuser_atspi_t domain;
role myloginuser_r types myloginuser_atspi_t;

type atspi_exec_t, myloginuser_application_executable_type;
typeattribute atspi_exec_t file_type;
typeattribute atspi_exec_t non_security_file_type;
typeattribute atspi_exec_t non_auth_file_type;
typeattribute atspi_exec_t exec_type;
typeattribute atspi_exec_t application_exec_type;

allow myloginuser_atspi_t atspi_exec_t:file { read entrypoint };

typeattribute atspi_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_atspi_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t atspi_exec_t:process myloginuser_atspi_t;

typeattribute myloginuser_atspi_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_atspi_t reads_xdm_runtime_files;

typeattribute myloginuser_atspi_t traverses_user_tmp;
typeattribute myloginuser_atspi_t creates_dconf_runtime_files;

typeattribute myloginuser_atspi_t traverses_user_home_dir;

typeattribute myloginuser_atspi_t traverses_config_home;
typeattribute myloginuser_atspi_t reads_dconf_config_home_files;

typeattribute myloginuser_atspi_t reads_passwd_files;

typeattribute myloginuser_atspi_t connects_to_user_session_bus;
typeattribute myloginuser_atspi_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_atspi_t chats_with_gsession;
typeattribute myloginuser_atspi_t chats_with_dconf;

typeattribute myloginuser_atspi_t runs_dbusd;

########################################
#
# atspi2     
#

type myloginuser_atspi2_t, myloginuserprocess;
typeattribute myloginuser_atspi2_t domain;
role myloginuser_r types myloginuser_atspi2_t;

type atspi2_exec_t, myloginuser_application_executable_type;
typeattribute atspi2_exec_t file_type;
typeattribute atspi2_exec_t non_security_file_type;
typeattribute atspi2_exec_t non_auth_file_type;
typeattribute atspi2_exec_t exec_type;
typeattribute atspi2_exec_t application_exec_type;

allow myloginuser_atspi2_t atspi2_exec_t:file { read entrypoint };

typeattribute atspi2_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_atspi2_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t atspi2_exec_t:process myloginuser_atspi2_t;

typeattribute myloginuser_atspi2_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_atspi2_t reads_xdm_runtime_files;

typeattribute myloginuser_atspi2_t connects_to_user_session_bus;
typeattribute myloginuser_atspi2_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_atspi2_t chats_with_gshell;
typeattribute myloginuser_atspi2_t chats_with_gsession;
typeattribute myloginuser_atspi2_t chats_with_gsetd;
typeattribute myloginuser_atspi2_t chats_with_nmappl;

########################################
#
# imsetcheck     
#

type myloginuser_imsetcheck_t, myloginuserprocess;
typeattribute myloginuser_imsetcheck_t domain;
role myloginuser_r types myloginuser_imsetcheck_t;

type imsetcheck_exec_t, myloginuser_application_executable_type;
typeattribute imsetcheck_exec_t file_type;
typeattribute imsetcheck_exec_t non_security_file_type;
typeattribute imsetcheck_exec_t non_auth_file_type;
typeattribute imsetcheck_exec_t exec_type;
typeattribute imsetcheck_exec_t application_exec_type;

allow myloginuser_imsetcheck_t imsetcheck_exec_t:file { read entrypoint };

typeattribute imsetcheck_exec_t started_by_user_exec_type;
typeattribute myloginuser_imsetcheck_t started_by_user;
type_transition myloginuser_t imsetcheck_exec_t:process myloginuser_imsetcheck_t;

typeattribute myloginuser_imsetcheck_t runs_dbuslaunch;

typeattribute myloginuser_imsetcheck_t traverses_var_lib;

typeattribute myloginuser_imsetcheck_t connects_to_user_session_bus;
typeattribute myloginuser_imsetcheck_t chats_with_imsetd;

########################################
#
# gsession     
#

type myloginuser_gsession_t, myloginuserprocess;
typeattribute myloginuser_gsession_t domain;
role myloginuser_r types myloginuser_gsession_t;

type gsession_exec_t, myloginuser_application_executable_type;
typeattribute gsession_exec_t file_type;
typeattribute gsession_exec_t non_security_file_type;
typeattribute gsession_exec_t non_auth_file_type;
typeattribute gsession_exec_t exec_type;
typeattribute gsession_exec_t application_exec_type;

allow myloginuser_gsession_t gsession_exec_t:file { read entrypoint };

typeattribute gsession_exec_t started_by_user_exec_type;
typeattribute myloginuser_gsession_t started_by_user;
type_transition myloginuser_t gsession_exec_t:process myloginuser_gsession_t;

typeattribute gsession_exec_t started_by_user_sshagent_exec_type;
typeattribute myloginuser_gsession_t started_by_user_sshagent;
type_transition myloginuser_sshagent_t gsession_exec_t:process myloginuser_gsession_t;

type gsession_config_home_t;
typeattribute gsession_config_home_t file_type;
typeattribute gsession_config_home_t user_home_type;

typeattribute myloginuser_gsession_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gsession_t reads_xdm_runtime_files;

typeattribute myloginuser_gsession_t reads_iceauth_home_files;

typeattribute myloginuser_gsession_t traverses_user_tmp;
typeattribute myloginuser_gsession_t creates_dconf_runtime_files;

typeattribute myloginuser_gsession_t traverses_user_home_dir;
typeattribute myloginuser_gsession_t adds_entries_to_user_home_dirs;
typeattribute myloginuser_gsession_t removes_entries_from_user_home_dirs;

typeattribute myloginuser_gsession_t traverses_config_home;
typeattribute myloginuser_gsession_t reads_dconf_config_home_files;
typeattribute myloginuser_gsession_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_gsession_t traverses_data_home;
typeattribute myloginuser_gsession_t traverses_gtk_home;

typeattribute myloginuser_gsession_t traverses_cache_home;

typeattribute myloginuser_gsession_t reads_passwd_files;

typeattribute myloginuser_gsession_t reads_fonts;

typeattribute myloginuser_gsession_t reads_logind_sessions;
typeattribute myloginuser_gsession_t reads_logind_runtime;

typeattribute myloginuser_gsession_t reads_init_state;
typeattribute myloginuser_gsession_t traverses_init_runtime;

typeattribute myloginuser_gsession_t reads_urandom_device;

typeattribute myloginuser_gsession_t traverses_cgroup;
typeattribute myloginuser_gsession_t lists_cgroup;

typeattribute myloginuser_gsession_t logs_to_system;

typeattribute myloginuser_gsession_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gsession_t connects_to_system_bus;
typeattribute myloginuser_gsession_t connects_to_user_session_bus;
typeattribute myloginuser_gsession_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gsession_t chats_with_gkrd;
typeattribute myloginuser_gsession_t chats_with_gvfsd;
typeattribute myloginuser_gsession_t chats_with_gshell;

typeattribute myloginuser_gsession_t runs_nautilus;

allow myloginuser_gsession_t self:unix_dgram_socket { getopt setopt };

allow myloginuser_gsession_t myloginuser_naut_t:process signal;

allow myloginuser_gsession_t gshell_data_home_t:dir { getattr search };

allow myloginuser_gsession_t { scprintappl_exec_t naut_exec_t atspi_exec_t restorecond_exec_t startpakde_exec_t }:file { execute getattr };

allow myloginuser_gsession_t { bin_t shell_exec_t }:file execute;

allow myloginuser_gsession_t gsession_config_home_t:dir { create write read open add_name getattr search };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_gsession_t config_home_t:dir gsession_config_home_t "gnome-session";
')

optional_policy(`
	gen_require(`
		type iceauth_home_t, xdm_t, xdm_tmp_t;
	')

	allow myloginuser_gsession_t iceauth_home_t:file create;
	type_transition myloginuser_gsession_t user_home_dir_t:file iceauth_home_t ".ICEauthority-c";

	allow myloginuser_gsession_t iceauth_home_t:file { write unlink link create };
	type_transition myloginuser_gsession_t user_home_dir_t:file iceauth_home_t ".ICEauthority";

	allow myloginuser_gsession_t xdm_t:process sigchld;

	allow myloginuser_gsession_t xdm_tmp_t:dir { write getattr add_name remove_name search };
	allow myloginuser_gsession_t xdm_tmp_t:sock_file { unlink create };
')

optional_policy(`
	gen_require(`
		type systemd_logind_inhibit_var_run_t, systemd_unit_file_t;
	')

	allow myloginuser_gsession_t systemd_logind_inhibit_var_run_t:fifo_file write;
	allow myloginuser_gsession_t systemd_unit_file_t:dir getattr;
')

########################################
#
# gsession (all user gsession domains)
#

allow started_by_user_gsession myloginuser_gsession_t:fd use;
allow started_by_user_gsession myloginuser_gsession_t:fifo_file { read write getattr ioctl };
allow started_by_user_gsession myloginuser_gsession_t:process sigchld;

allow myloginuser_gsession_t started_by_user_gsession_exec_type:file { getattr open read execute };
allow myloginuser_gsession_t started_by_user_gsession:process transition;

########################################
#
# gsession_chkaccel     
#

type myloginuser_gsession_chkaccel_t, myloginuserprocess;
typeattribute myloginuser_gsession_chkaccel_t domain;
role myloginuser_r types myloginuser_gsession_chkaccel_t;

type gsession_chkaccel_exec_t, myloginuser_application_executable_type;
typeattribute gsession_chkaccel_exec_t file_type;
typeattribute gsession_chkaccel_exec_t non_security_file_type;
typeattribute gsession_chkaccel_exec_t non_auth_file_type;
typeattribute gsession_chkaccel_exec_t exec_type;
typeattribute gsession_chkaccel_exec_t application_exec_type;

allow myloginuser_gsession_chkaccel_t gsession_chkaccel_exec_t:file { read entrypoint };

typeattribute gsession_chkaccel_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_gsession_chkaccel_t started_by_user_gsession;
type_transition myloginuser_gsession_t gsession_chkaccel_exec_t:process myloginuser_gsession_chkaccel_t;

typeattribute myloginuser_gsession_chkaccel_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gsession_chkaccel_t reads_xdm_runtime_files;

typeattribute myloginuser_gsession_chkaccel_t inherits_user_fd;

typeattribute myloginuser_gsession_chkaccel_t connects_to_user_session_bus;
typeattribute myloginuser_gsession_chkaccel_t chats_with_atspi2;
typeattribute myloginuser_gsession_chkaccel_t chats_with_atspi;

########################################
#
# dejadupmon     
#

type myloginuser_dejadupmon_t, myloginuserprocess;
typeattribute myloginuser_dejadupmon_t domain;
role myloginuser_r types myloginuser_dejadupmon_t;

type dejadupmon_exec_t, myloginuser_application_executable_type;
typeattribute dejadupmon_exec_t file_type;
typeattribute dejadupmon_exec_t non_security_file_type;
typeattribute dejadupmon_exec_t non_auth_file_type;
typeattribute dejadupmon_exec_t exec_type;
typeattribute dejadupmon_exec_t application_exec_type;

allow myloginuser_dejadupmon_t dejadupmon_exec_t:file { read entrypoint };

typeattribute dejadupmon_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_dejadupmon_t started_by_user_gsession;
type_transition myloginuser_gsession_t dejadupmon_exec_t:process myloginuser_dejadupmon_t;

typeattribute myloginuser_dejadupmon_t inherits_user_fd;

typeattribute myloginuser_dejadupmon_t traverses_user_tmp;
typeattribute myloginuser_dejadupmon_t creates_dconf_runtime_files;

typeattribute myloginuser_dejadupmon_t traverses_user_home_dir;

typeattribute myloginuser_dejadupmon_t lists_tmp;

typeattribute myloginuser_dejadupmon_t traverses_config_home;
typeattribute myloginuser_dejadupmon_t reads_dconf_config_home_files;

typeattribute myloginuser_dejadupmon_t traverses_gconf_home;
typeattribute myloginuser_dejadupmon_t traverses_cache_home;

typeattribute myloginuser_dejadupmon_t reads_passwd_files;

typeattribute myloginuser_dejadupmon_t reads_system_state_files;

typeattribute myloginuser_dejadupmon_t appends_xdm_home_files;

typeattribute myloginuser_dejadupmon_t reads_urandom_device;

typeattribute myloginuser_dejadupmon_t connects_to_user_session_bus;
typeattribute myloginuser_dejadupmon_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_dejadupmon_t chats_with_gvfsd;
typeattribute myloginuser_dejadupmon_t chats_with_dconf;

allow myloginuser_dejadupmon_t self:netlink_route_socket { getattr setopt read write getopt bind create nlmsg_read };

allow myloginuser_dejadupmon_t bin_t:file { execute execute_no_trans };

allow myloginuser_dejadupmon_t dejadup_cache_home_t:dir { getattr search read open };

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	allow myloginuser_dejadupmon_t xdm_t:unix_stream_socket getattr;
')

########################################
#
# gset_dataconvert     
#

type myloginuser_gset_dataconvert_t, myloginuserprocess;
typeattribute myloginuser_gset_dataconvert_t domain;
role myloginuser_r types myloginuser_gset_dataconvert_t;

type gset_dataconvert_exec_t, myloginuser_application_executable_type;
typeattribute gset_dataconvert_exec_t file_type;
typeattribute gset_dataconvert_exec_t non_security_file_type;
typeattribute gset_dataconvert_exec_t non_auth_file_type;
typeattribute gset_dataconvert_exec_t exec_type;
typeattribute gset_dataconvert_exec_t application_exec_type;

allow myloginuser_gset_dataconvert_t gset_dataconvert_exec_t:file { read entrypoint };

typeattribute gset_dataconvert_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_gset_dataconvert_t started_by_user_gsession;
type_transition myloginuser_gsession_t gset_dataconvert_exec_t:process myloginuser_gset_dataconvert_t;

type dataconvert_data_home_t;
typeattribute dataconvert_data_home_t file_type;
typeattribute dataconvert_data_home_t user_home_type;

type gconf_config_home_t;
typeattribute gconf_config_home_t file_type;
typeattribute gconf_config_home_t user_home_type;

typeattribute myloginuser_gset_dataconvert_t inherits_user_fd;

typeattribute myloginuser_gset_dataconvert_t traverses_user_tmp;
typeattribute myloginuser_gset_dataconvert_t creates_dconf_runtime_files;

typeattribute myloginuser_gset_dataconvert_t traverses_user_home_dir;
typeattribute myloginuser_gset_dataconvert_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_gset_dataconvert_t traverses_config_home;

typeattribute myloginuser_gset_dataconvert_t adds_entries_to_gconf_home_dirs;
typeattribute myloginuser_gset_dataconvert_t creates_gconf_home_dirs;

typeattribute myloginuser_gset_dataconvert_t traverses_data_home;
typeattribute myloginuser_gset_dataconvert_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_gset_dataconvert_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_gset_dataconvert_t creates_data_home_dirs;

typeattribute myloginuser_gset_dataconvert_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_gset_dataconvert_t reads_passwd_files;

typeattribute myloginuser_gset_dataconvert_t reads_gconf_config_files;

typeattribute myloginuser_gset_dataconvert_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gset_dataconvert_t connects_to_user_session_bus;

allow myloginuser_gset_dataconvert_t dataconvert_data_home_t:file { getattr create read write rename open };

allow myloginuser_gset_dataconvert_t gconf_config_home_t:dir { read getattr open };
allow myloginuser_gset_dataconvert_t gconf_config_home_t:dir { create search };

optional_policy(`
	gen_require(`
		type data_home_t, config_home_t;
	')

	type_transition myloginuser_gset_dataconvert_t data_home_t:file dataconvert_data_home_t;
	type_transition myloginuser_gset_dataconvert_t config_home_t:dir gconf_config_home_t "gconf";
')

########################################
#
# startpax11     
#

type myloginuser_startpax11_t, myloginuserprocess;
typeattribute myloginuser_startpax11_t domain;
role myloginuser_r types myloginuser_startpax11_t;

type startpax11_exec_t, myloginuser_application_executable_type;
typeattribute startpax11_exec_t file_type;
typeattribute startpax11_exec_t non_security_file_type;
typeattribute startpax11_exec_t non_auth_file_type;
typeattribute startpax11_exec_t exec_type;
typeattribute startpax11_exec_t application_exec_type;

allow myloginuser_startpax11_t startpax11_exec_t:file { read entrypoint };

typeattribute startpax11_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_startpax11_t started_by_user_gsession;
type_transition myloginuser_gsession_t startpax11_exec_t:process myloginuser_startpax11_t;

typeattribute myloginuser_startpax11_t inherits_user_fd;

typeattribute myloginuser_startpax11_t traverses_user_home_dir;

typeattribute myloginuser_startpax11_t reads_system_state_files;

typeattribute myloginuser_startpax11_t runs_pulseaudio;

allow myloginuser_startpax11_t startpax11_exec_t:file { ioctl open getattr };

########################################
#
# pulseaudio
#

type myloginuser_pulseaudio_t, myloginuserprocess;
typeattribute myloginuser_pulseaudio_t domain;
role myloginuser_r types myloginuser_pulseaudio_t;

type pulseaudio_tmp_t;
typeattribute pulseaudio_tmp_t file_type;
typeattribute pulseaudio_tmp_t tmpfile;
typeattribute pulseaudio_tmp_t user_tmp_type;

typeattribute myloginuser_pulseaudio_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_pulseaudio_t reads_xdm_runtime_files;

typeattribute myloginuser_pulseaudio_t inherits_user_fd;

typeattribute myloginuser_pulseaudio_t reads_iceauth_home_files;

typeattribute myloginuser_pulseaudio_t traverses_user_tmp;
typeattribute myloginuser_pulseaudio_t adds_entries_to_user_tmp_dirs;

typeattribute myloginuser_pulseaudio_t traverses_user_home_dir;
typeattribute myloginuser_pulseaudio_t lists_user_home_dir;
typeattribute myloginuser_pulseaudio_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_pulseaudio_t traverses_config_home;
typeattribute myloginuser_pulseaudio_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_pulseaudio_t traverses_var_lib;
typeattribute myloginuser_pulseaudio_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_pulseaudio_t connects_to_system_bus;
typeattribute myloginuser_pulseaudio_t connects_to_user_session_bus;
typeattribute myloginuser_pulseaudio_t aqcuires_service_on_user_session_bus;

typeattribute myloginuser_pulseaudio_t traverses_tmp;
typeattribute myloginuser_pulseaudio_t adds_entries_to_tmp_dirs;

typeattribute myloginuser_pulseaudio_t reads_system_state_files;

typeattribute myloginuser_pulseaudio_t reads_logind_sessions;
typeattribute myloginuser_pulseaudio_t reads_logind_runtime;

typeattribute myloginuser_pulseaudio_t reads_urandom_device;

typeattribute myloginuser_pulseaudio_t reads_init_state;
typeattribute myloginuser_pulseaudio_t traverses_init_runtime;

typeattribute myloginuser_pulseaudio_t reads_udev_runtime_files;

typeattribute myloginuser_pulseaudio_t reads_sysfs;
typeattribute myloginuser_pulseaudio_t lists_sysfs;

typeattribute myloginuser_pulseaudio_t logs_to_system;

typeattribute myloginuser_pulseaudio_t is_pulseaudio_client;
typeattribute myloginuser_pulseaudio_t manages_pulseaudio_tmp_content;

allow myloginuser_pulseaudio_t runs_pulseaudio:fd use;
allow myloginuser_pulseaudio_t runs_pulseaudio:fifo_file { read write getattr ioctl };
allow myloginuser_pulseaudio_t runs_pulseaudio:process sigchld;

allow runs_pulseaudio myloginuser_pulseaudio_t:process transition;

allow myloginuser_pulseaudio_t self:netlink_kobject_uevent_socket { read bind create setopt getattr };
allow myloginuser_pulseaudio_t self:process { setrlimit setcap };

allow myloginuser_pulseaudio_t proc_t:dir { open read };
allow myloginuser_pulseaudio_t proc_t:filesystem getattr;

allow myloginuser_pulseaudio_t myloginuser_gsession_t:unix_stream_socket connectto;

allow myloginuser_pulseaudio_t sound_device_t:chr_file { read write ioctl open };

optional_policy(`
	gen_require(`
		type config_home_t, pulseaudio_home_t;
	')

	type_transition myloginuser_pulseaudio_t config_home_t:dir pulseaudio_home_t "pulse";
')

optional_policy(`
	gen_require(`
		type systemd_unit_file_t;
	')

	allow myloginuser_pulseaudio_t systemd_unit_file_t:dir getattr;
')

optional_policy(`
	gen_require(`
		type alsa_etc_rw_t;
	')

	allow myloginuser_pulseaudio_t alsa_etc_rw_t:dir { getattr search };
	allow myloginuser_pulseaudio_t alsa_etc_rw_t:file { read getattr open };
')

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	allow myloginuser_pulseaudio_t xdm_t:unix_stream_socket ioctl;
')

optional_policy(`
	gen_require(`
		type pulseaudio_exec_t;
	')

        typeattribute pulseaudio_exec_t started_by_user_gsetd_exec_type;
        typeattribute myloginuser_pulseaudio_t started_by_user_gsetd;
        type_transition myloginuser_gsetd_t pulseaudio_exec_t:process myloginuser_pulseaudio_t;

	typeattribute pulseaudio_exec_t started_by_user_gshell_exec_type;
	typeattribute myloginuser_pulseaudio_t started_by_user_gshell;
	type_transition myloginuser_gshell_t pulseaudio_exec_t:process myloginuser_pulseaudio_t;

	allow myloginuser_pulseaudio_t pulseaudio_exec_t:file { execute_no_trans read entrypoint };
	allow { runs_pulseaudio myloginuser_pulseaudio_t } pulseaudio_exec_t:file { getattr open read execute };
	type_transition runs_pulseaudio pulseaudio_exec_t:process myloginuser_pulseaudio_t;
')

########################################
#
# pulseaudio grouped policy
#

allow is_pulseaudio_client is_pulseaudio_client:process signull;
allow is_pulseaudio_client myloginuser_pulseaudio_t:unix_stream_socket connectto;

allow is_pulseaudio_client pulseaudio_tmp_t:dir { getattr search };
allow is_pulseaudio_client pulseaudio_tmp_t:sock_file write;

allow is_pulseaudio_client tmpfs_t:filesystem getattr;
allow is_pulseaudio_client tmpfs_t:dir { write add_name read remove_name open getattr search };

allow manages_pulseaudio_tmp_content pulseaudio_tmp_t:dir { create write setattr read remove_name open add_name };
allow manages_pulseaudio_tmp_content pulseaudio_tmp_t:file { getattr write create unlink open };
allow manages_pulseaudio_tmp_content pulseaudio_tmp_t:sock_file { create setattr unlink };
type_transition manages_pulseaudio_tmp_content tmp_t:dir pulseaudio_tmp_t;

type_transition manages_pulseaudio_tmp_content user_tmp_t:dir pulseaudio_tmp_t "pulse";

optional_policy(`
	gen_require(`
		type pulseaudio_home_t, pulseaudio_tmpfs_t;
	')

	allow is_pulseaudio_client pulseaudio_home_t:dir { create write search setattr read open getattr add_name remove_name };
	allow is_pulseaudio_client pulseaudio_home_t:file { create read write getattr open lock };
	allow is_pulseaudio_client pulseaudio_home_t:lnk_file { read getattr create rename unlink };

	type_transition is_pulseaudio_client user_home_dir_t:file pulseaudio_home_t ".pulse-cookie";
	type_transition is_pulseaudio_client user_home_dir_t:file pulseaudio_home_t ".esd_auth";
	type_transition is_pulseaudio_client user_home_dir_t:dir pulseaudio_home_t ".pulse";

	allow is_pulseaudio_client pulseaudio_tmpfs_t:file { unlink create read write getattr open };
	type_transition is_pulseaudio_client tmpfs_t:file pulseaudio_tmpfs_t;

	allow reads_pulseaudio_home_files pulseaudio_home_t:file { getattr read open };
')

########################################
#
# svdagent
#

type myloginuser_svdagent_t, myloginuserprocess;
typeattribute myloginuser_svdagent_t domain;
role myloginuser_r types myloginuser_svdagent_t;

type svdagent_exec_t, myloginuser_application_executable_type;
typeattribute svdagent_exec_t file_type;
typeattribute svdagent_exec_t non_security_file_type;
typeattribute svdagent_exec_t non_auth_file_type;
typeattribute svdagent_exec_t exec_type;
typeattribute svdagent_exec_t application_exec_type;

allow myloginuser_svdagent_t svdagent_exec_t:file { read entrypoint };

typeattribute svdagent_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_svdagent_t started_by_user_gsession;
type_transition myloginuser_gsession_t svdagent_exec_t:process myloginuser_svdagent_t;

typeattribute myloginuser_svdagent_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_svdagent_t reads_xdm_runtime_files;

typeattribute myloginuser_svdagent_t inherits_user_fd;

typeattribute myloginuser_svdagent_t traverses_user_home_dir;

typeattribute myloginuser_svdagent_t traverses_config_home;
typeattribute myloginuser_svdagent_t reads_xdg_config_home_files;

typeattribute myloginuser_svdagent_t reads_passwd_files;

typeattribute myloginuser_svdagent_t logs_to_system;

allow myloginuser_svdagent_t virtio_device_t:chr_file getattr;

########################################
#
# gsetd
#

type myloginuser_gsetd_t, myloginuserprocess;
typeattribute myloginuser_gsetd_t domain;
role myloginuser_r types myloginuser_gsetd_t;

type gsetd_exec_t, myloginuser_application_executable_type;
typeattribute gsetd_exec_t file_type;
typeattribute gsetd_exec_t non_security_file_type;
typeattribute gsetd_exec_t non_auth_file_type;
typeattribute gsetd_exec_t exec_type;
typeattribute gsetd_exec_t application_exec_type;

allow myloginuser_gsetd_t gsetd_exec_t:file { read entrypoint };

typeattribute gsetd_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_gsetd_t started_by_user_gsession;
type_transition myloginuser_gsession_t gsetd_exec_t:process myloginuser_gsetd_t;

typeattribute gsetd_exec_t started_by_user_gsetdlocaleexec_exec_type;
typeattribute myloginuser_gsetd_t started_by_user_gsetdlocaleexec;
type_transition myloginuser_gsetdlocaleexec_t gsetd_exec_t:process myloginuser_gsetd_t;

type wallpaper_cache_home_t;
typeattribute wallpaper_cache_home_t file_type;
typeattribute wallpaper_cache_home_t user_home_type;

type gsetd_data_home_t;
typeattribute gsetd_data_home_t file_type;
typeattribute gsetd_data_home_t user_home_type;

type sounds_data_home_t;
typeattribute sounds_data_home_t file_type;
typeattribute sounds_data_home_t user_home_type;

typeattribute myloginuser_gsetd_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gsetd_t reads_xdm_runtime_files;

typeattribute myloginuser_gsetd_t inherits_user_fd;

typeattribute myloginuser_gsetd_t traverses_user_tmp;
typeattribute myloginuser_gsetd_t adds_entries_to_user_tmp_dirs;
typeattribute myloginuser_gsetd_t creates_dconf_runtime_files;

typeattribute myloginuser_gsetd_t traverses_user_home_dir;
typeattribute myloginuser_gsetd_t lists_user_home_dir;
typeattribute myloginuser_gsetd_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_gsetd_t traverses_config_home;
typeattribute myloginuser_gsetd_t reads_dconf_config_home_files;

typeattribute myloginuser_gsetd_t traverses_data_home;
typeattribute myloginuser_gsetd_t lists_data_home;
typeattribute myloginuser_gsetd_t adds_entries_to_data_home_dirs;

typeattribute myloginuser_gsetd_t traverses_sounds_data_home;
typeattribute myloginuser_gsetd_t lists_sounds_data_home;
typeattribute myloginuser_gsetd_t creates_sounds_data_home_dirs;

typeattribute myloginuser_gsetd_t traverses_gtk_home;

typeattribute myloginuser_gsetd_t traverses_thumb_home;
typeattribute myloginuser_gsetd_t lists_thumb_home;
typeattribute myloginuser_gsetd_t gets_attributes_of_thumb_home_files;

typeattribute myloginuser_gsetd_t traverses_cache_home;
typeattribute myloginuser_gsetd_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_gsetd_t traverses_tmp;
typeattribute myloginuser_gsetd_t adds_entries_to_tmp_dirs;

typeattribute myloginuser_gsetd_t traverses_var_lib;
typeattribute myloginuser_gsetd_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_gsetd_t reads_passwd_files;

typeattribute myloginuser_gsetd_t reads_system_state_files;

typeattribute myloginuser_gsetd_t reads_fonts;

typeattribute myloginuser_gsetd_t reads_init_state;
typeattribute myloginuser_gsetd_t traverses_init_runtime;

typeattribute myloginuser_gsetd_t reads_urandom_device;
typeattribute myloginuser_gsetd_t reads_random_device;

typeattribute myloginuser_gsetd_t reads_hwdata;

typeattribute myloginuser_gsetd_t reads_sysfs;
typeattribute myloginuser_gsetd_t lists_sysfs;

typeattribute myloginuser_gsetd_t reads_udev_runtime_files;

typeattribute myloginuser_gsetd_t reads_logind_sessions;
typeattribute myloginuser_gsetd_t reads_logind_runtime;

typeattribute myloginuser_gsetd_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gsetd_t connects_to_system_bus;
typeattribute myloginuser_gsetd_t connects_to_user_session_bus;
typeattribute myloginuser_gsetd_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gsetd_t chats_with_gvfsd;
typeattribute myloginuser_gsetd_t chats_with_gshell;
typeattribute myloginuser_gsetd_t chats_with_gsession;

typeattribute myloginuser_gsetd_t connects_to_user_gkrd;

typeattribute myloginuser_gsetd_t connects_to_cups;
typeattribute myloginuser_gsetd_t reads_cups_config_files;

typeattribute myloginuser_gsetd_t is_pulseaudio_client;
typeattribute myloginuser_gsetd_t manages_pulseaudio_tmp_content;

allow myloginuser_gsetd_t self:netlink_kobject_uevent_socket { bind read create setopt getattr };

allow myloginuser_gsetd_t init_t:system status;

allow myloginuser_gsetd_t user_home_t:dir { getattr search read open };
allow myloginuser_gsetd_t user_home_t:file { read getattr open };

allow myloginuser_gsetd_t gsetd_data_home_t:dir { create getattr search write remove_name add_name };
allow myloginuser_gsetd_t gsetd_data_home_t:file { rename write getattr read create open };

allow myloginuser_gsetd_t wallpaper_cache_home_t:dir { getattr write add_name search getattr create open read };
allow myloginuser_gsetd_t wallpaper_cache_home_t:file { getattr write create open read lock };

optional_policy(`
	gen_require(`
		type cache_home_t, data_home_t;
	')

	type_transition myloginuser_gsetd_t data_home_t:dir gsetd_data_home_t "gnome-settings-daemon";
	type_transition myloginuser_gsetd_t cache_home_t:dir wallpaper_cache_home_t "wallpaper";
')

optional_policy(`
	gen_require(`
		type icc_data_home_t, data_home_t;
	')

	allow myloginuser_gsetd_t icc_data_home_t:dir { create getattr search read write open add_name };
	allow myloginuser_gsetd_t icc_data_home_t:file { write read create open getattr };
	type_transition myloginuser_gsetd_t data_home_t:dir icc_data_home_t "icc";
')

optional_policy(`
        gen_require(`
                type systemd_logind_inhibit_var_run_t;
        ')

	allow myloginuser_gsetd_t systemd_logind_inhibit_var_run_t:fifo_file write;
')

optional_policy(`
	gen_require(`
		type rpm_var_lib_t;
	')

	allow myloginuser_gsetd_t rpm_var_lib_t:dir { getattr search };
')

########################################
#
# gsetd (all user gsetd domains)
#

allow started_by_user_gsetd myloginuser_gsetd_t:fd use;
allow started_by_user_gsetd myloginuser_gsetd_t:fifo_file { read write getattr ioctl };
allow started_by_user_gsetd myloginuser_gsetd_t:process sigchld;

allow myloginuser_gsetd_t started_by_user_gsetd_exec_type:file { getattr open read execute };
allow myloginuser_gsetd_t started_by_user_gsetd:process transition;

########################################
#
# gsetd grouped policy
#

allow traverses_sounds_data_home sounds_data_home_t:dir { getattr search };
allow lists_sounds_data_home sounds_data_home_t:dir { read open };

allow creates_sounds_data_home_dirs sounds_data_home_t:dir create;

optional_policy(`
	gen_require(`
		type data_home_t;
	')

	type_transition creates_sounds_data_home_dirs data_home_t:dir sounds_data_home_t "sounds";
')

########################################
#
# pactl
#

type myloginuser_pactl_t, myloginuserprocess;
typeattribute myloginuser_pactl_t domain;
role myloginuser_r types myloginuser_pactl_t;

type pactl_exec_t, myloginuser_application_executable_type;
typeattribute pactl_exec_t file_type;
typeattribute pactl_exec_t non_security_file_type;
typeattribute pactl_exec_t non_auth_file_type;
typeattribute pactl_exec_t exec_type;
typeattribute pactl_exec_t application_exec_type;

allow myloginuser_pactl_t pactl_exec_t:file { read entrypoint };

typeattribute myloginuser_pactl_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_pactl_t reads_xdm_runtime_files;

typeattribute myloginuser_pactl_t inherits_user_fd;

typeattribute myloginuser_pactl_t traverses_user_tmp;

typeattribute myloginuser_pactl_t traverses_user_home_dir;
typeattribute myloginuser_pactl_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_pactl_t traverses_config_home;

typeattribute myloginuser_pactl_t traverses_tmp;

typeattribute myloginuser_pactl_t traverses_var_lib;
typeattribute myloginuser_pactl_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_pactl_t reads_urandom_device;

typeattribute myloginuser_pactl_t is_pulseaudio_client;

allow myloginuser_pactl_t myloginuser_startpax11_t:fd use;
allow myloginuser_pactl_t myloginuser_startpax11_t:fifo_file { read write getattr ioctl };
allow myloginuser_pactl_t myloginuser_startpax11_t:process sigchld;

allow myloginuser_startpax11_t pactl_exec_t:file { getattr open read execute };
allow myloginuser_startpax11_t myloginuser_pactl_t:process transition;
type_transition myloginuser_startpax11_t pactl_exec_t:process myloginuser_pactl_t;

allow myloginuser_pactl_t pulseaudio_tmp_t:dir { read open setattr };

########################################
#
# gvfsd_udiskmon
# 

type myloginuser_gvfsd_udiskmon_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_udiskmon_t domain;
role myloginuser_r types myloginuser_gvfsd_udiskmon_t;

type gvfsd_udiskmon_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_udiskmon_exec_t file_type;
typeattribute gvfsd_udiskmon_exec_t non_security_file_type;
typeattribute gvfsd_udiskmon_exec_t non_auth_file_type;
typeattribute gvfsd_udiskmon_exec_t exec_type;
typeattribute gvfsd_udiskmon_exec_t application_exec_type;

allow myloginuser_gvfsd_udiskmon_t gvfsd_udiskmon_exec_t:file { read entrypoint };

typeattribute gvfsd_udiskmon_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gvfsd_udiskmon_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gvfsd_udiskmon_exec_t:process myloginuser_gvfsd_udiskmon_t;

typeattribute myloginuser_gvfsd_udiskmon_t reads_passwd_files;

typeattribute myloginuser_gvfsd_udiskmon_t reads_logind_sessions;

typeattribute myloginuser_gvfsd_udiskmon_t reads_init_state;
typeattribute myloginuser_gvfsd_udiskmon_t traverses_init_runtime;

typeattribute myloginuser_gvfsd_udiskmon_t connects_to_system_bus;
typeattribute myloginuser_gvfsd_udiskmon_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_udiskmon_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_udiskmon_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_udiskmon_t chats_with_gshell;
typeattribute myloginuser_gvfsd_udiskmon_t chats_with_gsetd;
typeattribute myloginuser_gvfsd_udiskmon_t chats_with_trminerfs;
typeattribute myloginuser_gvfsd_udiskmon_t chats_with_naut;
typeattribute myloginuser_gvfsd_udiskmon_t chats_with_dejadupmon;

allow myloginuser_gvfsd_udiskmon_t self:netlink_kobject_uevent_socket { bind create setopt getattr read };

########################################
#
# gvfsd_gphotovolmon
# 

type myloginuser_gvfsd_gphotovolmon_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_gphotovolmon_t domain;
role myloginuser_r types myloginuser_gvfsd_gphotovolmon_t;

type gvfsd_gphotovolmon_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_gphotovolmon_exec_t file_type;
typeattribute gvfsd_gphotovolmon_exec_t non_security_file_type;
typeattribute gvfsd_gphotovolmon_exec_t non_auth_file_type;
typeattribute gvfsd_gphotovolmon_exec_t exec_type;
typeattribute gvfsd_gphotovolmon_exec_t application_exec_type;

allow myloginuser_gvfsd_gphotovolmon_t gvfsd_gphotovolmon_exec_t:file { read entrypoint };

typeattribute gvfsd_gphotovolmon_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gvfsd_gphotovolmon_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gvfsd_gphotovolmon_exec_t:process myloginuser_gvfsd_gphotovolmon_t;

typeattribute myloginuser_gvfsd_gphotovolmon_t reads_udev_runtime_files;

typeattribute myloginuser_gvfsd_gphotovolmon_t reads_sysfs;
typeattribute myloginuser_gvfsd_gphotovolmon_t lists_sysfs;

typeattribute myloginuser_gvfsd_gphotovolmon_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_gphotovolmon_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_gphotovolmon_t chats_with_gshell;
typeattribute myloginuser_gvfsd_gphotovolmon_t chats_with_gsetd;
typeattribute myloginuser_gvfsd_gphotovolmon_t chats_with_trminerfs;
typeattribute myloginuser_gvfsd_gphotovolmon_t chats_with_naut;
typeattribute myloginuser_gvfsd_gphotovolmon_t chats_with_dejadupmon;

allow myloginuser_gvfsd_gphotovolmon_t self:netlink_kobject_uevent_socket { bind create setopt getattr read };

########################################
#
# gvfsd_afcvolmon
# 

type myloginuser_gvfsd_afcvolmon_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_afcvolmon_t domain;
role myloginuser_r types myloginuser_gvfsd_afcvolmon_t;

type gvfsd_afcvolmon_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_afcvolmon_exec_t file_type;
typeattribute gvfsd_afcvolmon_exec_t non_security_file_type;
typeattribute gvfsd_afcvolmon_exec_t non_auth_file_type;
typeattribute gvfsd_afcvolmon_exec_t exec_type;
typeattribute gvfsd_afcvolmon_exec_t application_exec_type;

allow myloginuser_gvfsd_afcvolmon_t gvfsd_afcvolmon_exec_t:file { read entrypoint };

typeattribute gvfsd_afcvolmon_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gvfsd_afcvolmon_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gvfsd_afcvolmon_exec_t:process myloginuser_gvfsd_afcvolmon_t;

typeattribute myloginuser_gvfsd_afcvolmon_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_afcvolmon_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_afcvolmon_t chats_with_gshell;
typeattribute myloginuser_gvfsd_afcvolmon_t chats_with_gsetd;
typeattribute myloginuser_gvfsd_afcvolmon_t chats_with_trminerfs;
typeattribute myloginuser_gvfsd_afcvolmon_t chats_with_naut;
typeattribute myloginuser_gvfsd_afcvolmon_t chats_with_dejadupmon;

########################################
#
# ibus
# 

type myloginuser_ibus_t, myloginuserprocess;
typeattribute myloginuser_ibus_t domain;
role myloginuser_r types myloginuser_ibus_t;

type ibus_exec_t, myloginuser_application_executable_type;
typeattribute ibus_exec_t file_type;
typeattribute ibus_exec_t non_security_file_type;
typeattribute ibus_exec_t non_auth_file_type;
typeattribute ibus_exec_t exec_type;
typeattribute ibus_exec_t application_exec_type;

allow myloginuser_ibus_t ibus_exec_t:file { read entrypoint };

typeattribute ibus_exec_t started_by_user_gsetd_exec_type;
typeattribute myloginuser_ibus_t started_by_user_gsetd;
type_transition myloginuser_gsetd_t ibus_exec_t:process myloginuser_ibus_t;

########################################
#
# ibus grouped policy
#

allow creates_ibus_config_home_dirs ibus_config_home_t:dir { create write read open getattr add_name setattr search };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition creates_ibus_config_home_dirs config_home_t:dir ibus_config_home_t "ibus";
')

########################################
#
# gsdprinter
# 

type myloginuser_gsdprinter_t, myloginuserprocess;
typeattribute myloginuser_gsdprinter_t domain;
role myloginuser_r types myloginuser_gsdprinter_t;

type gsdprinter_exec_t, myloginuser_application_executable_type;
typeattribute gsdprinter_exec_t file_type;
typeattribute gsdprinter_exec_t non_security_file_type;
typeattribute gsdprinter_exec_t non_auth_file_type;
typeattribute gsdprinter_exec_t exec_type;
typeattribute gsdprinter_exec_t application_exec_type;

allow myloginuser_gsdprinter_t gsdprinter_exec_t:file { read entrypoint };

typeattribute gsdprinter_exec_t started_by_user_gsetd_exec_type;
typeattribute myloginuser_gsdprinter_t started_by_user_gsetd;
type_transition myloginuser_gsetd_t gsdprinter_exec_t:process myloginuser_gsdprinter_t;

typeattribute gsdprinter_exec_t started_by_user_gsetdlocaleexec_exec_type;
typeattribute myloginuser_gsdprinter_t started_by_user_gsetdlocaleexec;
type_transition myloginuser_gsetdlocaleexec_t gsdprinter_exec_t:process myloginuser_gsdprinter_t;

typeattribute myloginuser_gsdprinter_t inherits_user_fd;

typeattribute myloginuser_gsdprinter_t connects_to_system_bus;
typeattribute myloginuser_gsdprinter_t connects_to_user_session_bus;
typeattribute myloginuser_gsdprinter_t aqcuires_service_on_system_bus;
typeattribute myloginuser_gsdprinter_t chats_with_gsession;

########################################
#
# gshell
# 

type myloginuser_gshell_t, myloginuserprocess;
typeattribute myloginuser_gshell_t domain;
role myloginuser_r types myloginuser_gshell_t;

type gshell_exec_t, myloginuser_application_executable_type;
typeattribute gshell_exec_t file_type;
typeattribute gshell_exec_t non_security_file_type;
typeattribute gshell_exec_t non_auth_file_type;
typeattribute gshell_exec_t exec_type;
typeattribute gshell_exec_t application_exec_type;

allow myloginuser_gshell_t gshell_exec_t:file { read entrypoint };

typeattribute gshell_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_gshell_t started_by_user_gsession;
type_transition myloginuser_gsession_t gshell_exec_t:process myloginuser_gshell_t;

type gshell_tmp_t;
typeattribute gshell_tmp_t file_type;
typeattribute gshell_tmp_t tmpfile;
typeattribute gshell_tmp_t user_tmp_type;

type gshell_data_home_t;
typeattribute gshell_data_home_t file_type;
typeattribute gshell_data_home_t user_home_type;

typeattribute myloginuser_gshell_t runs_evince;
typeattribute myloginuser_gshell_t runs_nautilus;
typeattribute myloginuser_gshell_t runs_yelp;

typeattribute myloginuser_gshell_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gshell_t reads_xdm_runtime_files;

typeattribute myloginuser_gshell_t inherits_user_fd;

typeattribute myloginuser_gshell_t reads_iceauth_home_files;

typeattribute myloginuser_gshell_t traverses_user_tmp;
typeattribute myloginuser_gshell_t creates_dconf_runtime_files;

typeattribute myloginuser_gshell_t traverses_user_home_dir;
typeattribute myloginuser_gshell_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_gshell_t traverses_config_home;
typeattribute myloginuser_gshell_t reads_dconf_config_home_files;
typeattribute myloginuser_gshell_t reads_xdg_config_home_files;

typeattribute myloginuser_gshell_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_gshell_t creates_ibus_config_home_dirs;

typeattribute myloginuser_gshell_t traverses_data_home;
typeattribute myloginuser_gshell_t adds_entries_to_data_home_dirs;

typeattribute myloginuser_gshell_t traverses_sounds_data_home;

typeattribute myloginuser_gshell_t traverses_gtk_home;

typeattribute myloginuser_gshell_t traverses_cache_home;
typeattribute myloginuser_gshell_t reads_esc_cache_home_files;

typeattribute myloginuser_gshell_t traverses_tmp;
typeattribute myloginuser_gshell_t lists_tmp;
typeattribute myloginuser_gshell_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_gshell_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_gshell_t traverses_var_lib;
typeattribute myloginuser_gshell_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_gshell_t reads_passwd_files;

typeattribute myloginuser_gshell_t reads_system_state_files;

typeattribute myloginuser_gshell_t reads_fonts;

typeattribute myloginuser_gshell_t reads_system_certificates;

typeattribute myloginuser_gshell_t reads_urandom_device;
typeattribute myloginuser_gshell_t reads_random_device;

typeattribute myloginuser_gshell_t reads_udev_runtime_files;

typeattribute myloginuser_gshell_t appends_xdm_home_files;

typeattribute myloginuser_gshell_t reads_sysfs;

typeattribute myloginuser_gshell_t reads_logind_sessions;
typeattribute myloginuser_gshell_t reads_logind_runtime;

typeattribute myloginuser_gshell_t reads_init_state;
typeattribute myloginuser_gshell_t traverses_init_runtime;

typeattribute myloginuser_gshell_t traverses_cgroup;

typeattribute myloginuser_gshell_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gshell_t connects_to_system_bus;
typeattribute myloginuser_gshell_t connects_to_user_session_bus;
typeattribute myloginuser_gshell_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gshell_t chats_with_hotplugsniff;
typeattribute myloginuser_gshell_t chats_with_gkrd;
typeattribute myloginuser_gshell_t chats_with_gvfsd;

typeattribute myloginuser_gshell_t connects_to_user_gkrd;
typeattribute myloginuser_gshell_t is_pulseaudio_client;

allow myloginuser_gshell_t self:process execmem;
allow myloginuser_gshell_t self:netlink_kobject_uevent_socket { bind create setopt getattr };
allow myloginuser_gshell_t self:netlink_route_socket { getattr setopt getopt bind create nlmsg_read read write };

allow myloginuser_gshell_t user_home_t:dir { getattr search open read };
allow myloginuser_gshell_t user_home_t:file { getattr open read };

allow myloginuser_gshell_t { gpksvcpk_exec_t dejadup_exec_t gsession_exec_t dnssecmon_exec_t nmappl_exec_t }:file { execute getattr };
dontaudit myloginuser_gshell_t exec_type:file execute;

allow myloginuser_gshell_t gshell_exec_t:file { execute getattr };
allow myloginuser_gshell_t shell_exec_t:file execute;

allow myloginuser_gshell_t myloginuser_gsession_t:unix_stream_socket connectto;

allow myloginuser_gshell_t net_conf_t:file getattr;

allow myloginuser_gshell_t urandom_device_t:chr_file ioctl;

allow myloginuser_gshell_t dri_device_t:chr_file { read write ioctl open };

allow myloginuser_gshell_t wireless_device_t:chr_file { read write getattr open };

allow myloginuser_gshell_t selinux_config_t:dir { getattr search };
allow myloginuser_gshell_t selinux_config_t:file { read getattr open };

allow myloginuser_gshell_t myloginuser_policykitauth_t:process signal;

allow myloginuser_gshell_t esc_cache_home_t:file { write lock };

allow myloginuser_gshell_t gtk_home_t:dir read;
allow myloginuser_gshell_t gtk_home_t:file { read getattr open };

allow myloginuser_gshell_t gshell_tmp_t:file { create write execute unlink open };
type_transition myloginuser_gshell_t tmp_t:file gshell_tmp_t;

allow myloginuser_gshell_t gshell_data_home_t:dir { create getattr search write add_name remove_name };
allow myloginuser_gshell_t gshell_data_home_t:file { create write read open getattr setattr rename unlink };

optional_policy(`
        gen_require(`
                type data_home_t;
        ')

	type_transition myloginuser_gshell_t data_home_t:dir gshell_data_home_t "gnome-shell";
')

optional_policy(`
	gen_require(`
		type rpm_var_lib_t;
	')

	allow myloginuser_gshell_t rpm_var_lib_t:dir { read search };
	allow myloginuser_gshell_t rpm_var_lib_t:file getattr;
')

optional_policy(`
	gen_require(`
		type systemd_logind_inhibit_var_run_t, systemd_unit_file_t;
	')

	allow myloginuser_gshell_t systemd_logind_inhibit_var_run_t:fifo_file write;
	allow myloginuser_gshell_t systemd_unit_file_t:dir getattr;
')

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	allow myloginuser_gshell_t xdm_t:unix_stream_socket connectto;
	allow myloginuser_gshell_t xdm_t:unix_stream_socket { getattr };
')

########################################
#
# gshell (all user gshell domains)
#

allow started_by_user_gshell myloginuser_gshell_t:fd use;
allow started_by_user_gshell myloginuser_gshell_t:fifo_file { read write getattr ioctl };
allow started_by_user_gshell myloginuser_gshell_t:process sigchld;

allow myloginuser_gshell_t started_by_user_gshell_exec_type:file { getattr open read execute };
allow myloginuser_gshell_t started_by_user_gshell:process transition;

########################################
#
# dconf
# 

type myloginuser_dconf_t, myloginuserprocess;
typeattribute myloginuser_dconf_t domain;
role myloginuser_r types myloginuser_dconf_t;

type dconf_exec_t, myloginuser_application_executable_type;
typeattribute dconf_exec_t file_type;
typeattribute dconf_exec_t non_security_file_type;
typeattribute dconf_exec_t non_auth_file_type;
typeattribute dconf_exec_t exec_type;
typeattribute dconf_exec_t application_exec_type;

allow myloginuser_dconf_t dconf_exec_t:file { read entrypoint };

typeattribute dconf_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_dconf_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t dconf_exec_t:process myloginuser_dconf_t;

type dconf_tmp_t;
typeattribute dconf_tmp_t file_type;
typeattribute dconf_tmp_t tmpfile;
typeattribute dconf_tmp_t user_tmp_type;

type dconf_config_home_t;
typeattribute dconf_config_home_t file_type;
typeattribute dconf_config_home_t user_home_type;

typeattribute myloginuser_dconf_t traverses_user_tmp;
typeattribute myloginuser_dconf_t creates_dconf_runtime_files;

typeattribute myloginuser_dconf_t traverses_admin_home_dir;
typeattribute myloginuser_dconf_t adds_entries_to_admin_home_dirs;

typeattribute myloginuser_dconf_t traverses_user_home_dir;

typeattribute myloginuser_dconf_t traverses_config_home;
typeattribute myloginuser_dconf_t creates_config_home_dirs;
typeattribute myloginuser_dconf_t reads_dconf_config_home_files;

typeattribute myloginuser_dconf_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_dconf_t traverses_cache_home;

typeattribute myloginuser_dconf_t reads_passwd_files;

typeattribute myloginuser_dconf_t reads_system_state_files;

typeattribute myloginuser_dconf_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_dconf_t connects_to_user_session_bus;
typeattribute myloginuser_dconf_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_dconf_t chats_with_gkrd;
typeattribute myloginuser_dconf_t chats_with_gshell;
typeattribute myloginuser_dconf_t chats_with_gsession;
typeattribute myloginuser_dconf_t chats_with_gsetd;
typeattribute myloginuser_dconf_t chats_with_trminerfs;

allow myloginuser_dconf_t self:capability dac_override;

allow myloginuser_dconf_t dconf_tmp_t:dir remove_name;
allow myloginuser_dconf_t dconf_tmp_t:file unlink;

allow myloginuser_dconf_t dconf_config_home_t:dir { create write remove_name add_name };
allow myloginuser_dconf_t dconf_config_home_t:file { rename write create unlink };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_dconf_t config_home_t:dir dconf_config_home_t "dconf";
')

########################################
#
# dconf grouped policy
#

allow creates_dconf_runtime_files dconf_tmp_t:dir { search getattr write add_name };
allow creates_dconf_runtime_files dconf_tmp_t:file { write create open };

allow reads_dconf_config_home_files dconf_config_home_t:dir { getattr search };
allow reads_dconf_config_home_files dconf_config_home_t:file { getattr read open };

########################################
#
# dnssecmon
# 

type myloginuser_dnssecmon_t, myloginuserprocess;
typeattribute myloginuser_dnssecmon_t domain;
role myloginuser_r types myloginuser_dnssecmon_t;

type dnssecmon_exec_t, myloginuser_application_executable_type;
typeattribute dnssecmon_exec_t file_type;
typeattribute dnssecmon_exec_t non_security_file_type;
typeattribute dnssecmon_exec_t non_auth_file_type;
typeattribute dnssecmon_exec_t exec_type;
typeattribute dnssecmon_exec_t application_exec_type;

allow myloginuser_dnssecmon_t dnssecmon_exec_t:file { read entrypoint };

typeattribute dnssecmon_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_dnssecmon_t started_by_user_gsession;
type_transition myloginuser_gsession_t dnssecmon_exec_t:process myloginuser_dnssecmon_t;

typeattribute dnssecmon_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_dnssecmon_t started_by_user_gshell;
type_transition myloginuser_gshell_t dnssecmon_exec_t:process myloginuser_dnssecmon_t;

type ibus_config_home_t;
typeattribute ibus_config_home_t file_type;
typeattribute ibus_config_home_t user_home_type;

typeattribute myloginuser_dnssecmon_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_dnssecmon_t reads_xdm_runtime_files;

typeattribute myloginuser_dnssecmon_t inherits_user_fd;

typeattribute myloginuser_dnssecmon_t traverses_user_home_dir;

typeattribute myloginuser_dnssecmon_t traverses_data_home;
typeattribute myloginuser_dnssecmon_t traverses_config_home;
typeattribute myloginuser_dnssecmon_t traverses_cache_home;

typeattribute myloginuser_dnssecmon_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_dnssecmon_t creates_ibus_config_home_dirs;

typeattribute myloginuser_dnssecmon_t traverses_var_lib;
typeattribute myloginuser_dnssecmon_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_dnssecmon_t reads_passwd_files;

typeattribute myloginuser_dnssecmon_t reads_system_state_files;

typeattribute myloginuser_dnssecmon_t reads_fonts;

typeattribute myloginuser_dnssecmon_t reads_urandom_device;

typeattribute myloginuser_dnssecmon_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_dnssecmon_t connects_to_system_bus;
typeattribute myloginuser_dnssecmon_t connects_to_user_session_bus;
typeattribute myloginuser_dnssecmon_t chats_with_gvfsd;

allow myloginuser_dnssecmon_t dnssec_port_t:tcp_socket name_connect;
allow myloginuser_dnssecmon_t self:tcp_socket { create connect read write };

########################################
#
# nmappl
# 

type myloginuser_nmappl_t, myloginuserprocess;
typeattribute myloginuser_nmappl_t domain;
role myloginuser_r types myloginuser_nmappl_t;

type nmappl_exec_t, myloginuser_application_executable_type;
typeattribute nmappl_exec_t file_type;
typeattribute nmappl_exec_t non_security_file_type;
typeattribute nmappl_exec_t non_auth_file_type;
typeattribute nmappl_exec_t exec_type;
typeattribute nmappl_exec_t application_exec_type;

allow myloginuser_nmappl_t nmappl_exec_t:file { read entrypoint };

typeattribute nmappl_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_nmappl_t started_by_user_gsession;
type_transition myloginuser_gsession_t nmappl_exec_t:process myloginuser_nmappl_t;

typeattribute myloginuser_nmappl_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_nmappl_t reads_xdm_runtime_files;

typeattribute myloginuser_nmappl_t inherits_user_fd;

typeattribute myloginuser_nmappl_t traverses_user_tmp;
typeattribute myloginuser_nmappl_t creates_dconf_runtime_files;

typeattribute myloginuser_nmappl_t traverses_user_home_dir;

typeattribute myloginuser_nmappl_t lists_tmp;

typeattribute myloginuser_nmappl_t traverses_config_home;
typeattribute myloginuser_nmappl_t reads_dconf_config_home_files;

typeattribute myloginuser_nmappl_t traverses_data_home;
typeattribute myloginuser_nmappl_t traverses_gtk_home;

typeattribute myloginuser_nmappl_t traverses_cache_home;

typeattribute myloginuser_nmappl_t reads_passwd_files;

typeattribute myloginuser_nmappl_t reads_fonts;

typeattribute myloginuser_nmappl_t reads_urandom_device;

typeattribute myloginuser_nmappl_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_nmappl_t connects_to_system_bus;
typeattribute myloginuser_nmappl_t connects_to_user_session_bus;
typeattribute myloginuser_nmappl_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_nmappl_t chats_with_gvfsd;
typeattribute myloginuser_nmappl_t chats_with_gshell;

allow myloginuser_nmappl_t bin_t:file { execute execute_no_trans };

allow myloginuser_nmappl_t urandom_device_t:chr_file ioctl;

########################################
#
# abrtappl
# 

type myloginuser_abrtappl_t, myloginuserprocess;
typeattribute myloginuser_abrtappl_t domain;
role myloginuser_r types myloginuser_abrtappl_t;

type abrtappl_exec_t, myloginuser_application_executable_type;
typeattribute abrtappl_exec_t file_type;
typeattribute abrtappl_exec_t non_security_file_type;
typeattribute abrtappl_exec_t non_auth_file_type;
typeattribute abrtappl_exec_t exec_type;
typeattribute abrtappl_exec_t application_exec_type;

allow myloginuser_abrtappl_t abrtappl_exec_t:file { read entrypoint };

typeattribute abrtappl_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_abrtappl_t started_by_user_gsession;
type_transition myloginuser_gsession_t abrtappl_exec_t:process myloginuser_abrtappl_t;

type abrt_cache_home_t;
typeattribute abrt_cache_home_t file_type;
typeattribute abrt_cache_home_t user_home_type;

type abrt_config_home_t;
typeattribute abrt_config_home_t file_type;
typeattribute abrt_config_home_t user_home_type;

typeattribute myloginuser_abrtappl_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_abrtappl_t reads_xdm_runtime_files;

typeattribute myloginuser_abrtappl_t inherits_user_fd;

typeattribute myloginuser_abrtappl_t traverses_user_home_dir;

typeattribute myloginuser_abrtappl_t traverses_data_home;
typeattribute myloginuser_abrtappl_t traverses_gtk_home;

typeattribute myloginuser_abrtappl_t traverses_config_home;
typeattribute myloginuser_abrtappl_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_abrtappl_t traverses_cache_home;
typeattribute myloginuser_abrtappl_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_abrtappl_t reads_passwd_files;

typeattribute myloginuser_abrtappl_t reads_fonts;

typeattribute myloginuser_abrtappl_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_abrtappl_t connects_to_system_bus;
typeattribute myloginuser_abrtappl_t connects_to_user_session_bus;
typeattribute myloginuser_abrtappl_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_abrtappl_t chats_with_gvfsd;
typeattribute myloginuser_abrtappl_t chats_with_gshell;
typeattribute myloginuser_abrtappl_t chats_with_atspi2;

allow myloginuser_abrtappl_t abrt_cache_home_t:file { read write create open getattr append };
allow myloginuser_abrtappl_t abrt_cache_home_t:dir { create write getattr add_name search };

allow myloginuser_abrtappl_t abrt_config_home_t:dir { create getattr search write add_name remove_name };
allow myloginuser_abrtappl_t abrt_config_home_t:file { create rename write open };

optional_policy(`
	gen_require(`
		type config_home_t, cache_home_t;
	')

	type_transition myloginuser_abrtappl_t cache_home_t:dir abrt_cache_home_t "abrt";
	type_transition myloginuser_abrtappl_t config_home_t:dir abrt_config_home_t "abrt";
')

optional_policy(`
	gen_require(`
		type abrt_etc_t, abrt_var_cache_t;
	')

	allow myloginuser_abrtappl_t abrt_etc_t:dir { getattr search };
	allow myloginuser_abrtappl_t abrt_etc_t:file { read getattr open };

	allow myloginuser_abrtappl_t abrt_var_cache_t:dir { read getattr open search write add_name remove_name };
	allow myloginuser_abrtappl_t abrt_var_cache_t:lnk_file { create unlink };
	allow myloginuser_abrtappl_t abrt_var_cache_t:file open;
')

########################################
#
# trminerfs
# 

type myloginuser_trminerfs_t, myloginuserprocess;
typeattribute myloginuser_trminerfs_t domain;
role myloginuser_r types myloginuser_trminerfs_t;

type trminerfs_exec_t, myloginuser_application_executable_type;
typeattribute trminerfs_exec_t file_type;
typeattribute trminerfs_exec_t non_security_file_type;
typeattribute trminerfs_exec_t non_auth_file_type;
typeattribute trminerfs_exec_t exec_type;
typeattribute trminerfs_exec_t application_exec_type;

allow myloginuser_trminerfs_t trminerfs_exec_t:file { read entrypoint };

typeattribute trminerfs_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_trminerfs_t started_by_user_gsession;
type_transition myloginuser_gsession_t trminerfs_exec_t:process myloginuser_trminerfs_t;

type trminer_config_home_t;
typeattribute trminer_config_home_t file_type;
typeattribute trminer_config_home_t user_home_type;

typeattribute myloginuser_trminerfs_t inherits_user_fd;

typeattribute myloginuser_trminerfs_t traverses_user_tmp;
typeattribute myloginuser_trminerfs_t creates_dconf_runtime_files;

typeattribute myloginuser_trminerfs_t traverses_user_home_dir;
typeattribute myloginuser_trminerfs_t lists_user_home_dir;

typeattribute myloginuser_trminerfs_t traverses_config_home;
typeattribute myloginuser_trminerfs_t reads_dconf_config_home_files;
typeattribute myloginuser_trminerfs_t reads_xdg_config_home_files;

typeattribute myloginuser_trminerfs_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_trminerfs_t traverses_data_home;
typeattribute myloginuser_trminerfs_t traverses_cache_home;

typeattribute myloginuser_trminerfs_t reads_passwd_files;

typeattribute myloginuser_trminerfs_t reads_system_state_files;

typeattribute myloginuser_trminerfs_t appends_xdm_home_files;

typeattribute myloginuser_trminerfs_t reads_urandom_device;

typeattribute myloginuser_trminerfs_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_trminerfs_t connects_to_system_bus;
typeattribute myloginuser_trminerfs_t connects_to_user_session_bus;
typeattribute myloginuser_trminerfs_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_trminerfs_t chats_with_gvfsd;

allow myloginuser_trminerfs_t random_device_t:chr_file getattr;

allow myloginuser_trminerfs_t sysctl_fs_t:dir { getattr search };
allow myloginuser_trminerfs_t sysctl_fs_t:file { read getattr open };

allow myloginuser_trminerfs_t user_home_t:dir { read getattr open search };
allow myloginuser_trminerfs_t user_home_t:file { read lock open };
allow myloginuser_trminerfs_t { bash_home_t user_home_t gtk_home_t }:file getattr;

allow myloginuser_trminerfs_t trstore_cache_home_t:dir { write remove_name search add_name };
allow myloginuser_trminerfs_t trstore_cache_home_t:file { read lock rename write getattr read create open unlink };

allow myloginuser_trminerfs_t trstore_data_home_t:dir { write add_name search };
allow myloginuser_trminerfs_t trstore_data_home_t:file { create open getattr append };

allow myloginuser_trminerfs_t trminer_config_home_t:dir { getattr search read create };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_trminerfs_t config_home_t:dir trminer_config_home_t "tracker";
')

optional_policy(`
	gen_require(`
		type ssh_home_t;
	')

	allow myloginuser_trminerfs_t ssh_home_t:dir getattr;
')

optional_policy(`
	gen_require(`
		type iceauth_home_t, xdm_t;
	')

	allow myloginuser_trminerfs_t iceauth_home_t:file getattr;

	allow myloginuser_trminerfs_t xdm_t:unix_stream_socket { getattr };
')

optional_policy(`
	gen_require(`
		type pulseaudio_home_t;
	')

	allow myloginuser_trminerfs_t pulseaudio_home_t:dir getattr;
	allow myloginuser_trminerfs_t pulseaudio_home_t:file getattr;
')

optional_policy(`
	gen_require(`
		type gpg_secret_t;
	')

	allow myloginuser_trminerfs_t gpg_secret_t:dir getattr;
')

########################################
#
# imsets
# 

type myloginuser_imsets_t, myloginuserprocess;
typeattribute myloginuser_imsets_t domain;
role myloginuser_r types myloginuser_imsets_t;

type imsets_exec_t, myloginuser_application_executable_type;
typeattribute imsets_exec_t file_type;
typeattribute imsets_exec_t non_security_file_type;
typeattribute imsets_exec_t non_auth_file_type;
typeattribute imsets_exec_t exec_type;
typeattribute imsets_exec_t application_exec_type;

allow myloginuser_imsets_t imsets_exec_t:file { read entrypoint };

typeattribute imsets_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_imsets_t started_by_user_gsession;
type_transition myloginuser_gsession_t imsets_exec_t:process myloginuser_imsets_t;

type imsets_config_home_t;
typeattribute imsets_config_home_t file_type;
typeattribute imsets_config_home_t user_home_type;

typeattribute myloginuser_imsets_t inherits_user_fd;

typeattribute myloginuser_imsets_t connects_to_user_session_bus;
typeattribute myloginuser_imsets_t chats_with_imsetd;

########################################
#
# seappl
# 

type myloginuser_seappl_t, myloginuserprocess;
typeattribute myloginuser_seappl_t domain;
role myloginuser_r types myloginuser_seappl_t;

type seappl_exec_t, myloginuser_application_executable_type;
typeattribute seappl_exec_t file_type;
typeattribute seappl_exec_t non_security_file_type;
typeattribute seappl_exec_t non_auth_file_type;
typeattribute seappl_exec_t exec_type;
typeattribute seappl_exec_t application_exec_type;

allow myloginuser_seappl_t seappl_exec_t:file { read entrypoint };

typeattribute seappl_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_seappl_t started_by_user_gsession;
type_transition myloginuser_gsession_t seappl_exec_t:process myloginuser_seappl_t;

typeattribute myloginuser_seappl_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_seappl_t reads_xdm_runtime_files;

typeattribute myloginuser_seappl_t inherits_user_fd;

typeattribute myloginuser_seappl_t traverses_user_home_dir;

typeattribute myloginuser_seappl_t traverses_data_home;

typeattribute myloginuser_seappl_t reads_passwd_files;

typeattribute myloginuser_seappl_t connects_to_system_bus;
typeattribute myloginuser_seappl_t connects_to_user_session_bus;
typeattribute myloginuser_seappl_t chats_with_gshell;

########################################
#
# trstore
# 

type myloginuser_trstore_t, myloginuserprocess;
typeattribute myloginuser_trstore_t domain;
role myloginuser_r types myloginuser_trstore_t;

type trstore_exec_t, myloginuser_application_executable_type;
typeattribute trstore_exec_t file_type;
typeattribute trstore_exec_t non_security_file_type;
typeattribute trstore_exec_t non_auth_file_type;
typeattribute trstore_exec_t exec_type;
typeattribute trstore_exec_t application_exec_type;

allow myloginuser_trstore_t trstore_exec_t:file { read entrypoint };

typeattribute trstore_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_trstore_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t trstore_exec_t:process myloginuser_trstore_t;

typeattribute trstore_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_trstore_t started_by_user_gsession;
type_transition myloginuser_gsession_t trstore_exec_t:process myloginuser_trstore_t;

type trstore_tmp_t;
typeattribute trstore_tmp_t file_type;
typeattribute trstore_tmp_t tmpfile;
typeattribute trstore_tmp_t user_tmp_type;

type trstore_cache_home_t;
typeattribute trstore_cache_home_t file_type;
typeattribute trstore_cache_home_t user_home_type;

type trstore_data_home_t;
typeattribute trstore_data_home_t file_type;
typeattribute trstore_data_home_t user_home_type;

typeattribute myloginuser_trstore_t inherits_user_fd;

typeattribute myloginuser_trstore_t traverses_user_tmp;
typeattribute myloginuser_trstore_t creates_dconf_runtime_files;

typeattribute myloginuser_trstore_t traverses_user_home_dir;

typeattribute myloginuser_trstore_t traverses_config_home;
typeattribute myloginuser_trstore_t reads_dconf_config_home_files;

typeattribute myloginuser_trstore_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_trstore_t traverses_data_home;
typeattribute myloginuser_trstore_t adds_entries_to_data_home_dirs;

typeattribute myloginuser_trstore_t traverses_cache_home;
typeattribute myloginuser_trstore_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_trstore_t traverses_tmp;
typeattribute myloginuser_trstore_t lists_tmp;
typeattribute myloginuser_trstore_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_trstore_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_trstore_t reads_passwd_files;

typeattribute myloginuser_trstore_t reads_system_state_files;

typeattribute myloginuser_trstore_t appends_xdm_home_files;

typeattribute myloginuser_trstore_t reads_urandom_device;

typeattribute myloginuser_trstore_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_trstore_t connects_to_user_session_bus;
typeattribute myloginuser_trstore_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_trstore_t chats_with_gvfsd;
typeattribute myloginuser_trstore_t chats_with_trminerfs;
typeattribute myloginuser_trstore_t chats_with_naut;

allow myloginuser_trstore_t trstore_tmp_t:file { create write unlink open };
type_transition myloginuser_trstore_t tmp_t:file trstore_tmp_t;

allow myloginuser_trstore_t random_device_t:chr_file getattr;

allow myloginuser_trstore_t myloginuser_trminerfs_t:fifo_file read;

allow myloginuser_trstore_t trstore_cache_home_t:dir { create write remove_name add_name search getattr };
allow myloginuser_trstore_t trstore_cache_home_t:file { rename write getattr read create unlink open lock };

allow myloginuser_trstore_t trstore_data_home_t:dir { create getattr search write add_name remove_name };
allow myloginuser_trstore_t trstore_data_home_t:file { create open getattr append unlink read write };

allow myloginuser_trstore_t trminer_config_home_t:dir { search getattr read create };

optional_policy(`
	gen_require(`
		type cache_home_t, data_home_t, config_home_t;
	')

	type_transition myloginuser_trstore_t cache_home_t:dir trstore_cache_home_t "tracker";
	type_transition myloginuser_trstore_t data_home_t:dir trstore_data_home_t "tracker";
	type_transition myloginuser_trstore_t config_home_t:dir trminer_config_home_t "tracker";
')

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	allow myloginuser_trstore_t xdm_t:unix_stream_socket { getattr };
')

########################################
#
# xdgudirupd
# 

type myloginuser_xdgudirupd_t, myloginuserprocess;
typeattribute myloginuser_xdgudirupd_t domain;
role myloginuser_r types myloginuser_xdgudirupd_t;

type xdgudirupd_exec_t, myloginuser_application_executable_type;
typeattribute xdgudirupd_exec_t file_type;
typeattribute xdgudirupd_exec_t non_security_file_type;
typeattribute xdgudirupd_exec_t non_auth_file_type;
typeattribute xdgudirupd_exec_t exec_type;
typeattribute xdgudirupd_exec_t application_exec_type;

allow myloginuser_xdgudirupd_t xdgudirupd_exec_t:file { read entrypoint };

typeattribute xdgudirupd_exec_t started_by_user_exec_type;
typeattribute myloginuser_xdgudirupd_t started_by_user;
type_transition myloginuser_t xdgudirupd_exec_t:process myloginuser_xdgudirupd_t;

typeattribute xdgudirupd_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_xdgudirupd_t started_by_user_gsession;
type_transition myloginuser_gsession_t xdgudirupd_exec_t:process myloginuser_xdgudirupd_t;

type xdg_config_home_t;
typeattribute xdg_config_home_t file_type;
typeattribute xdg_config_home_t user_home_type;

typeattribute myloginuser_xdgudirupd_t traverses_user_home_dir;
typeattribute myloginuser_xdgudirupd_t adds_entries_to_user_home_dirs;
typeattribute myloginuser_xdgudirupd_t removes_entries_from_user_home_dirs;

typeattribute myloginuser_xdgudirupd_t traverses_config_home;
typeattribute myloginuser_xdgudirupd_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_xdgudirupd_t removes_entries_from_config_home_dirs;;
typeattribute myloginuser_xdgudirupd_t reads_xdg_config_home_files;

typeattribute myloginuser_xdgudirupd_t traverses_data_home;
typeattribute myloginuser_xdgudirupd_t manages_gtk_bookmarks;

typeattribute myloginuser_xdgudirupd_t traverses_var_lib;

typeattribute myloginuser_xdgudirupd_t reads_passwd_files;

typeattribute myloginuser_xdgudirupd_t gets_attributes_of_xattr_fs;

allow myloginuser_xdgudirupd_t user_home_t:dir { create getattr };
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Desktop";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Documents";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Downloads";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Music";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Pictures";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Public";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Templates";
type_transition myloginuser_xdgudirupd_t user_home_dir_t:dir user_home_t "Videos";

type_transition myloginuser_xdgudirupd_t user_home_dir_t:file gtk_home_t;

allow myloginuser_xdgudirupd_t xdg_config_home_t:file { create write rename };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_xdgudirupd_t config_home_t:file xdg_config_home_t;
')

optional_policy(`
	gen_require(`
		type sssd_var_lib_t;
	')

	allow myloginuser_xdgudirupd_t sssd_var_lib_t:dir { getattr search };
')

########################################
#
# xdgudirupd grouped policy
#

allow reads_xdg_config_home_files xdg_config_home_t:file { read getattr open };

########################################
#
# xdg
#

optional_policy(`
	gen_require(`
		type cache_home_t, config_home_t, data_home_t, gconf_home_t;
		type gconf_etc_t;
	')

	allow traverses_gconf_home gconf_home_t:dir { getattr search };
	allow traverses_cache_home cache_home_t:dir { getattr search };
	allow traverses_config_home config_home_t:dir { getattr search };
	allow traverses_data_home { gconf_home_t data_home_t }:dir { getattr search };

	allow lists_data_home data_home_t:dir { read open };
	allow lists_config_home config_home_t:dir { read open };
	allow lists_cache_home cache_home_t:dir { read open };
	allow lists_gconf_home gconf_home_t:dir { read open };

	allow adds_entries_to_gconf_home_dirs gconf_home_t:dir { write add_name };
	allow adds_entries_to_config_home_dirs config_home_t:dir { write add_name };
	allow adds_entries_to_data_home_dirs data_home_t:dir { write add_name };
	allow adds_entries_to_cache_home_dirs cache_home_t:dir { write add_name };

	allow removes_entries_from_data_home_dirs data_home_t:dir { write remove_name };
	allow removes_entries_from_config_home_dirs config_home_t:dir { write remove_name };
	allow removes_entries_from_cache_home_dirs cache_home_t:dir { write remove_name };

	allow creates_config_home_dirs config_home_t:dir create;
	type_transition creates_config_home_dirs { user_home_dir_t admin_home_t }:dir config_home_t ".config";

	allow creates_gconf_home_dirs gconf_home_t:dir create;
	type_transition creates_gconf_home_dirs { user_home_dir_t admin_home_t }:dir gconf_home_t ".local";

	allow creates_cache_home_dirs cache_home_t:dir create;
	type_transition creates_cache_home_dirs { user_home_dir_t admin_home_t }:dir cache_home_t ".cache";

	allow creates_data_home_dirs data_home_t:dir create;
	type_transition creates_data_home_dirs gconf_home_t:dir data_home_t "share";

	allow reads_gconf_config_files gconf_etc_t:dir { getattr search };
	allow reads_gconf_config_files gconf_etc_t:file { read getattr open };
')

########################################
#
# canberra
# 

type myloginuser_canberra_t, myloginuserprocess;
typeattribute myloginuser_canberra_t domain;
role myloginuser_r types myloginuser_canberra_t;

type canberra_exec_t, myloginuser_application_executable_type;
typeattribute canberra_exec_t file_type;
typeattribute canberra_exec_t non_security_file_type;
typeattribute canberra_exec_t non_auth_file_type;
typeattribute canberra_exec_t exec_type;
typeattribute canberra_exec_t application_exec_type;

allow myloginuser_canberra_t canberra_exec_t:file { read entrypoint };

typeattribute canberra_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_canberra_t started_by_user_gsession;
type_transition myloginuser_gsession_t canberra_exec_t:process myloginuser_canberra_t;

type esc_cache_home_t;
typeattribute esc_cache_home_t file_type;
typeattribute esc_cache_home_t user_home_type;

typeattribute myloginuser_canberra_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_canberra_t reads_xdm_runtime_files;

typeattribute myloginuser_canberra_t inherits_user_fd;

typeattribute myloginuser_canberra_t traverses_user_tmp;

typeattribute myloginuser_canberra_t traverses_user_home_dir;
typeattribute myloginuser_canberra_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_canberra_t traverses_data_home;
typeattribute myloginuser_canberra_t traverses_sounds_data_home;

typeattribute myloginuser_canberra_t traverses_gtk_home;

typeattribute myloginuser_canberra_t traverses_config_home;

typeattribute myloginuser_canberra_t traverses_cache_home;
typeattribute myloginuser_canberra_t adds_entries_to_cache_home_dirs;
typeattribute myloginuser_canberra_t reads_esc_cache_home_files;

typeattribute myloginuser_canberra_t traverses_var_lib;
typeattribute myloginuser_canberra_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_canberra_t reads_passwd_files;

typeattribute myloginuser_canberra_t reads_system_state_files;

typeattribute myloginuser_canberra_t reads_urandom_device;

typeattribute myloginuser_canberra_t connects_to_user_session_bus;
typeattribute myloginuser_canberra_t chats_with_gvfsd;
typeattribute myloginuser_canberra_t chats_with_atspi2;

typeattribute myloginuser_canberra_t runs_pulseaudio;
typeattribute myloginuser_canberra_t is_pulseaudio_client;

allow myloginuser_canberra_t myloginuser_transmissiongtk_t:fd use;
allow myloginuser_canberra_t myloginuser_transmissiongtk_t:fifo_file { read write getattr ioctl };
allow myloginuser_canberra_t myloginuser_transmissiongtk_t:process sigchld;

allow myloginuser_transmissiongtk_t canberra_exec_t:file { getattr open read execute };
allow myloginuser_transmissiongtk_t myloginuser_canberra_t:process transition;
type_transition myloginuser_transmissiongtk_t canberra_exec_t:process myloginuser_canberra_t;

allow myloginuser_canberra_t esc_cache_home_t:file { create write lock };

optional_policy(`
	gen_require(`
		type cache_home_t;
	')

	type_transition myloginuser_canberra_t cache_home_t:file esc_cache_home_t;
')

########################################
#
# canberra grouped policy
#

allow reads_esc_cache_home_files esc_cache_home_t:file { read getattr open };

########################################
#
# evoalarm
# 

type myloginuser_evoalarm_t, myloginuserprocess;
typeattribute myloginuser_evoalarm_t domain;
role myloginuser_r types myloginuser_evoalarm_t;

type evoalarm_exec_t, myloginuser_application_executable_type;
typeattribute evoalarm_exec_t file_type;
typeattribute evoalarm_exec_t non_security_file_type;
typeattribute evoalarm_exec_t non_auth_file_type;
typeattribute evoalarm_exec_t exec_type;
typeattribute evoalarm_exec_t application_exec_type;

allow myloginuser_evoalarm_t evoalarm_exec_t:file { read entrypoint };

typeattribute evoalarm_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_evoalarm_t started_by_user_gsession;
type_transition myloginuser_gsession_t evoalarm_exec_t:process myloginuser_evoalarm_t;

typeattribute myloginuser_evoalarm_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_evoalarm_t reads_xdm_runtime_files;

typeattribute myloginuser_evoalarm_t inherits_user_fd;

typeattribute myloginuser_evoalarm_t traverses_user_tmp;
typeattribute myloginuser_evoalarm_t creates_dconf_runtime_files;

typeattribute myloginuser_evoalarm_t traverses_user_home_dir;

typeattribute myloginuser_evoalarm_t traverses_config_home;
typeattribute myloginuser_evoalarm_t reads_dconf_config_home_files;

typeattribute myloginuser_evoalarm_t traverses_data_home;
typeattribute myloginuser_evoalarm_t traverses_gtk_home;

typeattribute myloginuser_evoalarm_t reads_passwd_files;

typeattribute myloginuser_evoalarm_t reads_system_state_files;

typeattribute myloginuser_evoalarm_t connects_to_user_session_bus;
typeattribute myloginuser_evoalarm_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_evoalarm_t chats_with_gvfsd;
typeattribute myloginuser_evoalarm_t chats_with_atspi2;

########################################
#
# evosrcreg
# 

type myloginuser_evosrcreg_t, myloginuserprocess;
typeattribute myloginuser_evosrcreg_t domain;
role myloginuser_r types myloginuser_evosrcreg_t;

type evosrcreg_exec_t, myloginuser_application_executable_type;
typeattribute evosrcreg_exec_t file_type;
typeattribute evosrcreg_exec_t non_security_file_type;
typeattribute evosrcreg_exec_t non_auth_file_type;
typeattribute evosrcreg_exec_t exec_type;
typeattribute evosrcreg_exec_t application_exec_type;

allow myloginuser_evosrcreg_t evosrcreg_exec_t:file { read entrypoint };

typeattribute evosrcreg_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_evosrcreg_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t evosrcreg_exec_t:process myloginuser_evosrcreg_t;

type evolution_cache_home_t;
typeattribute evolution_cache_home_t file_type;
typeattribute evolution_cache_home_t user_home_type;

type evolution_data_home_t;
typeattribute evolution_data_home_t file_type;
typeattribute evolution_data_home_t user_home_type;

type evolution_config_home_t;
typeattribute evolution_config_home_t file_type;
typeattribute evolution_config_home_t user_home_type;

typeattribute myloginuser_evosrcreg_t traverses_user_home_dir;

typeattribute myloginuser_evosrcreg_t traverses_cache_home;
typeattribute myloginuser_evosrcreg_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_evosrcreg_t traverses_config_home;
typeattribute myloginuser_evosrcreg_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_evosrcreg_t traverses_data_home;
typeattribute myloginuser_evosrcreg_t adds_entries_to_data_home_dirs;

typeattribute myloginuser_evosrcreg_t reads_passwd_files;

typeattribute myloginuser_evosrcreg_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_evosrcreg_t connects_to_user_session_bus;
typeattribute myloginuser_evosrcreg_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_evosrcreg_t chats_with_gvfsd;
typeattribute myloginuser_evosrcreg_t chats_with_goad;
typeattribute myloginuser_evosrcreg_t chats_with_evoalarm;

allow myloginuser_evosrcreg_t evolution_cache_home_t:dir { create search write read open add_name getattr };

allow myloginuser_evosrcreg_t evolution_data_home_t:dir { create write read open add_name getattr search };

allow myloginuser_evosrcreg_t evolution_config_home_t:dir { create write read getattr open add_name search };

optional_policy(`
        gen_require(`
                type cache_home_t, data_home_t, config_home_t;
        ')

	type_transition myloginuser_evosrcreg_t cache_home_t:dir evolution_cache_home_t "evolution";
	type_transition myloginuser_evosrcreg_t data_home_t:dir evolution_data_home_t "evolution";
	type_transition myloginuser_evosrcreg_t config_home_t:dir evolution_config_home_t "evolution";
')

########################################
#
# gconfd2
# 

type myloginuser_gconfd2_t, myloginuserprocess;
typeattribute myloginuser_gconfd2_t domain;
role myloginuser_r types myloginuser_gconfd2_t;

type gconfd2_exec_t, myloginuser_application_executable_type;
typeattribute gconfd2_exec_t file_type;
typeattribute gconfd2_exec_t non_security_file_type;
typeattribute gconfd2_exec_t non_auth_file_type;
typeattribute gconfd2_exec_t exec_type;
typeattribute gconfd2_exec_t application_exec_type;

allow myloginuser_gconfd2_t gconfd2_exec_t:file { read entrypoint };

typeattribute gconfd2_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gconfd2_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gconfd2_exec_t:process myloginuser_gconfd2_t;

typeattribute myloginuser_gconfd2_t traverses_user_home_dir;

typeattribute myloginuser_gconfd2_t traverses_config_home;
typeattribute myloginuser_gconfd2_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_gconfd2_t reads_passwd_files;

typeattribute myloginuser_gconfd2_t reads_gconf_config_files;

typeattribute myloginuser_gconfd2_t connects_to_system_bus;
typeattribute myloginuser_gconfd2_t connects_to_user_session_bus;
typeattribute myloginuser_gconfd2_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gconfd2_t chats_with_nmappl;

allow myloginuser_gconfd2_t gconf_config_home_t:dir { search read create write getattr remove_name open add_name };
allow myloginuser_gconfd2_t gconf_config_home_t:file { rename write getattr create unlink open read setattr };

optional_policy(`
	gen_require(`
		type gconf_etc_t;
	')

	allow myloginuser_gconfd2_t gconf_etc_t:dir { read open };
')

########################################
#
# goad
# 

type myloginuser_goad_t, myloginuserprocess;
typeattribute myloginuser_goad_t domain;
role myloginuser_r types myloginuser_goad_t;

type goad_exec_t, myloginuser_application_executable_type;
typeattribute goad_exec_t file_type;
typeattribute goad_exec_t non_security_file_type;
typeattribute goad_exec_t non_auth_file_type;
typeattribute goad_exec_t exec_type;
typeattribute goad_exec_t application_exec_type;

allow myloginuser_goad_t goad_exec_t:file { read entrypoint };

typeattribute goad_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_goad_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t goad_exec_t:process myloginuser_goad_t;

type primary_tmp_t;
typeattribute primary_tmp_t file_type;
typeattribute primary_tmp_t tmpfile;
typeattribute primary_tmp_t user_tmp_type;

type krb5cc_tmp_t;
typeattribute krb5cc_tmp_t file_type;
typeattribute krb5cc_tmp_t tmpfile;
typeattribute krb5cc_tmp_t user_tmp_type;

type goa_config_home_t;
typeattribute goa_config_home_t file_type;
typeattribute goa_config_home_t user_home_type;

typeattribute myloginuser_goad_t traverses_user_tmp;
typeattribute myloginuser_goad_t lists_user_tmp;
typeattribute myloginuser_goad_t adds_entries_to_user_tmp_dirs;
typeattribute myloginuser_goad_t removes_entries_from_user_tmp_dirs;

typeattribute myloginuser_goad_t traverses_user_home_dir;

typeattribute myloginuser_goad_t traverses_config_home;
typeattribute myloginuser_goad_t reads_dconf_config_home_files;

typeattribute myloginuser_goad_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_goad_t traverses_tmp;
typeattribute myloginuser_goad_t lists_tmp;

typeattribute myloginuser_goad_t reads_passwd_files;

typeattribute myloginuser_goad_t reads_urandom_device;

typeattribute myloginuser_goad_t logs_to_system;

typeattribute myloginuser_goad_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_goad_t connects_to_user_session_bus;
typeattribute myloginuser_goad_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_goad_t chats_with_gvfsd;
typeattribute myloginuser_goad_t chats_with_tpmc;
typeattribute myloginuser_goad_t chats_with_gdtrackergdatam;

dontaudit myloginuser_goad_t self:process setfscreate;
dontaudit myloginuser_goad_t user_tmp_t:dir create;
dontaudit myloginuser_goad_t selinux_config_t:dir search;

allow myloginuser_goad_t krb5cc_tmp_t:dir { search getattr create read open remove_name write add_name };
type_transition myloginuser_goad_t user_tmp_t:dir krb5cc_tmp_t "krb5cc";

type_transition myloginuser_goad_t krb5cc_tmp_t:file primary_tmp_t;

allow myloginuser_goad_t primary_tmp_t:file { create write rename open setattr };
type_transition myloginuser_goad_t user_tmp_t:file primary_tmp_t;

allow myloginuser_goad_t goa_config_home_t:dir { create read getattr search };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_goad_t config_home_t:dir goa_config_home_t;
')

optional_policy(`
	gen_require(`
		type krb5_conf_t;
	')

	allow myloginuser_goad_t krb5_conf_t:file { read getattr open };
')

########################################
#
# evocalf
# 

type myloginuser_evocalf_t, myloginuserprocess;
typeattribute myloginuser_evocalf_t domain;
role myloginuser_r types myloginuser_evocalf_t;

type evocalf_exec_t, myloginuser_application_executable_type;
typeattribute evocalf_exec_t file_type;
typeattribute evocalf_exec_t non_security_file_type;
typeattribute evocalf_exec_t non_auth_file_type;
typeattribute evocalf_exec_t exec_type;
typeattribute evocalf_exec_t application_exec_type;

allow myloginuser_evocalf_t evocalf_exec_t:file { read entrypoint };

typeattribute evocalf_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_evocalf_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t evocalf_exec_t:process myloginuser_evocalf_t;

typeattribute myloginuser_evocalf_t traverses_user_tmp;
typeattribute myloginuser_evocalf_t creates_dconf_runtime_files;

typeattribute myloginuser_evocalf_t traverses_user_home_dir;

typeattribute myloginuser_evocalf_t traverses_config_home;
typeattribute myloginuser_evocalf_t reads_dconf_config_home_files;

typeattribute myloginuser_evocalf_t traverses_data_home;
typeattribute myloginuser_evocalf_t reads_metadata_data_home_files;

typeattribute myloginuser_evocalf_t traverses_cache_home;

typeattribute myloginuser_evocalf_t reads_passwd_files;

typeattribute myloginuser_evocalf_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_evocalf_t connects_to_user_session_bus;
typeattribute myloginuser_evocalf_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_evocalf_t chats_with_gvfsd;
typeattribute myloginuser_evocalf_t chats_with_gvfsd_metadata;
typeattribute myloginuser_evocalf_t chats_with_goad;
typeattribute myloginuser_evocalf_t chats_with_evoalarm;
typeattribute myloginuser_evocalf_t chats_with_evosrcreg;
typeattribute myloginuser_evocalf_t chats_with_gshellcald;

allow myloginuser_evocalf_t self:netlink_route_socket { getattr setopt getopt bind create nlmsg_read read write };

allow myloginuser_evocalf_t evolution_cache_home_t:dir getattr;

allow myloginuser_evocalf_t evolution_data_home_t:dir { write remove_name create add_name getattr search };
allow myloginuser_evocalf_t evolution_data_home_t:file { write rename create open getattr read unlink };

########################################
#
# gshellcald
# 

type myloginuser_gshellcald_t, myloginuserprocess;
typeattribute myloginuser_gshellcald_t domain;
role myloginuser_r types myloginuser_gshellcald_t;

type gshellcald_exec_t, myloginuser_application_executable_type;
typeattribute gshellcald_exec_t file_type;
typeattribute gshellcald_exec_t non_security_file_type;
typeattribute gshellcald_exec_t non_auth_file_type;
typeattribute gshellcald_exec_t exec_type;
typeattribute gshellcald_exec_t application_exec_type;

allow myloginuser_gshellcald_t gshellcald_exec_t:file { read entrypoint };

typeattribute gshellcald_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gshellcald_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gshellcald_exec_t:process myloginuser_gshellcald_t;

typeattribute myloginuser_gshellcald_t traverses_user_tmp;
typeattribute myloginuser_gshellcald_t creates_dconf_runtime_files;

typeattribute myloginuser_gshellcald_t traverses_user_home_dir;

typeattribute myloginuser_gshellcald_t traverses_config_home;
typeattribute myloginuser_gshellcald_t reads_dconf_config_home_files;

typeattribute myloginuser_gshellcald_t reads_passwd_files;

typeattribute myloginuser_gshellcald_t connects_to_user_session_bus;
typeattribute myloginuser_gshellcald_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gshellcald_t chats_with_gshell;
typeattribute myloginuser_gshellcald_t chats_with_evosrcreg;

########################################
#
# tpmc
# 

type myloginuser_tpmc_t, myloginuserprocess;
typeattribute myloginuser_tpmc_t domain;
role myloginuser_r types myloginuser_tpmc_t;

typeattribute myloginuser_tpmc_t started_by_user_session_bus;

typeattribute myloginuser_tpmc_t traverses_user_tmp;
typeattribute myloginuser_tpmc_t creates_dconf_runtime_files;

typeattribute myloginuser_tpmc_t traverses_user_home_dir;

typeattribute myloginuser_tpmc_t lists_tmp;

typeattribute myloginuser_tpmc_t traverses_config_home;
typeattribute myloginuser_tpmc_t reads_dconf_config_home_files;

typeattribute myloginuser_tpmc_t traverses_data_home;
typeattribute myloginuser_tpmc_t adds_entries_to_data_home_dirs;

typeattribute myloginuser_tpmc_t traverses_cache_home;

typeattribute myloginuser_tpmc_t reads_passwd_files;

typeattribute myloginuser_tpmc_t reads_urandom_device;

typeattribute myloginuser_tpmc_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_tpmc_t connects_to_system_bus;
typeattribute myloginuser_tpmc_t connects_to_user_session_bus;
typeattribute myloginuser_tpmc_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_tpmc_t chats_with_gkrd;
typeattribute myloginuser_tpmc_t chats_with_gshell;

allow myloginuser_tpmc_t urandom_device_t:chr_file ioctl;

optional_policy(`
	gen_require(`
		type telepathy_mission_control_exec_t, telepathy_data_home_t;
		type telepathy_mission_control_data_home_t;
	')

	typeattribute telepathy_mission_control_exec_t started_by_user_session_bus_exec_type;	

	type_transition myloginuser_dbusd_t telepathy_mission_control_exec_t:process myloginuser_tpmc_t;
	allow myloginuser_tpmc_t telepathy_mission_control_exec_t:file { read entrypoint };

	allow myloginuser_tpmc_t telepathy_data_home_t:dir { write remove_name getattr add_name create search };

	optional_policy(`
		gen_require(`
			type data_home_t;
		')

		type_transition myloginuser_tpmc_t data_home_t:dir telepathy_data_home_t "telepathy";
	')

	allow myloginuser_tpmc_t telepathy_mission_control_data_home_t:dir { write remove_name getattr add_name create search };
	allow myloginuser_tpmc_t telepathy_mission_control_data_home_t:file { rename write getattr read create open unlink };
	type_transition myloginuser_tpmc_t telepathy_data_home_t:dir telepathy_mission_control_data_home_t "mission-control";
')

########################################
#
# gboxsrchp
# 

type myloginuser_gboxsrchp_t, myloginuserprocess;
typeattribute myloginuser_gboxsrchp_t domain;
role myloginuser_r types myloginuser_gboxsrchp_t;

type gboxsrchp_exec_t, myloginuser_application_executable_type;
typeattribute gboxsrchp_exec_t file_type;
typeattribute gboxsrchp_exec_t non_security_file_type;
typeattribute gboxsrchp_exec_t non_auth_file_type;
typeattribute gboxsrchp_exec_t exec_type;
typeattribute gboxsrchp_exec_t application_exec_type;

allow myloginuser_gboxsrchp_t gboxsrchp_exec_t:file { read entrypoint };

typeattribute gboxsrchp_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gboxsrchp_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gboxsrchp_exec_t:process myloginuser_gboxsrchp_t;

type gbox_config_home_t;
typeattribute gbox_config_home_t file_type;
typeattribute gbox_config_home_t user_home_type;

typeattribute myloginuser_gboxsrchp_t traverses_user_home_dir;

typeattribute myloginuser_gboxsrchp_t traverses_config_home;

typeattribute myloginuser_gboxsrchp_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_gboxsrchp_t reads_passwd_files;

typeattribute myloginuser_gboxsrchp_t connects_to_user_session_bus;
typeattribute myloginuser_gboxsrchp_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gboxsrchp_t chats_with_gvfsd;
typeattribute myloginuser_gboxsrchp_t chats_with_gshell;

allow myloginuser_gboxsrchp_t gbox_config_home_t:dir { write search read create open add_name };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_gboxsrchp_t config_home_t:dir gbox_config_home_t "gnome-boxes";
')

########################################
#
# gdocsrchp
# 

type myloginuser_gdocsrchp_t, myloginuserprocess;
typeattribute myloginuser_gdocsrchp_t domain;
role myloginuser_r types myloginuser_gdocsrchp_t;

type gdocsrchp_exec_t, myloginuser_application_executable_type;
typeattribute gdocsrchp_exec_t file_type;
typeattribute gdocsrchp_exec_t non_security_file_type;
typeattribute gdocsrchp_exec_t non_auth_file_type;
typeattribute gdocsrchp_exec_t exec_type;
typeattribute gdocsrchp_exec_t application_exec_type;

allow myloginuser_gdocsrchp_t gdocsrchp_exec_t:file { read entrypoint };

typeattribute gdocsrchp_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gdocsrchp_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gdocsrchp_exec_t:process myloginuser_gdocsrchp_t;

typeattribute myloginuser_gdocsrchp_t runs_gjsconsole;

typeattribute myloginuser_gdocsrchp_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gdocsrchp_t reads_xdm_runtime_files;

typeattribute myloginuser_gdocsrchp_t traverses_user_home_dir;

typeattribute myloginuser_gdocsrchp_t reads_system_state_files;

typeattribute myloginuser_gdocsrchp_t connects_to_user_session_bus;

allow myloginuser_gdocsrchp_t gdocsrchp_exec_t:file { ioctl open getattr };

########################################
#
# gconsrchp
# 

type myloginuser_gconsrchp_t, myloginuserprocess;
typeattribute myloginuser_gconsrchp_t domain;
role myloginuser_r types myloginuser_gconsrchp_t;

type gconsrchp_exec_t, myloginuser_application_executable_type;
typeattribute gconsrchp_exec_t file_type;
typeattribute gconsrchp_exec_t non_security_file_type;
typeattribute gconsrchp_exec_t non_auth_file_type;
typeattribute gconsrchp_exec_t exec_type;
typeattribute gconsrchp_exec_t application_exec_type;

allow myloginuser_gconsrchp_t gconsrchp_exec_t:file { read entrypoint };

typeattribute gconsrchp_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gconsrchp_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gconsrchp_exec_t:process myloginuser_gconsrchp_t;

type contacts_cache_home_t;
typeattribute contacts_cache_home_t file_type;
typeattribute contacts_cache_home_t user_home_type;

type contacts_data_home_t;
typeattribute contacts_data_home_t file_type;
typeattribute contacts_data_home_t user_home_type;

typeattribute myloginuser_gconsrchp_t traverses_user_tmp;
typeattribute myloginuser_gconsrchp_t creates_dconf_runtime_files;

typeattribute myloginuser_gconsrchp_t traverses_user_home_dir;

typeattribute myloginuser_gconsrchp_t traverses_config_home;
typeattribute myloginuser_gconsrchp_t reads_dconf_config_home_files;

typeattribute myloginuser_gconsrchp_t traverses_data_home;
typeattribute myloginuser_gconsrchp_t adds_entries_to_data_home_dirs;

typeattribute myloginuser_gconsrchp_t traverses_cache_home;
typeattribute myloginuser_gconsrchp_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_gconsrchp_t reads_passwd_files;

typeattribute myloginuser_gconsrchp_t connects_to_system_bus;
typeattribute myloginuser_gconsrchp_t connects_to_user_session_bus;
typeattribute myloginuser_gconsrchp_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gconsrchp_t chats_with_gvfsd;
typeattribute myloginuser_gconsrchp_t chats_with_gshell;
typeattribute myloginuser_gconsrchp_t chats_with_tpmc;
typeattribute myloginuser_gconsrchp_t chats_with_evosrcreg;

allow myloginuser_gconsrchp_t contacts_cache_home_t:dir { write add_name create getattr search };

allow myloginuser_gconsrchp_t contacts_data_home_t:dir { write add_name create search };
allow myloginuser_gconsrchp_t contacts_data_home_t:file { write read create open getattr };

optional_policy(`
	gen_require(`
		type cache_home_t, data_home_t;
	')

	type_transition myloginuser_gconsrchp_t cache_home_t:dir contacts_cache_home_t "folks";
	type_transition myloginuser_gconsrchp_t data_home_t:dir contacts_data_home_t "folks";
')

########################################
#
# nautsrchp
# 

type myloginuser_nautsrchp_t, myloginuserprocess;
typeattribute myloginuser_nautsrchp_t domain;
role myloginuser_r types myloginuser_nautsrchp_t;

type nautsrchp_exec_t, myloginuser_application_executable_type;
typeattribute nautsrchp_exec_t file_type;
typeattribute nautsrchp_exec_t non_security_file_type;
typeattribute nautsrchp_exec_t non_auth_file_type;
typeattribute nautsrchp_exec_t exec_type;
typeattribute nautsrchp_exec_t application_exec_type;

allow myloginuser_nautsrchp_t nautsrchp_exec_t:file { read entrypoint };

typeattribute nautsrchp_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_nautsrchp_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t nautsrchp_exec_t:process myloginuser_nautsrchp_t;

typeattribute myloginuser_nautsrchp_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_nautsrchp_t reads_xdm_runtime_files;

typeattribute myloginuser_nautsrchp_t traverses_user_tmp;
typeattribute myloginuser_nautsrchp_t creates_dconf_runtime_files;

typeattribute myloginuser_nautsrchp_t traverses_user_home_dir;
typeattribute myloginuser_nautsrchp_t lists_user_home_dir;

typeattribute myloginuser_nautsrchp_t traverses_config_home;
typeattribute myloginuser_nautsrchp_t reads_dconf_config_home_files;
typeattribute myloginuser_nautsrchp_t reads_xdg_config_home_files;

typeattribute myloginuser_nautsrchp_t traverses_data_home;
typeattribute myloginuser_nautsrchp_t reads_metadata_data_home_files;
typeattribute myloginuser_nautsrchp_t traverses_gtk_home;

typeattribute myloginuser_nautsrchp_t traverses_cache_home;

typeattribute myloginuser_nautsrchp_t reads_passwd_files;

typeattribute myloginuser_nautsrchp_t reads_urandom_device;

typeattribute myloginuser_nautsrchp_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_nautsrchp_t connects_to_user_session_bus;
typeattribute myloginuser_nautsrchp_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_nautsrchp_t chats_with_gvfsd;
typeattribute myloginuser_nautsrchp_t chats_with_gshell;
typeattribute myloginuser_nautsrchp_t chats_with_atspi2;
typeattribute myloginuser_nautsrchp_t chats_with_dconf;
typeattribute myloginuser_nautsrchp_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_nautsrchp_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_nautsrchp_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_nautsrchp_t chats_with_trstore;

typeattribute myloginuser_nautsrchp_t runs_evince;
typeattribute myloginuser_nautsrchp_t runs_nautilus;

allow myloginuser_nautsrchp_t random_device_t:chr_file getattr;

allow myloginuser_nautsrchp_t gtk_home_t:dir { read open };
allow myloginuser_nautsrchp_t gtk_home_t:file { read getattr open };

allow myloginuser_nautsrchp_t user_home_t:dir { read write getattr search };
allow myloginuser_nautsrchp_t user_home_type:{ dir file lnk_file } getattr;

allow myloginuser_nautsrchp_t trminer_config_home_t:dir { getattr search open read };

allow myloginuser_nautsrchp_t trstore_cache_home_t:dir { getattr search };
allow myloginuser_nautsrchp_t trstore_cache_home_t:file { read lock getattr write open };

allow myloginuser_nautsrchp_t user_home_type:{ file dir } audit_access;

########################################
#
# evoaddrf
# 

type myloginuser_evoaddrf_t, myloginuserprocess;
typeattribute myloginuser_evoaddrf_t domain;
role myloginuser_r types myloginuser_evoaddrf_t;

type evoaddrf_exec_t, myloginuser_application_executable_type;
typeattribute evoaddrf_exec_t file_type;
typeattribute evoaddrf_exec_t non_security_file_type;
typeattribute evoaddrf_exec_t non_auth_file_type;
typeattribute evoaddrf_exec_t exec_type;
typeattribute evoaddrf_exec_t application_exec_type;

allow myloginuser_evoaddrf_t evoaddrf_exec_t:file { read entrypoint };

typeattribute evoaddrf_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_evoaddrf_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t evoaddrf_exec_t:process myloginuser_evoaddrf_t;

typeattribute myloginuser_evoaddrf_t traverses_user_tmp;
typeattribute myloginuser_evoaddrf_t creates_dconf_runtime_files;

typeattribute myloginuser_evoaddrf_t traverses_user_home_dir;

typeattribute myloginuser_evoaddrf_t traverses_config_home;
typeattribute myloginuser_evoaddrf_t reads_dconf_config_home_files;

typeattribute myloginuser_evoaddrf_t traverses_data_home;
typeattribute myloginuser_evoaddrf_t traverses_cache_home;

typeattribute myloginuser_evoaddrf_t reads_passwd_files;

typeattribute myloginuser_evoaddrf_t reads_urandom_device;

typeattribute myloginuser_evoaddrf_t connects_to_user_session_bus;
typeattribute myloginuser_evoaddrf_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_evoaddrf_t chats_with_goad;
typeattribute myloginuser_evoaddrf_t chats_with_evosrcreg;
typeattribute myloginuser_evoaddrf_t chats_with_gconsrchp;

allow myloginuser_evoaddrf_t self:netlink_route_socket { getattr setopt read write getopt bind create nlmsg_read };

allow myloginuser_evoaddrf_t evolution_cache_home_t:dir getattr;

allow myloginuser_evoaddrf_t evolution_data_home_t:dir { write getattr read remove_name create open add_name search };
allow myloginuser_evoaddrf_t evolution_data_home_t:file { rename read lock create write getattr unlink open };

########################################
#
# xhost
# 

type myloginuser_xhost_t, myloginuserprocess;
typeattribute myloginuser_xhost_t domain;
role myloginuser_r types myloginuser_xhost_t;

type xhost_exec_t, myloginuser_application_executable_type;
typeattribute xhost_exec_t file_type;
typeattribute xhost_exec_t non_security_file_type;
typeattribute xhost_exec_t non_auth_file_type;
typeattribute xhost_exec_t exec_type;
typeattribute xhost_exec_t application_exec_type;

allow myloginuser_xhost_t xhost_exec_t:file { read entrypoint };

typeattribute xhost_exec_t started_by_user_exec_type;
typeattribute myloginuser_xhost_t started_by_user;
type_transition myloginuser_t xhost_exec_t:process myloginuser_xhost_t;

typeattribute myloginuser_xhost_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_xhost_t reads_xdm_runtime_files;

########################################
#
# gjsconsole
# 

type myloginuser_gjsconsole_t, myloginuserprocess;
typeattribute myloginuser_gjsconsole_t domain;
role myloginuser_r types myloginuser_gjsconsole_t;

type gjsconsole_exec_t, myloginuser_application_executable_type;
typeattribute gjsconsole_exec_t file_type;
typeattribute gjsconsole_exec_t non_security_file_type;
typeattribute gjsconsole_exec_t non_auth_file_type;
typeattribute gjsconsole_exec_t exec_type;
typeattribute gjsconsole_exec_t application_exec_type;

allow myloginuser_gjsconsole_t gjsconsole_exec_t:file { read entrypoint };

type gjsconsole_tmp_t;
typeattribute gjsconsole_tmp_t file_type;
typeattribute gjsconsole_tmp_t tmpfile;
typeattribute gjsconsole_tmp_t user_tmp_type;

typeattribute myloginuser_gjsconsole_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gjsconsole_t reads_xdm_runtime_files;

typeattribute myloginuser_gjsconsole_t traverses_user_tmp;
typeattribute myloginuser_gjsconsole_t creates_dconf_runtime_files;

typeattribute myloginuser_gjsconsole_t traverses_user_home_dir;

typeattribute myloginuser_gjsconsole_t traverses_config_home;
typeattribute myloginuser_gjsconsole_t reads_dconf_config_home_files;
typeattribute myloginuser_gjsconsole_t reads_xdg_config_home_files;

typeattribute myloginuser_gjsconsole_t traverses_data_home;
typeattribute myloginuser_gjsconsole_t traverses_gtk_home;

typeattribute myloginuser_gjsconsole_t traverses_cache_home;

typeattribute myloginuser_gjsconsole_t traverses_tmp;
typeattribute myloginuser_gjsconsole_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_gjsconsole_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_gjsconsole_t reads_passwd_files;

typeattribute myloginuser_gjsconsole_t reads_urandom_device;

typeattribute myloginuser_gjsconsole_t connects_to_user_session_bus;
typeattribute myloginuser_gjsconsole_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gjsconsole_t chats_with_gvfsd;
typeattribute myloginuser_gjsconsole_t chats_with_gshell;
typeattribute myloginuser_gjsconsole_t chats_with_trminerfs;
typeattribute myloginuser_gjsconsole_t chats_with_atspi2;
typeattribute myloginuser_gjsconsole_t chats_with_gdtrackergdatam;
typeattribute myloginuser_gjsconsole_t chats_with_goad;
typeattribute myloginuser_gjsconsole_t chats_with_trstore;

allow myloginuser_gjsconsole_t runs_gjsconsole:fd use;
allow myloginuser_gjsconsole_t runs_gjsconsole:fifo_file { read write getattr ioctl };
allow myloginuser_gjsconsole_t runs_gjsconsole:process sigchld;

allow runs_gjsconsole gjsconsole_exec_t:file { getattr open read execute };
allow runs_gjsconsole myloginuser_gjsconsole_t:process transition;
type_transition runs_gjsconsole gjsconsole_exec_t:process myloginuser_gjsconsole_t;

allow myloginuser_gjsconsole_t self:process execmem;

allow myloginuser_gjsconsole_t myloginuser_dbusd_t:process sigchld;

allow myloginuser_gjsconsole_t gjsconsole_tmp_t:file { write create unlink open execute getattr };
type_transition myloginuser_gjsconsole_t tmp_t:file gjsconsole_tmp_t;

allow myloginuser_gjsconsole_t random_device_t:chr_file getattr;

allow myloginuser_gjsconsole_t trstore_cache_home_t:dir search;
allow myloginuser_gjsconsole_t trstore_cache_home_t:file { read lock getattr write open };

allow myloginuser_gjsconsole_t trminer_config_home_t:dir { getattr search read };

########################################
#
# evinceprev
# 

type evinceprev_exec_t, myloginuser_application_executable_type;
typeattribute evinceprev_exec_t file_type;
typeattribute evinceprev_exec_t non_security_file_type;
typeattribute evinceprev_exec_t non_auth_file_type;
typeattribute evinceprev_exec_t exec_type;
typeattribute evinceprev_exec_t application_exec_type;

allow runs_evince evinceprev_exec_t:file { getattr open read execute };
type_transition runs_evince evinceprev_exec_t:process myloginuser_evince_t;

########################################
#
# evince
# 

type myloginuser_evince_t, myloginuserprocess;
typeattribute myloginuser_evince_t domain;
role myloginuser_r types myloginuser_evince_t;

type evince_exec_t, myloginuser_application_executable_type;
typeattribute evince_exec_t file_type;
typeattribute evince_exec_t non_security_file_type;
typeattribute evince_exec_t non_auth_file_type;
typeattribute evince_exec_t exec_type;
typeattribute evince_exec_t application_exec_type;

allow myloginuser_evince_t evince_exec_t:file { read entrypoint };

type evince_tmp_t;
typeattribute evince_tmp_t file_type;
typeattribute evince_tmp_t tmpfile;
typeattribute evince_tmp_t user_tmp_type;

type evince_config_home_t;
typeattribute evince_config_home_t file_type;
typeattribute evince_config_home_t user_home_type;

typeattribute myloginuser_evince_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_evince_t reads_xdm_runtime_files;

typeattribute myloginuser_evince_t inherits_user_fd;

typeattribute myloginuser_evince_t reads_iceauth_home_files;

typeattribute myloginuser_evince_t traverses_user_tmp;
typeattribute myloginuser_evince_t creates_dconf_runtime_files;

typeattribute myloginuser_evince_t traverses_user_home_dir;

typeattribute myloginuser_evince_t traverses_config_home;
typeattribute myloginuser_evince_t reads_dconf_config_home_files;
typeattribute myloginuser_evince_t reads_xdg_config_home_files;

typeattribute myloginuser_evince_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_evince_t creates_ibus_config_home_dirs;

typeattribute myloginuser_evince_t traverses_data_home;
typeattribute myloginuser_evince_t lists_data_home;
typeattribute myloginuser_evince_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_evince_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_evince_t reads_metadata_data_home_files;
typeattribute myloginuser_evince_t manages_recentlyused_data_home_files;
typeattribute myloginuser_evince_t manages_gtk_bookmarks;

typeattribute myloginuser_evince_t traverses_cache_home;

typeattribute myloginuser_evince_t traverses_var_lib;
typeattribute myloginuser_evince_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_evince_t traverses_tmp;
typeattribute myloginuser_evince_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_evince_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_evince_t reads_passwd_files;

typeattribute myloginuser_evince_t reads_system_state_files;

typeattribute myloginuser_evince_t reads_fonts;

typeattribute myloginuser_evince_t reads_urandom_device;
typeattribute myloginuser_evince_t reads_random_device;

typeattribute myloginuser_evince_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_evince_t connects_to_system_bus;
typeattribute myloginuser_evince_t connects_to_user_session_bus;
typeattribute myloginuser_evince_t chats_with_gvfsd;
typeattribute myloginuser_evince_t chats_with_gshell;
typeattribute myloginuser_evince_t chats_with_gsession;
typeattribute myloginuser_evince_t chats_with_gsetd;
typeattribute myloginuser_evince_t chats_with_atspi2;
typeattribute myloginuser_evince_t chats_with_dconf;
typeattribute myloginuser_evince_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_evince_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_evince_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_evince_t chats_with_gvfsd_metadata;

typeattribute myloginuser_evince_t connects_to_user_gkrd;

typeattribute myloginuser_evince_t connects_to_cups;
typeattribute myloginuser_evince_t reads_cups_config_files;

typeattribute myloginuser_evince_t runs_yelp;
typeattribute myloginuser_evince_t runs_nautilus;

allow myloginuser_evince_t runs_evince:fd use;
allow myloginuser_evince_t runs_evince:fifo_file { read write getattr ioctl };
allow myloginuser_evince_t runs_evince:process sigchld;

allow runs_evince evince_exec_t:file { getattr open read execute };
allow runs_evince myloginuser_evince_t:process transition;
type_transition runs_evince evince_exec_t:process myloginuser_evince_t;

allow myloginuser_evince_t { evince_exec_t evinceprev_exec_t }:file { getattr open read execute execute_no_trans };
allow myloginuser_evince_t evinceprev_exec_t:file { read entrypoint };

allow myloginuser_evince_t nautsendto_exec_t:file { execute getattr };

allow myloginuser_evince_t myloginuser_gsession_t:unix_stream_socket connectto;

allow myloginuser_evince_t ipp_port_t:tcp_socket name_connect;
allow myloginuser_evince_t self:tcp_socket { create connect setopt };

allow myloginuser_evince_t tmpfs_t:filesystem getattr;

dontaudit myloginuser_evince_t user_home_t:file relabelfrom;

allow myloginuser_evince_t { user_home_t user_home_dir_t }:dir { write add_name remove_name read open };
allow myloginuser_evince_t user_home_t:file { getattr read write open ioctl create rename unlink setattr };
allow myloginuser_evince_t user_home_t:dir { create rmdir setattr getattr search };
type_transition myloginuser_evince_t user_home_dir_t:{ dir file } user_home_t;

dontaudit myloginuser_evince_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_evince_t file_type:dir search;

allow myloginuser_evince_t evince_tmp_t:dir { write create unlink open add_name remove_name search getattr rmdir };
allow myloginuser_evince_t evince_tmp_t:file { write create unlink open setattr rename };
type_transition myloginuser_evince_t tmp_t:{ dir file } evince_tmp_t;

allow myloginuser_evince_t { yelp_tmp_t eog_tmp_t }:file { unlink open };

allow myloginuser_evince_t evince_config_home_t:dir { create read getattr search write remove_name add_name };
allow myloginuser_evince_t evince_config_home_t:file { rename write getattr read create unlink open };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_evince_t config_home_t:dir evince_config_home_t "evince";
')

########################################
#
# evinced
# 

type myloginuser_evinced_t, myloginuserprocess;
typeattribute myloginuser_evinced_t domain;
role myloginuser_r types myloginuser_evinced_t;

type evinced_exec_t, myloginuser_application_executable_type;
typeattribute evinced_exec_t file_type;
typeattribute evinced_exec_t non_security_file_type;
typeattribute evinced_exec_t non_auth_file_type;
typeattribute evinced_exec_t exec_type;
typeattribute evinced_exec_t application_exec_type;

allow myloginuser_evinced_t evinced_exec_t:file { read entrypoint };

typeattribute evinced_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_evinced_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t evinced_exec_t:process myloginuser_evinced_t;

typeattribute myloginuser_evinced_t connects_to_user_session_bus;
typeattribute myloginuser_evinced_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_evinced_t chats_with_evince;

########################################
#
# gtk
# 

type gtk_home_t;
typeattribute gtk_home_t file_type;
typeattribute gtk_home_t user_home_type;

########################################
#
# gtk grouped policy
#

allow traverses_gtk_home gtk_home_t:dir { getattr search };

allow manages_gtk_bookmarks gtk_home_t:dir { create getattr search write add_name remove_name read open };
allow manages_gtk_bookmarks gtk_home_t:file { write create open getattr read setattr unlink rename };

optional_policy(`
        gen_require(`
                type config_home_t;
        ')

        type_transition manages_gtk_bookmarks config_home_t:dir gtk_home_t "gtk-3.0";
')

########################################
#
# eog
# 

type myloginuser_eog_t, myloginuserprocess;
typeattribute myloginuser_eog_t domain;
role myloginuser_r types myloginuser_eog_t;

type eog_exec_t, myloginuser_application_executable_type;
typeattribute eog_exec_t file_type;
typeattribute eog_exec_t non_security_file_type;
typeattribute eog_exec_t non_auth_file_type;
typeattribute eog_exec_t exec_type;
typeattribute eog_exec_t application_exec_type;

allow myloginuser_eog_t eog_exec_t:file { read entrypoint };

typeattribute eog_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_eog_t started_by_user_gshell;
type_transition myloginuser_gshell_t eog_exec_t:process myloginuser_eog_t;

typeattribute eog_exec_t started_by_user_naut_exec_type;
typeattribute myloginuser_eog_t started_by_user_naut;
type_transition myloginuser_naut_t eog_exec_t:process myloginuser_eog_t;

type eog_tmp_t;
typeattribute eog_tmp_t file_type;
typeattribute eog_tmp_t tmpfile;
typeattribute eog_tmp_t user_tmp_type;

type eog_config_home_t;
typeattribute eog_config_home_t file_type;
typeattribute eog_config_home_t user_home_type;

typeattribute myloginuser_eog_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_eog_t reads_xdm_runtime_files;

typeattribute myloginuser_eog_t inherits_user_fd;

typeattribute myloginuser_eog_t reads_iceauth_home_files;

typeattribute myloginuser_eog_t traverses_user_tmp;
typeattribute myloginuser_eog_t creates_dconf_runtime_files;

typeattribute myloginuser_eog_t traverses_user_home_dir;
typeattribute myloginuser_eog_t lists_user_home_dir;

typeattribute myloginuser_eog_t traverses_config_home;
typeattribute myloginuser_eog_t reads_dconf_config_home_files;
typeattribute myloginuser_eog_t reads_xdg_config_home_files;

typeattribute myloginuser_eog_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_eog_t creates_ibus_config_home_dirs;

typeattribute myloginuser_eog_t traverses_data_home;
typeattribute myloginuser_eog_t lists_data_home;
typeattribute myloginuser_eog_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_eog_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_eog_t reads_metadata_data_home_files;
typeattribute myloginuser_eog_t manages_recentlyused_data_home_files;
typeattribute myloginuser_eog_t manages_gtk_bookmarks;

typeattribute myloginuser_eog_t reads_bash_home_files;

typeattribute myloginuser_eog_t traverses_cache_home;
typeattribute myloginuser_eog_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_eog_t manages_thumb_home;

typeattribute myloginuser_eog_t traverses_tmp;
typeattribute myloginuser_eog_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_eog_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_eog_t traverses_var_lib;
typeattribute myloginuser_eog_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_eog_t reads_passwd_files;

typeattribute myloginuser_eog_t reads_system_state_files;

typeattribute myloginuser_eog_t reads_fonts;

typeattribute myloginuser_eog_t reads_pulseaudio_home_files;

typeattribute myloginuser_eog_t reads_urandom_device;
typeattribute myloginuser_eog_t reads_random_device;

typeattribute myloginuser_eog_t reads_udev_runtime_files;

typeattribute myloginuser_eog_t reads_sysfs;

typeattribute myloginuser_eog_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_eog_t connects_to_system_bus;
typeattribute myloginuser_eog_t connects_to_user_session_bus;
typeattribute myloginuser_eog_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_eog_t chats_with_gvfsd;
typeattribute myloginuser_eog_t chats_with_gshell;
typeattribute myloginuser_eog_t chats_with_gsession;
typeattribute myloginuser_eog_t chats_with_atspi2;
typeattribute myloginuser_eog_t chats_with_dconf;
typeattribute myloginuser_eog_t chats_with_naut;
typeattribute myloginuser_eog_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_eog_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_eog_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_eog_t chats_with_gvfsd_metadata;

typeattribute myloginuser_eog_t connects_to_user_gkrd;

typeattribute myloginuser_eog_t connects_to_cups;
typeattribute myloginuser_eog_t reads_cups_config_files;

typeattribute myloginuser_eog_t runs_nautilus;
typeattribute myloginuser_eog_t runs_evince;
typeattribute myloginuser_eog_t runs_yelp;

allow myloginuser_eog_t ipp_port_t:tcp_socket name_connect;
allow myloginuser_eog_t self:tcp_socket { create connect setopt };

allow myloginuser_eog_t tmpfs_t:filesystem getattr;

allow myloginuser_eog_t { user_home_t user_home_dir_t }:dir { write add_name remove_name };
allow myloginuser_eog_t user_home_t:file { getattr read write open ioctl create rename unlink setattr };
allow myloginuser_eog_t user_home_t:dir { create rmdir setattr read getattr search open };
type_transition myloginuser_eog_t user_home_dir_t:file user_home_t;

dontaudit myloginuser_eog_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_eog_t file_type:dir search;

allow myloginuser_eog_t eog_exec_t:file { execute getattr };

dontaudit myloginuser_eog_t file_type:file { relabelfrom relabelto };

allow myloginuser_eog_t eog_tmp_t:file { write create unlink open setattr rename };
type_transition myloginuser_eog_t tmp_t:file eog_tmp_t;

allow myloginuser_eog_t eog_config_home_t:dir { write search add_name create getattr remove_name };
allow myloginuser_eog_t eog_config_home_t:file { rename write getattr read create open unlink };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_eog_t config_home_t:dir eog_config_home_t "eog";
')

########################################
#
# nautcs
# 

type myloginuser_nautcs_t, myloginuserprocess;
typeattribute myloginuser_nautcs_t domain;
role myloginuser_r types myloginuser_nautcs_t;

type nautcs_exec_t, myloginuser_application_executable_type;
typeattribute nautcs_exec_t file_type;
typeattribute nautcs_exec_t non_security_file_type;
typeattribute nautcs_exec_t non_auth_file_type;
typeattribute nautcs_exec_t exec_type;
typeattribute nautcs_exec_t application_exec_type;

allow myloginuser_nautcs_t nautcs_exec_t:file { read entrypoint };

########################################
#
# transmissiongtk
# 

type myloginuser_transmissiongtk_t, myloginuserprocess;
typeattribute myloginuser_transmissiongtk_t domain;
role myloginuser_r types myloginuser_transmissiongtk_t;

type transmissiongtk_exec_t, myloginuser_application_executable_type;
typeattribute transmissiongtk_exec_t file_type;
typeattribute transmissiongtk_exec_t non_security_file_type;
typeattribute transmissiongtk_exec_t non_auth_file_type;
typeattribute transmissiongtk_exec_t exec_type;
typeattribute transmissiongtk_exec_t application_exec_type;

allow myloginuser_transmissiongtk_t transmissiongtk_exec_t:file { read entrypoint };

typeattribute transmissiongtk_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_transmissiongtk_t started_by_user_gshell;
type_transition myloginuser_gshell_t transmissiongtk_exec_t:process myloginuser_transmissiongtk_t;

type transmission_cache_home_t;
typeattribute transmission_cache_home_t file_type;
typeattribute transmission_cache_home_t user_home_type;

type transmission_config_home_t;
typeattribute transmission_config_home_t file_type;
typeattribute transmission_config_home_t user_home_type;

typeattribute myloginuser_transmissiongtk_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_transmissiongtk_t reads_xdm_runtime_files;

typeattribute myloginuser_transmissiongtk_t inherits_user_fd;

typeattribute myloginuser_transmissiongtk_t reads_iceauth_home_files;

typeattribute myloginuser_transmissiongtk_t traverses_user_tmp;
typeattribute myloginuser_transmissiongtk_t creates_dconf_runtime_files;

typeattribute myloginuser_transmissiongtk_t traverses_user_home_dir;
typeattribute myloginuser_transmissiongtk_t lists_user_home_dir;

typeattribute myloginuser_transmissiongtk_t traverses_config_home;
typeattribute myloginuser_transmissiongtk_t reads_dconf_config_home_files;
typeattribute myloginuser_transmissiongtk_t reads_xdg_config_home_files;

typeattribute myloginuser_transmissiongtk_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_transmissiongtk_t creates_ibus_config_home_dirs;

typeattribute myloginuser_transmissiongtk_t traverses_data_home;
typeattribute myloginuser_transmissiongtk_t lists_data_home;
typeattribute myloginuser_transmissiongtk_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_transmissiongtk_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_transmissiongtk_t reads_metadata_data_home_files;
typeattribute myloginuser_transmissiongtk_t manages_recentlyused_data_home_files;
typeattribute myloginuser_transmissiongtk_t manages_gtk_bookmarks;

typeattribute myloginuser_transmissiongtk_t reads_bash_home_files;

typeattribute myloginuser_transmissiongtk_t traverses_cache_home;
typeattribute myloginuser_transmissiongtk_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_transmissiongtk_t traverses_var_lib;
typeattribute myloginuser_transmissiongtk_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_transmissiongtk_t reads_passwd_files;

typeattribute myloginuser_transmissiongtk_t reads_system_state_files;

typeattribute myloginuser_transmissiongtk_t reads_fonts;

typeattribute myloginuser_transmissiongtk_t reads_pulseaudio_home_files;

typeattribute myloginuser_transmissiongtk_t reads_network_config_files;

typeattribute myloginuser_transmissiongtk_t reads_urandom_device;

typeattribute myloginuser_transmissiongtk_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_transmissiongtk_t connects_to_user_session_bus;
typeattribute myloginuser_transmissiongtk_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_transmissiongtk_t chats_with_gvfsd;
typeattribute myloginuser_transmissiongtk_t chats_with_gshell;
typeattribute myloginuser_transmissiongtk_t chats_with_gsession;
typeattribute myloginuser_transmissiongtk_t chats_with_atspi2;
typeattribute myloginuser_transmissiongtk_t chats_with_dconf;
typeattribute myloginuser_transmissiongtk_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_transmissiongtk_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_transmissiongtk_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_transmissiongtk_t chats_with_gvfsd_metadata;
typeattribute myloginuser_transmissiongtk_t chats_with_gvfsd_http;

typeattribute myloginuser_transmissiongtk_t runs_nautilus;

allow myloginuser_transmissiongtk_t self:netlink_route_socket { write getattr read bind create nlmsg_read };
allow myloginuser_transmissiongtk_t self:tcp_socket { bind create setopt listen write getattr connect read getopt accept };
allow myloginuser_transmissiongtk_t self:udp_socket { getattr setopt getopt bind create connect write read };

allow myloginuser_transmissiongtk_t transmissiongtk_exec_t:file { getattr execute };

# BUG? ephemeral_port_t should be classified unreserved_port_type
allow myloginuser_transmissiongtk_t ephemeral_port_t:tcp_socket name_connect;
allow myloginuser_transmissiongtk_t unreserved_port_type:tcp_socket name_connect;
allow myloginuser_transmissiongtk_t http_port_t:tcp_socket name_connect;

allow myloginuser_transmissiongtk_t node_t:tcp_socket node_bind;
allow myloginuser_transmissiongtk_t node_t:udp_socket node_bind;

allow myloginuser_transmissiongtk_t proc_net_t:file { read getattr open };

allow myloginuser_transmissiongtk_t { user_home_t user_home_dir_t }:dir { write add_name remove_name };
allow myloginuser_transmissiongtk_t user_home_t:dir { getattr search open read rename reparent rmdir create };
allow myloginuser_transmissiongtk_t user_home_t:file { getattr read write open ioctl create rename unlink setattr };
type_transition myloginuser_transmissiongtk_t user_home_dir_t:dir user_home_t;

dontaudit myloginuser_transmissiongtk_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_transmissiongtk_t file_type:dir search;

allow myloginuser_transmissiongtk_t myloginuser_gvfsd_t:unix_stream_socket { connectto read write };
allow myloginuser_transmissiongtk_t myloginuser_gvfsd_http_t:unix_stream_socket { connectto read write };

allow myloginuser_transmissiongtk_t transmission_config_home_t:dir { write search read create open getattr add_name remove_name };
allow myloginuser_transmissiongtk_t transmission_config_home_t:file { rename write getattr read create unlink open };

allow myloginuser_transmissiongtk_t trash_data_home_t:dir { write search read create open getattr add_name remove_name };
allow myloginuser_transmissiongtk_t trash_data_home_t:file { rename write getattr read create unlink open };

allow myloginuser_transmissiongtk_t transmission_cache_home_t:dir { write remove_name getattr search create add_name };
allow myloginuser_transmissiongtk_t transmission_cache_home_t:file { rename write getattr read create open };

optional_policy(`
        gen_require(`
                type config_home_t, data_home_t, cache_home_t;
        ')

	type_transition myloginuser_transmissiongtk_t config_home_t:dir transmission_config_home_t "transmission";
	type_transition myloginuser_transmissiongtk_t data_home_t:dir trash_data_home_t "Trash";
	type_transition myloginuser_transmissiongtk_t cache_home_t:dir transmission_cache_home_t "transmission";
')

########################################
#
# gsysmon
# 

type myloginuser_gsysmon_t, myloginuserprocess;
typeattribute myloginuser_gsysmon_t domain;
role myloginuser_r types myloginuser_gsysmon_t;

type gsysmon_exec_t, myloginuser_application_executable_type;
typeattribute gsysmon_exec_t file_type;
typeattribute gsysmon_exec_t non_security_file_type;
typeattribute gsysmon_exec_t non_auth_file_type;
typeattribute gsysmon_exec_t exec_type;
typeattribute gsysmon_exec_t application_exec_type;

allow myloginuser_gsysmon_t gsysmon_exec_t:file { read entrypoint };

typeattribute gsysmon_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_gsysmon_t started_by_user_gshell;
type_transition myloginuser_gshell_t gsysmon_exec_t:process myloginuser_gsysmon_t;

type gsysmon_tmp_t;
typeattribute gsysmon_tmp_t file_type;
typeattribute gsysmon_tmp_t tmpfile;
typeattribute gsysmon_tmp_t user_tmp_type;

typeattribute myloginuser_gsysmon_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gsysmon_t reads_xdm_runtime_files;

typeattribute myloginuser_gsysmon_t inherits_user_fd;

typeattribute myloginuser_gsysmon_t traverses_user_tmp;
typeattribute myloginuser_gsysmon_t lists_user_tmp;
typeattribute myloginuser_gsysmon_t adds_entries_to_user_tmp_dirs;
typeattribute myloginuser_gsysmon_t removes_entries_from_user_tmp_dirs;
typeattribute myloginuser_gsysmon_t creates_dconf_runtime_files;

typeattribute myloginuser_gsysmon_t traverses_user_home_dir;

typeattribute myloginuser_gsysmon_t traverses_config_home;
typeattribute myloginuser_gsysmon_t reads_dconf_config_home_files;

typeattribute myloginuser_gsysmon_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_gsysmon_t creates_ibus_config_home_dirs;

typeattribute myloginuser_gsysmon_t traverses_data_home;
typeattribute myloginuser_gsysmon_t traverses_gtk_home;

typeattribute myloginuser_gsysmon_t traverses_var_lib;
typeattribute myloginuser_gsysmon_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_gsysmon_t reads_passwd_files;

typeattribute myloginuser_gsysmon_t reads_fonts;

typeattribute myloginuser_gsysmon_t reads_logind_sessions;

typeattribute myloginuser_gsysmon_t reads_init_state;
typeattribute myloginuser_gsysmon_t traverses_init_runtime;

typeattribute myloginuser_gsysmon_t reads_system_state_files;
typeattribute myloginuser_gsysmon_t reads_myloginuserprocess_state;

typeattribute myloginuser_gsysmon_t reads_urandom_device;

typeattribute myloginuser_gsysmon_t reads_sysfs;

typeattribute myloginuser_gsysmon_t traverses_cgroup;

typeattribute myloginuser_gsysmon_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gsysmon_t connects_to_user_session_bus;
typeattribute myloginuser_gsysmon_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gsysmon_t chats_with_gvfsd;
typeattribute myloginuser_gsysmon_t chats_with_gshell;
typeattribute myloginuser_gsysmon_t chats_with_atspi2;
typeattribute myloginuser_gsysmon_t chats_with_dconf;
typeattribute myloginuser_gsysmon_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_gsysmon_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_gsysmon_t chats_with_gvfsd_afcvolmon;

typeattribute myloginuser_gsysmon_t runs_yelp;

allow myloginuser_gsysmon_t self:udp_socket { create ioctl };
allow myloginuser_gsysmon_t self:netlink_route_socket { getattr setopt getopt bind create nlmsg_read read write };

allow myloginuser_gsysmon_t gsysmon_tmp_t:sock_file { create unlink getattr write };

type_transition myloginuser_gsysmon_t user_tmp_t:sock_file gsysmon_tmp_t;

allow myloginuser_gsysmon_t proc_t:dir { open read };
allow myloginuser_gsysmon_t proc_net_t:file { read getattr open };

allow myloginuser_gsysmon_t fusefs_t:dir getattr;
allow myloginuser_gsysmon_t fusefs_t:filesystem getattr;

dontaudit myloginuser_gsysmon_t domain:dir { search getattr };

allow myloginuser_gsysmon_t myloginuserprocess:process getattr;
allow myloginuser_gsysmon_t myloginuserprocess:dir { read open };

allow myloginuser_gsysmon_t security_t:dir { getattr search };
allow myloginuser_gsysmon_t security_t:file { read getattr open };
allow myloginuser_gsysmon_t security_t:filesystem getattr;

dontaudit myloginuser_gsysmon_t filesystem_type:filesystem getattr;
allow myloginuser_gsysmon_t sysctl_fs_t:dir { getattr search };

allow myloginuser_gsysmon_t exec_type:file { getattr execute };

optional_policy(`
	gen_require(`
		type systemd_unit_file_t;
	')

	allow myloginuser_gsysmon_t systemd_unit_file_t:dir getattr;
')

########################################
#
# gsysmon grouped policy
#

allow myloginuser_gsysmon_t gsysmon_reads_process_state:process getattr;
allow myloginuser_gsysmon_t gsysmon_reads_process_state:dir { getattr search };
allow myloginuser_gsysmon_t gsysmon_reads_process_state:file { read getattr open };
allow myloginuser_gsysmon_t gsysmon_reads_process_state:lnk_file read;

########################################
#
# dejadupprefs
# 

type myloginuser_dejadupprefs_t, myloginuserprocess;
typeattribute myloginuser_dejadupprefs_t domain;
role myloginuser_r types myloginuser_dejadupprefs_t;

type dejadupprefs_exec_t, myloginuser_application_executable_type;
typeattribute dejadupprefs_exec_t file_type;
typeattribute dejadupprefs_exec_t non_security_file_type;
typeattribute dejadupprefs_exec_t non_auth_file_type;
typeattribute dejadupprefs_exec_t exec_type;
typeattribute dejadupprefs_exec_t application_exec_type;

allow myloginuser_dejadupprefs_t dejadupprefs_exec_t:file { read entrypoint };

typeattribute dejadupprefs_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_dejadupprefs_t started_by_user_gshell;
type_transition myloginuser_gshell_t dejadupprefs_exec_t:process myloginuser_dejadupprefs_t;

typeattribute myloginuser_dejadupprefs_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_dejadupprefs_t reads_xdm_runtime_files;

typeattribute myloginuser_dejadupprefs_t inherits_user_fd;

typeattribute myloginuser_dejadupprefs_t reads_iceauth_home_files;

typeattribute myloginuser_dejadupprefs_t traverses_user_tmp;
typeattribute myloginuser_dejadupprefs_t creates_dconf_runtime_files;

typeattribute myloginuser_dejadupprefs_t traverses_user_home_dir;
typeattribute myloginuser_dejadupprefs_t lists_user_home_dir;

typeattribute myloginuser_dejadupprefs_t traverses_config_home;
typeattribute myloginuser_dejadupprefs_t reads_dconf_config_home_files;
typeattribute myloginuser_dejadupprefs_t reads_xdg_config_home_files;

typeattribute myloginuser_dejadupprefs_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_dejadupprefs_t creates_ibus_config_home_dirs;

typeattribute myloginuser_dejadupprefs_t traverses_data_home;
typeattribute myloginuser_dejadupprefs_t lists_data_home;
typeattribute myloginuser_dejadupprefs_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_dejadupprefs_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_dejadupprefs_t manages_recentlyused_data_home_files;
typeattribute myloginuser_dejadupprefs_t manages_gtk_bookmarks;

typeattribute myloginuser_dejadupprefs_t reads_bash_home_files;

typeattribute myloginuser_dejadupprefs_t traverses_cache_home;

typeattribute myloginuser_dejadupprefs_t traverses_var_lib;
typeattribute myloginuser_dejadupprefs_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_dejadupprefs_t traverses_tmp;
typeattribute myloginuser_dejadupprefs_t lists_tmp;

typeattribute myloginuser_dejadupprefs_t reads_passwd_files;

typeattribute myloginuser_dejadupprefs_t reads_system_state_files;

typeattribute myloginuser_dejadupprefs_t reads_fonts;

typeattribute myloginuser_dejadupprefs_t reads_pulseaudio_home_files;

typeattribute myloginuser_dejadupprefs_t reads_urandom_device;

typeattribute myloginuser_dejadupprefs_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_dejadupprefs_t connects_to_user_session_bus;
typeattribute myloginuser_dejadupprefs_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_dejadupprefs_t chats_with_gvfsd;
typeattribute myloginuser_dejadupprefs_t chats_with_atspi2;
typeattribute myloginuser_dejadupprefs_t chats_with_dconf;
typeattribute myloginuser_dejadupprefs_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_dejadupprefs_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_dejadupprefs_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_dejadupprefs_t chats_with_gvfsd_sftp;

typeattribute myloginuser_dejadupprefs_t runs_yelp;

allow myloginuser_dejadupprefs_t bin_t:file { execute execute_no_trans };

allow myloginuser_dejadupprefs_t myloginuser_gvfsd_sftp_t:unix_stream_socket connectto;

allow myloginuser_dejadupprefs_t user_home_t:dir { getattr search read open };

dontaudit myloginuser_dejadupprefs_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_dejadupprefs_t file_type:dir search;

########################################
#
# dejadup
# 

type myloginuser_dejadup_t, myloginuserprocess;
typeattribute myloginuser_dejadup_t domain;
role myloginuser_r types myloginuser_dejadup_t;

type dejadup_exec_t, myloginuser_application_executable_type;
typeattribute dejadup_exec_t file_type;
typeattribute dejadup_exec_t non_security_file_type;
typeattribute dejadup_exec_t non_auth_file_type;
typeattribute dejadup_exec_t exec_type;
typeattribute dejadup_exec_t application_exec_type;

allow myloginuser_dejadup_t dejadup_exec_t:file { read entrypoint };

typeattribute dejadup_exec_t started_by_user_naut_exec_type;
typeattribute myloginuser_dejadup_t started_by_user_naut;
type_transition myloginuser_naut_t dejadup_exec_t:process myloginuser_dejadup_t;

type dejadup_tmp_t;
typeattribute dejadup_tmp_t file_type;
typeattribute dejadup_tmp_t tmpfile;
typeattribute dejadup_tmp_t user_tmp_type;

type dejadup_cache_home_t;
typeattribute dejadup_cache_home_t file_type;
typeattribute dejadup_cache_home_t user_home_type;

typeattribute myloginuser_dejadup_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_dejadup_t reads_xdm_runtime_files;

typeattribute myloginuser_dejadup_t inherits_user_fd;

typeattribute myloginuser_dejadup_t gkrd_reads_state;

typeattribute myloginuser_dejadup_t traverses_user_tmp;
typeattribute myloginuser_dejadup_t creates_dconf_runtime_files;

typeattribute myloginuser_dejadup_t traverses_cache_home;
typeattribute myloginuser_dejadup_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_dejadup_t traverses_config_home;

typeattribute myloginuser_dejadup_t traverses_all_user_home_content_dirs;
typeattribute myloginuser_dejadup_t lists_all_user_home_content_dirs;

typeattribute myloginuser_dejadup_t traverses_data_home;
typeattribute myloginuser_dejadup_t lists_data_home;
typeattribute myloginuser_dejadup_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_dejadup_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_dejadup_t manages_recentlyused_data_home_files;

typeattribute myloginuser_dejadup_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_dejadup_t creates_ibus_config_home_dirs;

typeattribute myloginuser_dejadup_t reads_fonts;

typeattribute myloginuser_dejadup_t traverses_user_home_dir;
typeattribute myloginuser_dejadup_t lists_user_home_dir;
typeattribute myloginuser_dejadup_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_dejadup_t traverses_tmp;
typeattribute myloginuser_dejadup_t lists_tmp;
typeattribute myloginuser_dejadup_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_dejadup_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_dejadup_t traverses_var_lib;
typeattribute myloginuser_dejadup_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_dejadup_t reads_passwd_files;

typeattribute myloginuser_dejadup_t reads_system_state_files;

typeattribute myloginuser_dejadup_t reads_network_config_files;

typeattribute myloginuser_dejadup_t appends_xdm_home_files;

typeattribute myloginuser_dejadup_t reads_urandom_device;
typeattribute myloginuser_dejadup_t reads_random_device;

typeattribute myloginuser_dejadup_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_dejadup_t lists_sysfs;

typeattribute myloginuser_dejadup_t connects_to_user_session_bus;
typeattribute myloginuser_dejadup_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_dejadup_t chats_with_gkrd;
typeattribute myloginuser_dejadup_t chats_with_gvfsd;
typeattribute myloginuser_dejadup_t chats_with_gshell;
typeattribute myloginuser_dejadup_t chats_with_atspi2;
typeattribute myloginuser_dejadup_t chats_with_dconf;
typeattribute myloginuser_dejadup_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_dejadup_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_dejadup_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_dejadup_t chats_with_gvfsd_metadata;
typeattribute myloginuser_dejadup_t chats_with_gvfsd_sftp;

typeattribute myloginuser_dejadup_t runs_gpg;

allow myloginuser_dejadup_t myloginuser_dejadupprefs_t:fd use;
allow myloginuser_dejadup_t myloginuser_dejadupprefs_t:fifo_file { read write getattr ioctl };
allow myloginuser_dejadup_t myloginuser_dejadupprefs_t:process sigchld;

allow myloginuser_dejadupprefs_t dejadup_exec_t:file { getattr open read execute };
allow myloginuser_dejadupprefs_t myloginuser_dejadup_t:process transition;
type_transition myloginuser_dejadupprefs_t dejadup_exec_t:process myloginuser_dejadup_t;

allow myloginuser_dejadup_t self:netlink_route_socket { setopt read bind create nlmsg_read write getattr getopt };
allow myloginuser_dejadup_t self:process sigkill;
allow myloginuser_dejadup_t self:udp_socket { create connect getattr };

allow myloginuser_dejadup_t dejadup_tmp_t:dir { getattr search write rmdir read remove_name create add_name };
allow myloginuser_dejadup_t dejadup_tmp_t:file { write create unlink open execute setattr };
type_transition myloginuser_dejadup_t tmp_t:{ file dir } dejadup_tmp_t;

allow myloginuser_dejadup_t { bin_t shell_exec_t }:file { execute execute_no_trans };

allow myloginuser_dejadup_t proc_t:dir { open read };

allow myloginuser_dejadup_t tmpfs_t:filesystem getattr;

allow myloginuser_dejadup_t var_t:dir { open read };
allow myloginuser_dejadup_t mnt_t:dir { getattr search open read };

dontaudit myloginuser_dejadup_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_dejadup_t file_type:dir search;

allow myloginuser_dejadup_t myloginuser_gvfsd_sftp_t:unix_stream_socket { connectto read write };

allow myloginuser_dejadup_t home_root_t:dir { read open };
dontaudit myloginuser_dejadup_t { root_t home_root_t user_home_dir_t }:dir setattr;

allow myloginuser_dejadup_t user_home_type:dir { setattr write create add_name };
allow myloginuser_dejadup_t user_home_type:file { open getattr read write setattr create};
allow myloginuser_dejadup_t user_home_type:lnk_file { getattr read write setattr create};
allow myloginuser_dejadup_t user_home_type:sock_file { getattr read write setattr create};
allow myloginuser_dejadup_t user_home_type:fifo_file { getattr read write setattr create};
allow myloginuser_dejadup_t user_home_type:chr_file { getattr read write setattr create};
allow myloginuser_dejadup_t user_home_type:blk_file { getattr read setattr create};
type_transition myloginuser_dejadup_t user_home_dir_t:{ dir file lnk_file sock_file fifo_file chr_file blk_file } user_home_t;

allow myloginuser_dejadup_t dejadup_cache_home_t:dir { search setattr read create write getattr rmdir remove_name open add_name };
allow myloginuser_dejadup_t dejadup_cache_home_t:file { rename setattr read create write getattr unlink open };

optional_policy(`
	gen_require(`
		type cache_home_t;
	')

	type_transition myloginuser_dejadup_t cache_home_t:dir dejadup_cache_home_t "deja-dup";
')

########################################
#
# froller
# 

type myloginuser_froller_t, myloginuserprocess;
typeattribute myloginuser_froller_t domain;
role myloginuser_r types myloginuser_froller_t;

type froller_exec_t, myloginuser_application_executable_type;
typeattribute froller_exec_t file_type;
typeattribute froller_exec_t non_security_file_type;
typeattribute froller_exec_t non_auth_file_type;
typeattribute froller_exec_t exec_type;
typeattribute froller_exec_t application_exec_type;

allow myloginuser_froller_t froller_exec_t:file { read entrypoint };

typeattribute froller_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_froller_t started_by_user_gshell;
type_transition myloginuser_gshell_t froller_exec_t:process myloginuser_froller_t;

typeattribute froller_exec_t started_by_user_naut_exec_type;
typeattribute myloginuser_froller_t started_by_user_naut;
type_transition myloginuser_naut_t froller_exec_t:process myloginuser_froller_t;

type froller_tmp_t;
typeattribute froller_tmp_t file_type;
typeattribute froller_tmp_t tmpfile;
typeattribute froller_tmp_t user_tmp_type;

type froller_cache_home_t;
typeattribute froller_cache_home_t file_type;
typeattribute froller_cache_home_t user_home_type;

typeattribute myloginuser_froller_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_froller_t reads_xdm_runtime_files;

typeattribute myloginuser_froller_t inherits_user_fd;

typeattribute myloginuser_froller_t traverses_user_tmp;
typeattribute myloginuser_froller_t creates_dconf_runtime_files;

typeattribute myloginuser_froller_t traverses_user_home_dir;
typeattribute myloginuser_froller_t lists_user_home_dir;

typeattribute myloginuser_froller_t traverses_config_home;
typeattribute myloginuser_froller_t reads_dconf_config_home_files;

typeattribute myloginuser_froller_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_froller_t creates_ibus_config_home_dirs;

typeattribute myloginuser_froller_t traverses_data_home;
typeattribute myloginuser_froller_t lists_data_home;
typeattribute myloginuser_froller_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_froller_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_froller_t manages_recentlyused_data_home_files;
typeattribute myloginuser_froller_t manages_gtk_bookmarks;

typeattribute myloginuser_froller_t traverses_cache_home;
typeattribute myloginuser_froller_t adds_entries_to_cache_home_dirs;
typeattribute myloginuser_froller_t removes_entries_from_cache_home_dirs;

typeattribute myloginuser_froller_t traverses_tmp;
typeattribute myloginuser_froller_t lists_tmp;
typeattribute myloginuser_froller_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_froller_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_froller_t traverses_var_lib;
typeattribute myloginuser_froller_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_froller_t reads_passwd_files;

typeattribute myloginuser_froller_t reads_system_state_files;

typeattribute myloginuser_froller_t reads_fonts;

typeattribute myloginuser_froller_t reads_urandom_device;

typeattribute myloginuser_froller_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_froller_t lists_sysfs;

typeattribute myloginuser_froller_t connects_to_user_session_bus;
typeattribute myloginuser_froller_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_froller_t chats_with_gvfsd;
typeattribute myloginuser_froller_t chats_with_gshell;
typeattribute myloginuser_froller_t chats_with_atspi2;
typeattribute myloginuser_froller_t chats_with_dconf;
typeattribute myloginuser_froller_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_froller_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_froller_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_froller_t chats_with_gvfsd_metadata;

allow myloginuser_froller_t myloginuser_nautsrchp_t:fd use;
allow myloginuser_froller_t myloginuser_nautsrchp_t:fifo_file { read write getattr ioctl };
allow myloginuser_froller_t myloginuser_nautsrchp_t:process sigchld;

allow myloginuser_nautsrchp_t froller_exec_t:file { getattr open read execute };
allow myloginuser_nautsrchp_t myloginuser_froller_t:process transition;
type_transition myloginuser_nautsrchp_t froller_exec_t:process myloginuser_froller_t;

allow myloginuser_froller_t froller_tmp_t:file { write create unlink open };
type_transition myloginuser_froller_t tmp_t:file froller_tmp_t;

allow myloginuser_froller_t { shell_exec_t bin_t }:file { execute execute_no_trans };

allow myloginuser_froller_t tmpfs_t:filesystem getattr;

allow myloginuser_froller_t { user_home_t user_home_dir_t }:dir { write add_name remove_name };
allow myloginuser_froller_t user_home_t:file { getattr read write open ioctl create rename unlink setattr };
allow myloginuser_froller_t user_home_t:dir { search getattr read open create reparent rmdir setattr rename };
type_transition myloginuser_froller_t user_home_dir_t:{ file dir } user_home_t;

dontaudit myloginuser_froller_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_froller_t file_type:dir search;

allow myloginuser_froller_t froller_cache_home_t:dir { write remove_name create add_name rmdir };
allow myloginuser_froller_t froller_cache_home_t:file { write create unlink };

optional_policy(`
	gen_require(`
		type cache_home_t;
	')

	type_transition myloginuser_froller_t cache_home_t:dir froller_cache_home_t;
')

########################################
#
# naut
# 

type myloginuser_naut_t, myloginuserprocess;
typeattribute myloginuser_naut_t domain;
role myloginuser_r types myloginuser_naut_t;

type naut_exec_t, myloginuser_application_executable_type;
typeattribute naut_exec_t file_type;
typeattribute naut_exec_t non_security_file_type;
typeattribute naut_exec_t non_auth_file_type;
typeattribute naut_exec_t exec_type;
typeattribute naut_exec_t application_exec_type;

allow myloginuser_naut_t naut_exec_t:file { read entrypoint execute };

type naut_tmp_t;
typeattribute naut_tmp_t file_type;
typeattribute naut_tmp_t tmpfile;
typeattribute naut_tmp_t user_tmp_type;

type nautilus_data_home_t;
typeattribute nautilus_data_home_t file_type;
typeattribute nautilus_data_home_t user_home_type;

type trash_data_home_t;
typeattribute trash_data_home_t file_type;
typeattribute trash_data_home_t user_home_type;

type nautilus_config_home_t;
typeattribute nautilus_config_home_t file_type;
typeattribute nautilus_config_home_t user_home_type;

typeattribute myloginuser_naut_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_naut_t reads_xdm_runtime_files;

typeattribute myloginuser_naut_t inherits_user_fd;

typeattribute myloginuser_naut_t reads_iceauth_home_files;

typeattribute myloginuser_naut_t traverses_user_tmp;
typeattribute myloginuser_naut_t creates_dconf_runtime_files;

typeattribute myloginuser_naut_t traverses_user_home_dir;
typeattribute myloginuser_naut_t lists_user_home_dir;
typeattribute myloginuser_naut_t adds_entries_to_user_home_dirs;
typeattribute myloginuser_naut_t removes_entries_from_user_home_dirs;;

typeattribute myloginuser_naut_t traverses_config_home;
typeattribute myloginuser_naut_t lists_config_home;
typeattribute myloginuser_naut_t reads_dconf_config_home_files;
typeattribute myloginuser_naut_t reads_xdg_config_home_files;

typeattribute myloginuser_naut_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_naut_t creates_ibus_config_home_dirs;

typeattribute myloginuser_naut_t traverses_data_home;
typeattribute myloginuser_naut_t lists_data_home;
typeattribute myloginuser_naut_t lists_gconf_home;
typeattribute myloginuser_naut_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_naut_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_naut_t reads_metadata_data_home_files;
typeattribute myloginuser_naut_t manages_recentlyused_data_home_files;
typeattribute myloginuser_naut_t manages_gtk_bookmarks;

typeattribute myloginuser_naut_t reads_bash_home_files;

typeattribute myloginuser_naut_t manages_thumb_home;

typeattribute myloginuser_naut_t traverses_cache_home;
typeattribute myloginuser_naut_t lists_cache_home;
typeattribute myloginuser_naut_t adds_entries_to_cache_home_dirs;

typeattribute myloginuser_naut_t traverses_tmp;
typeattribute myloginuser_naut_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_naut_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_naut_t traverses_var_lib;
typeattribute myloginuser_naut_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_naut_t reads_passwd_files;

typeattribute myloginuser_naut_t reads_fonts;

typeattribute myloginuser_naut_t reads_pulseaudio_home_files;

typeattribute myloginuser_naut_t reads_urandom_device;

typeattribute myloginuser_naut_t reads_udev_runtime_files;

typeattribute myloginuser_naut_t reads_sysfs;

typeattribute myloginuser_naut_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_naut_t connects_to_system_bus;
typeattribute myloginuser_naut_t connects_to_user_session_bus;
typeattribute myloginuser_naut_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_naut_t chats_with_gvfsd;
typeattribute myloginuser_naut_t chats_with_gshell;
typeattribute myloginuser_naut_t chats_with_gsession;
typeattribute myloginuser_naut_t chats_with_atspi2;
typeattribute myloginuser_naut_t chats_with_dconf;

typeattribute myloginuser_naut_t runs_evince;
typeattribute myloginuser_naut_t runs_yelp;

allow myloginuser_naut_t runs_nautilus:fd use;
allow myloginuser_naut_t runs_nautilus:fifo_file { read write getattr ioctl };
allow myloginuser_naut_t runs_nautilus:process sigchld;

allow runs_nautilus naut_exec_t:file { getattr open read execute };
allow runs_nautilus myloginuser_naut_t:process transition;
type_transition runs_nautilus naut_exec_t:process myloginuser_naut_t;

allow myloginuser_naut_t naut_tmp_t:file { write create unlink open };
type_transition myloginuser_naut_t tmp_t:file naut_tmp_t;

allow myloginuser_naut_t { domain myloginuser_t }:dir { getattr search };
allow myloginuser_naut_t { domain myloginuser_t }:file { read getattr open };
allow myloginuser_naut_t { domain myloginuser_t }:lnk_file read;

allow myloginuser_naut_t random_device_t:chr_file getattr;

allow myloginuser_naut_t filesystem_type:filesystem getattr;
allow myloginuser_naut_t { sysctl_type proc_type }:{ dir file } getattr;

allow myloginuser_naut_t proc_t:{ file dir } { read open };

allow myloginuser_naut_t user_home_type:{ dir file } audit_access;

allow myloginuser_naut_t home_root_t:dir read;
dontaudit myloginuser_naut_t home_root_t:dir open;
allow myloginuser_naut_t user_home_dir_t:dir { setattr lock ioctl };
allow myloginuser_naut_t user_home_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
allow myloginuser_naut_t user_home_t:file { open getattr setattr read rename link unlink ioctl lock write create };
allow myloginuser_naut_t user_home_t:lnk_file { getattr setattr read rename link unlink ioctl lock };
type_transition myloginuser_naut_t user_home_dir_t:{ file dir } user_home_t;

allow myloginuser_naut_t { file_type device_node }:{ dir lnk_file file fifo_file sock_file chr_file blk_file } audit_access;
dontaudit myloginuser_naut_t { file_type device_node }:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read write };
dontaudit myloginuser_naut_t file_type:dir search;

allow myloginuser_naut_t myloginuser_gvfsd_sftp_t:unix_stream_socket connectto;
allow myloginuser_naut_t myloginuser_gvfsd_smbbrowse_t:unix_stream_socket connectto;
allow myloginuser_naut_t myloginuser_gvfsd_burn_t:unix_stream_socket connectto;
allow myloginuser_naut_t myloginuser_gvfsd_trash_t:unix_stream_socket connectto;
allow myloginuser_naut_t myloginuser_gvfsd_recent_t:unix_stream_socket connectto;
allow myloginuser_naut_t myloginuser_gvfsd_network_t:unix_stream_socket connectto;

allow myloginuser_naut_t { transmissiongtk_exec_t nautcs_exec_t eog_exec_t gsysmon_exec_t dejadupprefs_exec_t dejadup_exec_t }:file { getattr execute };
allow myloginuser_naut_t { baobab_exec_t nautautor_exec_t gterm_exec_t nautsendto_exec_t gccenter_exec_t }:file { getattr execute };

allow myloginuser_naut_t trstore_cache_home_t:dir { getattr search };
allow myloginuser_naut_t trstore_cache_home_t:file { read lock getattr write open };

allow myloginuser_naut_t nautilus_config_home_t:dir { write search read create getattr add_name remove_name open };
allow myloginuser_naut_t nautilus_config_home_t:file { write create open read getattr rename unlink };

allow myloginuser_naut_t trash_data_home_t:dir { write search read create open getattr add_name remove_name };
allow myloginuser_naut_t trash_data_home_t:file { rename write getattr read create unlink open };

allow myloginuser_naut_t nautilus_data_home_t:file { write create open };
allow myloginuser_naut_t nautilus_data_home_t:dir { write search read create open getattr add_name };

optional_policy(`
	gen_require(`
		type config_home_t, data_home_t;
	')

	type_transition myloginuser_naut_t config_home_t:dir nautilus_config_home_t "nautilus";
	type_transition myloginuser_naut_t data_home_t:dir trash_data_home_t "Trash";
	type_transition myloginuser_naut_t data_home_t:file nautilus_data_home_t ".converted-launchers";
	type_transition myloginuser_naut_t data_home_t:dir nautilus_data_home_t "nautilus";
')

optional_policy(`
	gen_require(`
		type gpg_secret_t;
	')

	dontaudit myloginuser_naut_t gpg_secret_t:dir read;
')

optional_policy(`
	gen_require(`
		type ssh_home_t;
	')

	dontaudit myloginuser_naut_t ssh_home_t:dir read;
')

optional_policy(`
	gen_require(`
		type thumb_t, thumb_exec_t;
	')

	allow thumb_t myloginuser_naut_t:fd use;
	allow thumb_t myloginuser_naut_t:fifo_file { read write getattr ioctl };
	allow thumb_t myloginuser_naut_t:process sigchld;

	allow myloginuser_naut_t thumb_exec_t:file { getattr open read execute };
	allow myloginuser_naut_t thumb_t:process transition;
	dontaudit myloginuser_naut_t thumb_t:process { noatsecure siginh rlimitinh };
	type_transition myloginuser_naut_t thumb_exec_t:process thumb_t;

	role myloginuser_r types thumb_t;

	allow thumb_t naut_tmp_t:file write;
')

########################################
#
# naut (all user naut domains)
#

allow started_by_user_naut myloginuser_naut_t:fd use;
allow started_by_user_naut myloginuser_naut_t:fifo_file { read write getattr ioctl };
allow started_by_user_naut myloginuser_naut_t:process sigchld;

allow myloginuser_naut_t started_by_user_naut_exec_type:file { getattr open read execute };
allow myloginuser_naut_t started_by_user_naut:process transition;

########################################
#
# baobab
# 

type myloginuser_baobab_t, myloginuserprocess;
typeattribute myloginuser_baobab_t domain;
role myloginuser_r types myloginuser_baobab_t;

type baobab_exec_t, myloginuser_application_executable_type;
typeattribute baobab_exec_t file_type;
typeattribute baobab_exec_t non_security_file_type;
typeattribute baobab_exec_t non_auth_file_type;
typeattribute baobab_exec_t exec_type;
typeattribute baobab_exec_t application_exec_type;

allow myloginuser_baobab_t baobab_exec_t:file { read entrypoint };

typeattribute baobab_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_baobab_t started_by_user_gshell;
type_transition myloginuser_gshell_t baobab_exec_t:process myloginuser_baobab_t;

type recentlyused_data_home_t;
typeattribute recentlyused_data_home_t file_type;
typeattribute recentlyused_data_home_t user_home_type;

typeattribute myloginuser_baobab_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_baobab_t reads_xdm_runtime_files;

typeattribute myloginuser_baobab_t inherits_user_fd;

typeattribute myloginuser_baobab_t reads_iceauth_home_files;

typeattribute myloginuser_baobab_t traverses_user_tmp;
typeattribute myloginuser_baobab_t creates_dconf_runtime_files;

typeattribute myloginuser_baobab_t traverses_user_home_dir;
typeattribute myloginuser_baobab_t lists_user_home_dir;

typeattribute myloginuser_baobab_t traverses_config_home;
typeattribute myloginuser_baobab_t reads_dconf_config_home_files;
typeattribute myloginuser_baobab_t reads_xdg_config_home_files;

typeattribute myloginuser_baobab_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_baobab_t creates_ibus_config_home_dirs;

typeattribute myloginuser_baobab_t traverses_all_user_home_content_dirs;
typeattribute myloginuser_baobab_t lists_all_user_home_content_dirs;

typeattribute myloginuser_baobab_t traverses_data_home;
typeattribute myloginuser_baobab_t lists_data_home;
typeattribute myloginuser_baobab_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_baobab_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_baobab_t manages_recentlyused_data_home_files;
typeattribute myloginuser_baobab_t manages_gtk_bookmarks;

typeattribute myloginuser_baobab_t reads_bash_home_files;

typeattribute myloginuser_baobab_t reads_passwd_files;

typeattribute myloginuser_baobab_t reads_fonts;

typeattribute myloginuser_baobab_t reads_pulseaudio_home_files;

typeattribute myloginuser_baobab_t reads_urandom_device;

typeattribute myloginuser_baobab_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_baobab_t connects_to_system_bus;
typeattribute myloginuser_baobab_t connects_to_user_session_bus;
typeattribute myloginuser_baobab_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_baobab_t chats_with_gvfsd;
typeattribute myloginuser_baobab_t chats_with_gshell;
typeattribute myloginuser_baobab_t chats_with_atspi2;
typeattribute myloginuser_baobab_t chats_with_dconf;
typeattribute myloginuser_baobab_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_baobab_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_baobab_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_baobab_t chats_with_gvfsd_sftp;

typeattribute myloginuser_baobab_t runs_yelp;

allow myloginuser_baobab_t myloginuser_gvfsd_sftp_t:unix_stream_socket connectto;

allow myloginuser_baobab_t user_home_type:file { getattr audit_access };
allow myloginuser_baobab_t user_home_type:lnk_file { read getattr };

dontaudit myloginuser_baobab_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_baobab_t file_type:dir search;

########################################
#
# baobab grouped policy
#

allow reads_recentlyused_data_home_files recentlyused_data_home_t:file { getattr open read };
allow manages_recentlyused_data_home_files recentlyused_data_home_t:file { rename write getattr setattr read create open unlink };

optional_policy(`
	gen_require(`
		type data_home_t;
	')

	type_transition manages_recentlyused_data_home_files data_home_t:file recentlyused_data_home_t;
')

########################################
#
# nautautor
# 

type myloginuser_nautautor_t, myloginuserprocess;
typeattribute myloginuser_nautautor_t domain;
role myloginuser_r types myloginuser_nautautor_t;

type nautautor_exec_t, myloginuser_application_executable_type;
typeattribute nautautor_exec_t file_type;
typeattribute nautautor_exec_t non_security_file_type;
typeattribute nautautor_exec_t non_auth_file_type;
typeattribute nautautor_exec_t exec_type;
typeattribute nautautor_exec_t application_exec_type;

allow myloginuser_nautautor_t nautautor_exec_t:file { read entrypoint };

########################################
#
# gterm
# 

type myloginuser_gterm_t, myloginuserprocess;
typeattribute myloginuser_gterm_t domain;
role myloginuser_r types myloginuser_gterm_t;

type gterm_exec_t, myloginuser_application_executable_type;
typeattribute gterm_exec_t file_type;
typeattribute gterm_exec_t non_security_file_type;
typeattribute gterm_exec_t non_auth_file_type;
typeattribute gterm_exec_t exec_type;
typeattribute gterm_exec_t application_exec_type;

allow myloginuser_gterm_t gterm_exec_t:file { read entrypoint };

typeattribute gterm_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_gterm_t started_by_user_gshell;
type_transition myloginuser_gshell_t gterm_exec_t:process myloginuser_gterm_t;

type gterm_tmp_t;
typeattribute gterm_tmp_t file_type;
typeattribute gterm_tmp_t tmpfile;
typeattribute gterm_tmp_t user_tmp_type;

typeattribute myloginuser_gterm_t runs_yelp;
typeattribute myloginuser_gterm_t runs_gptyhelper;

typeattribute myloginuser_gterm_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gterm_t reads_xdm_runtime_files;

typeattribute myloginuser_gterm_t inherits_user_fd;

typeattribute myloginuser_gterm_t reads_iceauth_home_files;

typeattribute myloginuser_gterm_t traverses_user_tmp;
typeattribute myloginuser_gterm_t creates_dconf_runtime_files;

typeattribute myloginuser_gterm_t traverses_user_home_dir;

typeattribute myloginuser_gterm_t traverses_config_home;
typeattribute myloginuser_gterm_t reads_dconf_config_home_files;

typeattribute myloginuser_gterm_t traverses_data_home;
typeattribute myloginuser_gterm_t traverses_gtk_home;

typeattribute myloginuser_gterm_t traverses_tmp;
typeattribute myloginuser_gterm_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_gterm_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_gterm_t traverses_devpts;

typeattribute myloginuser_gterm_t reads_passwd_files;

typeattribute myloginuser_gterm_t reads_fonts;

typeattribute myloginuser_gterm_t reads_urandom_device;

typeattribute myloginuser_gterm_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gterm_t connects_to_user_session_bus;
typeattribute myloginuser_gterm_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gterm_t chats_with_gvfsd;
typeattribute myloginuser_gterm_t chats_with_atspi2;
typeattribute myloginuser_gterm_t chats_with_gconfd2;
typeattribute myloginuser_gterm_t chats_with_gtermd;

allow myloginuser_gterm_t myloginuser_t:process transition;
allow myloginuser_gterm_t shell_exec_t:file { getattr open read execute };
type_transition myloginuser_gterm_t shell_exec_t:process myloginuser_t;

allow myloginuser_gterm_t myloginuser_t:process { signal getpgid };
allow myloginuser_gterm_t myloginuser_gptyhelper_t:process signal;

allow myloginuser_gterm_t tmpfs_t:dir { getattr search };

allow myloginuser_gterm_t gterm_tmp_t:file { write create unlink open };
type_transition  myloginuser_gterm_t tmp_t:file gterm_tmp_t;

allow myloginuser_gterm_t myloginuser_gsession_t:unix_stream_socket connectto;

allow myloginuser_gterm_t ptmx_t:chr_file { read write getattr ioctl open };
allow myloginuser_gterm_t user_devpts_t:chr_file { read write ioctl open getattr };

dontaudit myloginuser_gterm_t device_t:chr_file getattr;
allow myloginuser_gterm_t device_node:chr_file getattr;
allow myloginuser_gterm_t fixed_disk_device_t:blk_file getattr;
allow myloginuser_gterm_t hugetlbfs_t:dir getattr;
allow myloginuser_gterm_t devlog_t:sock_file getattr;
allow myloginuser_gterm_t initctl_t:fifo_file getattr;

########################################
#
# gptyhelper
# 

type myloginuser_gptyhelper_t, myloginuserprocess;
typeattribute myloginuser_gptyhelper_t domain;
role myloginuser_r types myloginuser_gptyhelper_t;

type gptyhelper_exec_t, myloginuser_application_executable_type;
typeattribute gptyhelper_exec_t file_type;
typeattribute gptyhelper_exec_t non_security_file_type;
typeattribute gptyhelper_exec_t non_auth_file_type;
typeattribute gptyhelper_exec_t exec_type;
typeattribute gptyhelper_exec_t application_exec_type;

allow myloginuser_gptyhelper_t gptyhelper_exec_t:file { read entrypoint };

typeattribute myloginuser_gptyhelper_t reads_passwd_files;

typeattribute myloginuser_gptyhelper_t traverses_devpts;

typeattribute myloginuser_gptyhelper_t reads_initrc_runtime_files;

allow myloginuser_gptyhelper_t runs_gptyhelper:fd use;
allow myloginuser_gptyhelper_t runs_gptyhelper:fifo_file { read write getattr ioctl };
allow myloginuser_gptyhelper_t runs_gptyhelper:process sigchld;

allow runs_gptyhelper gptyhelper_exec_t:file { getattr open read execute };
allow runs_gptyhelper myloginuser_gptyhelper_t:process transition;
type_transition runs_gptyhelper gptyhelper_exec_t:process myloginuser_gptyhelper_t;

allow myloginuser_gptyhelper_t devpts_t:filesystem getattr;
type_change myloginuser_gptyhelper_t devpts_t:chr_file user_devpts_t;

allow myloginuser_gptyhelper_t user_devpts_t:chr_file { write ioctl setattr read open getattr };
type_transition myloginuser_gptyhelper_t devpts_t:chr_file user_devpts_t;

allow myloginuser_gptyhelper_t { myloginuser_gterm_t myloginuser_gtermd_t }:unix_stream_socket { read write };

allow myloginuser_gptyhelper_t initrc_var_run_t:file { write lock };
allow myloginuser_gptyhelper_t ptmx_t:chr_file { read write ioctl open };
allow myloginuser_gptyhelper_t wtmp_t:file { write lock open };

########################################
#
# xmail
# 

type myloginuser_xmail_t, myloginuserprocess;
typeattribute myloginuser_xmail_t domain;
role myloginuser_r types myloginuser_xmail_t;

type xmail_tmp_t;
typeattribute xmail_tmp_t file_type;
typeattribute xmail_tmp_t tmpfile;
typeattribute xmail_tmp_t user_tmp_type;

typeattribute myloginuser_xmail_t started_by_user;

typeattribute myloginuser_xmail_t traverses_user_home_dir;

typeattribute myloginuser_xmail_t traverses_tmp;
typeattribute myloginuser_xmail_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_xmail_t removes_entries_from_tmp_dirs;

allow myloginuser_xmail_t xmail_tmp_t:file { write create unlink open setattr };
type_transition myloginuser_xmail_t tmp_t:file xmail_tmp_t;

allow myloginuser_xmail_t user_devpts_t:chr_file { read write ioctl getattr };

optional_policy(`
	gen_require(`
		type sendmail_exec_t, mail_spool_t;
	')

	typeattribute sendmail_exec_t started_by_user_exec_type;

	allow myloginuser_xmail_t sendmail_exec_t:file { read entrypoint };
	type_transition myloginuser_t sendmail_exec_t:process myloginuser_xmail_t;

	allow myloginuser_xmail_t { var_spool_t mail_spool_t }:dir { getattr search };
	allow myloginuser_xmail_t mail_spool_t:file { read write getattr open lock setattr };
')

########################################
#
# gvfsd_metadata
# 

type myloginuser_gvfsd_metadata_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_metadata_t domain;
role myloginuser_r types myloginuser_gvfsd_metadata_t;

type gvfsd_metadata_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_metadata_exec_t file_type;
typeattribute gvfsd_metadata_exec_t non_security_file_type;
typeattribute gvfsd_metadata_exec_t non_auth_file_type;
typeattribute gvfsd_metadata_exec_t exec_type;
typeattribute gvfsd_metadata_exec_t application_exec_type;

allow myloginuser_gvfsd_metadata_t gvfsd_metadata_exec_t:file { read entrypoint };

typeattribute gvfsd_metadata_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gvfsd_metadata_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gvfsd_metadata_exec_t:process myloginuser_gvfsd_metadata_t;

type metadata_data_home_t;
typeattribute metadata_data_home_t file_type;
typeattribute metadata_data_home_t user_home_type;

typeattribute myloginuser_gvfsd_metadata_t traverses_user_home_dir;

typeattribute myloginuser_gvfsd_metadata_t traverses_data_home;
typeattribute myloginuser_gvfsd_metadata_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_gvfsd_metadata_t reads_metadata_data_home_files;

typeattribute myloginuser_gvfsd_metadata_t reads_urandom_device;

typeattribute myloginuser_gvfsd_metadata_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gvfsd_metadata_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_metadata_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_metadata_t chats_with_naut;

allow myloginuser_gvfsd_metadata_t metadata_data_home_t:dir { create write add_name remove_name read open };
allow myloginuser_gvfsd_metadata_t metadata_data_home_t:file { create write setattr rename unlink };

optional_policy(`
        gen_require(`
                type data_home_t;
        ')

	type_transition myloginuser_gvfsd_metadata_t data_home_t:dir metadata_data_home_t "gvfs-metadata";
')

########################################
#
# gvfsd_metadata grouped policy
#

allow reads_metadata_data_home_files metadata_data_home_t:dir { getattr search };
allow reads_metadata_data_home_files metadata_data_home_t:file { open getattr read };

########################################
#
# yelp
# 

type myloginuser_yelp_t, myloginuserprocess;
typeattribute myloginuser_yelp_t domain;
role myloginuser_r types myloginuser_yelp_t;

type yelp_exec_t, myloginuser_application_executable_type;
typeattribute yelp_exec_t file_type;
typeattribute yelp_exec_t non_security_file_type;
typeattribute yelp_exec_t non_auth_file_type;
typeattribute yelp_exec_t exec_type;
typeattribute yelp_exec_t application_exec_type;

allow myloginuser_yelp_t yelp_exec_t:file { read entrypoint };

type yelp_tmp_t;
typeattribute yelp_tmp_t file_type;
typeattribute yelp_tmp_t tmpfile;
typeattribute yelp_tmp_t user_tmp_type;

type webkit_data_home_t;
typeattribute webkit_data_home_t file_type;
typeattribute webkit_data_home_t user_home_type;

type yelp_config_home_t;
typeattribute yelp_config_home_t file_type;
typeattribute yelp_config_home_t user_home_type;

typeattribute myloginuser_yelp_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_yelp_t reads_xdm_runtime_files;

typeattribute myloginuser_yelp_t inherits_user_fd;

typeattribute myloginuser_yelp_t traverses_user_tmp;
typeattribute myloginuser_yelp_t creates_dconf_runtime_files;

typeattribute myloginuser_yelp_t traverses_user_home_dir;
typeattribute myloginuser_yelp_t lists_user_home_dir;

typeattribute myloginuser_yelp_t traverses_all_user_home_content_dirs;
typeattribute myloginuser_yelp_t lists_all_user_home_content_dirs;

typeattribute myloginuser_yelp_t traverses_config_home;
typeattribute myloginuser_yelp_t lists_config_home;
typeattribute myloginuser_yelp_t reads_dconf_config_home_files;
typeattribute myloginuser_yelp_t reads_xdg_config_home_files;

typeattribute myloginuser_yelp_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_yelp_t creates_ibus_config_home_dirs;

typeattribute myloginuser_yelp_t traverses_data_home;
typeattribute myloginuser_yelp_t lists_data_home;
typeattribute myloginuser_yelp_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_yelp_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_yelp_t manages_recentlyused_data_home_files;
typeattribute myloginuser_yelp_t manages_gtk_bookmarks;

typeattribute myloginuser_yelp_t traverses_tmp;
typeattribute myloginuser_yelp_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_yelp_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_yelp_t traverses_var_lib;
typeattribute myloginuser_yelp_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_yelp_t reads_passwd_files;

typeattribute myloginuser_yelp_t reads_system_state_files;

typeattribute myloginuser_yelp_t reads_fonts;

typeattribute myloginuser_yelp_t reads_network_config_files;

typeattribute myloginuser_yelp_t reads_urandom_device;
typeattribute myloginuser_yelp_t reads_random_device;

typeattribute myloginuser_yelp_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_yelp_t connects_to_system_bus;
typeattribute myloginuser_yelp_t connects_to_user_session_bus;
typeattribute myloginuser_yelp_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_yelp_t chats_with_gvfsd;
typeattribute myloginuser_yelp_t chats_with_gshell;
typeattribute myloginuser_yelp_t chats_with_atspi2;
typeattribute myloginuser_yelp_t chats_with_dconf;
typeattribute myloginuser_yelp_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_yelp_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_yelp_t chats_with_gvfsd_afcvolmon;

typeattribute myloginuser_yelp_t connects_to_user_gkrd;

typeattribute myloginuser_yelp_t connects_to_cups;
typeattribute myloginuser_yelp_t reads_cups_config_files;

typeattribute myloginuser_yelp_t runs_evince;

allow myloginuser_yelp_t runs_yelp:fd use;
allow myloginuser_yelp_t runs_yelp:fifo_file { read write getattr ioctl };
allow myloginuser_yelp_t runs_yelp:process sigchld;

allow runs_yelp yelp_exec_t:file { getattr open read execute };
allow runs_yelp myloginuser_yelp_t:process transition;
type_transition runs_yelp yelp_exec_t:process myloginuser_yelp_t;

allow myloginuser_yelp_t self:process execmem;

allow myloginuser_yelp_t ipp_port_t:tcp_socket name_connect;
allow myloginuser_yelp_t self:tcp_socket { create connect setopt };

allow myloginuser_yelp_t yelp_tmp_t:file { write rename create unlink open setattr };
type_transition myloginuser_yelp_t tmp_t:file yelp_tmp_t;

allow myloginuser_yelp_t { user_home_t user_home_dir_t }:dir { write add_name remove_name };
allow myloginuser_yelp_t user_home_t:file { getattr read write open ioctl create rename unlink setattr };
allow myloginuser_yelp_t user_home_t:dir { create rmdir setattr read getattr search open };
type_transition myloginuser_yelp_t user_home_dir_t:file user_home_t;

dontaudit myloginuser_yelp_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_yelp_t file_type:dir search;

allow myloginuser_yelp_t tmpfs_t:filesystem getattr;

allow myloginuser_yelp_t nautsendto_exec_t:file { getattr execute };

allow myloginuser_yelp_t yelp_config_home_t:dir { write search read create getattr add_name };
allow myloginuser_yelp_t yelp_config_home_t:file { write read create open getattr };

allow myloginuser_yelp_t webkit_data_home_t:dir { write search remove_name create getattr add_name };
allow myloginuser_yelp_t webkit_data_home_t:file { write getattr read lock create unlink open };

optional_policy(`
        gen_require(`
                type config_home_t, data_home_t;
        ')

	type_transition myloginuser_yelp_t config_home_t:dir yelp_config_home_t "yelp";
	type_transition myloginuser_yelp_t data_home_t:dir webkit_data_home_t "webkit";
')

########################################
#
# nautsendto
# 

type myloginuser_nautsendto_t, myloginuserprocess;
typeattribute myloginuser_nautsendto_t domain;
role myloginuser_r types myloginuser_nautsendto_t;

type nautsendto_exec_t, myloginuser_application_executable_type;
typeattribute nautsendto_exec_t file_type;
typeattribute nautsendto_exec_t non_security_file_type;
typeattribute nautsendto_exec_t non_auth_file_type;
typeattribute nautsendto_exec_t exec_type;
typeattribute nautsendto_exec_t application_exec_type;

allow myloginuser_nautsendto_t nautsendto_exec_t:file { read entrypoint };

########################################
#
# trextract
# 

type myloginuser_trextract_t, myloginuserprocess;
typeattribute myloginuser_trextract_t domain;
role myloginuser_r types myloginuser_trextract_t;

type trextract_exec_t, myloginuser_application_executable_type;
typeattribute trextract_exec_t file_type;
typeattribute trextract_exec_t non_security_file_type;
typeattribute trextract_exec_t non_auth_file_type;
typeattribute trextract_exec_t exec_type;
typeattribute trextract_exec_t application_exec_type;

allow myloginuser_trextract_t trextract_exec_t:file { read entrypoint };

typeattribute trextract_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_trextract_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t trextract_exec_t:process myloginuser_trextract_t;

typeattribute myloginuser_trextract_t traverses_user_tmp;
typeattribute myloginuser_trextract_t creates_dconf_runtime_files;

typeattribute myloginuser_trextract_t traverses_user_home_dir;

typeattribute myloginuser_trextract_t traverses_config_home;
typeattribute myloginuser_trextract_t reads_dconf_config_home_files;
typeattribute myloginuser_trextract_t reads_xdg_config_home_files;

typeattribute myloginuser_trextract_t traverses_data_home;
typeattribute myloginuser_trextract_t traverses_cache_home;

typeattribute myloginuser_trextract_t reads_passwd_files;

typeattribute myloginuser_trextract_t reads_system_state_files;

typeattribute myloginuser_trextract_t connects_to_user_session_bus;
typeattribute myloginuser_trextract_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_trextract_t chats_with_gvfsd;
typeattribute myloginuser_trextract_t chats_with_trminerfs;
typeattribute myloginuser_trextract_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_trextract_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_trextract_t chats_with_gvfsd_afcvolmon;

allow myloginuser_trextract_t myloginuser_trminerfs_t:fifo_file write;

allow myloginuser_trextract_t filesystem_type:filesystem getattr;

allow myloginuser_trextract_t trminer_config_home_t:dir { getattr search read };

allow myloginuser_trextract_t trstore_cache_home_t:dir { getattr search };

allow myloginuser_trextract_t trstore_data_home_t:dir { write search getattr add_name };
allow myloginuser_trextract_t trstore_data_home_t:file { create open getattr append };

allow myloginuser_trextract_t user_home_t:dir { getattr search };
allow myloginuser_trextract_t user_home_t:file { read getattr open };

########################################
#
# nautdataconvert
# 

type myloginuser_nautdataconvert_t, myloginuserprocess;
typeattribute myloginuser_nautdataconvert_t domain;
role myloginuser_r types myloginuser_nautdataconvert_t;

type nautdataconvert_exec_t, myloginuser_application_executable_type;
typeattribute nautdataconvert_exec_t file_type;
typeattribute nautdataconvert_exec_t non_security_file_type;
typeattribute nautdataconvert_exec_t non_auth_file_type;
typeattribute nautdataconvert_exec_t exec_type;
typeattribute nautdataconvert_exec_t application_exec_type;

allow myloginuser_nautdataconvert_t nautdataconvert_exec_t:file { read entrypoint };

########################################
#
# gvfsd_trash
# 

type myloginuser_gvfsd_trash_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_trash_t domain;
role myloginuser_r types myloginuser_gvfsd_trash_t;

type gvfsd_trash_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_trash_exec_t file_type;
typeattribute gvfsd_trash_exec_t non_security_file_type;
typeattribute gvfsd_trash_exec_t non_auth_file_type;
typeattribute gvfsd_trash_exec_t exec_type;
typeattribute gvfsd_trash_exec_t application_exec_type;

allow myloginuser_gvfsd_trash_t gvfsd_trash_exec_t:file { read entrypoint };

typeattribute gvfsd_trash_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_trash_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_trash_exec_t:process myloginuser_gvfsd_trash_t;

typeattribute myloginuser_gvfsd_trash_t traverses_user_tmp;

typeattribute myloginuser_gvfsd_trash_t traverses_user_home_dir;
typeattribute myloginuser_gvfsd_trash_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_gvfsd_trash_t traverses_data_home;
typeattribute myloginuser_gvfsd_trash_t lists_data_home;
typeattribute myloginuser_gvfsd_trash_t reads_metadata_data_home_files;

typeattribute myloginuser_gvfsd_trash_t traverses_config_home;
typeattribute myloginuser_gvfsd_trash_t reads_xdg_config_home_files;

typeattribute myloginuser_gvfsd_trash_t traverses_cache_home;

typeattribute myloginuser_gvfsd_trash_t traverses_thumb_home;
typeattribute myloginuser_gvfsd_trash_t lists_thumb_home;
typeattribute myloginuser_gvfsd_trash_t gets_attributes_of_thumb_home_files;

typeattribute myloginuser_gvfsd_trash_t reads_passwd_files;

typeattribute myloginuser_gvfsd_trash_t reads_urandom_device;

typeattribute myloginuser_gvfsd_trash_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gvfsd_trash_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_trash_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_trash_t chats_with_gvfsd_metadata;
typeattribute myloginuser_gvfsd_trash_t chats_with_naut;

allow myloginuser_gvfsd_trash_t user_home_t:file { rename write getattr read unlink open };
allow myloginuser_gvfsd_trash_t user_home_t:dir { rename setattr search read reparent write getattr rmdir open remove_name };

allow myloginuser_gvfsd_trash_t trash_data_home_t:dir { getattr search read open write setattr remove_name create open add_name };
allow myloginuser_gvfsd_trash_t trash_data_home_t:file { read getattr open unlink };

allow myloginuser_gvfsd_trash_t fusefs_t:dir { getattr search open read };

optional_policy(`
	gen_require(`
		type thumb_t, thumb_tmp_t;
	')

	allow thumb_t myloginuser_gvfsd_trash_t:unix_stream_socket connectto;

	allow myloginuser_gvfsd_trash_t thumb_tmp_t:dir { write remove_name add_name search getattr };
	allow myloginuser_gvfsd_trash_t thumb_tmp_t:file { rename write setattr create unlink open };
')

########################################
#
# gvfsd_burn
# 

type myloginuser_gvfsd_burn_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_burn_t domain;
role myloginuser_r types myloginuser_gvfsd_burn_t;

type gvfsd_burn_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_burn_exec_t file_type;
typeattribute gvfsd_burn_exec_t non_security_file_type;
typeattribute gvfsd_burn_exec_t non_auth_file_type;
typeattribute gvfsd_burn_exec_t exec_type;
typeattribute gvfsd_burn_exec_t application_exec_type;

allow myloginuser_gvfsd_burn_t gvfsd_burn_exec_t:file { read entrypoint };

typeattribute gvfsd_burn_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_burn_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_burn_exec_t:process myloginuser_gvfsd_burn_t;

type burn_tmp_t;
typeattribute burn_tmp_t file_type;
typeattribute burn_tmp_t tmpfile;
typeattribute burn_tmp_t user_tmp_type;

typeattribute myloginuser_gvfsd_burn_t traverses_user_tmp;
typeattribute myloginuser_gvfsd_burn_t adds_entries_to_user_tmp_dirs;

typeattribute myloginuser_gvfsd_burn_t reads_urandom_device;

typeattribute myloginuser_gvfsd_burn_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_burn_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_burn_t chats_with_naut;

allow myloginuser_gvfsd_burn_t burn_tmp_t:dir { write getattr create add_name search };
type_transition myloginuser_gvfsd_burn_t user_tmp_t:dir burn_tmp_t "gvfs-burn";

########################################
#
# gvfsd_recent
# 

type myloginuser_gvfsd_recent_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_recent_t domain;
role myloginuser_r types myloginuser_gvfsd_recent_t;

type gvfsd_recent_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_recent_exec_t file_type;
typeattribute gvfsd_recent_exec_t non_security_file_type;
typeattribute gvfsd_recent_exec_t non_auth_file_type;
typeattribute gvfsd_recent_exec_t exec_type;
typeattribute gvfsd_recent_exec_t application_exec_type;

allow myloginuser_gvfsd_recent_t gvfsd_recent_exec_t:file { read entrypoint };

typeattribute gvfsd_recent_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_recent_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_recent_exec_t:process myloginuser_gvfsd_recent_t;

typeattribute myloginuser_gvfsd_recent_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gvfsd_recent_t reads_xdm_runtime_files;

typeattribute myloginuser_gvfsd_recent_t traverses_user_home_dir;

typeattribute myloginuser_gvfsd_recent_t traverses_data_home;
typeattribute myloginuser_gvfsd_recent_t lists_data_home;
typeattribute myloginuser_gvfsd_recent_t reads_metadata_data_home_files;
typeattribute myloginuser_gvfsd_recent_t reads_recentlyused_data_home_files;
typeattribute myloginuser_gvfsd_recent_t manages_gtk_bookmarks;

typeattribute myloginuser_gvfsd_recent_t traverses_config_home;
typeattribute myloginuser_gvfsd_recent_t reads_xdg_config_home_files;

typeattribute myloginuser_gvfsd_recent_t traverses_cache_home;

typeattribute myloginuser_gvfsd_recent_t traverses_thumb_home;
typeattribute myloginuser_gvfsd_recent_t lists_thumb_home;
typeattribute myloginuser_gvfsd_recent_t gets_attributes_of_thumb_home_files;

typeattribute myloginuser_gvfsd_recent_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_gvfsd_recent_t reads_passwd_files;

typeattribute myloginuser_gvfsd_recent_t reads_urandom_device;

typeattribute myloginuser_gvfsd_recent_t reads_sysfs;

typeattribute myloginuser_gvfsd_recent_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gvfsd_recent_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_recent_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_recent_t chats_with_atspi2;
typeattribute myloginuser_gvfsd_recent_t chats_with_naut;

allow myloginuser_gvfsd_recent_t user_home_type:{ dir file } audit_access;
allow myloginuser_gvfsd_recent_t { user_home_t user_home_dir_t }:{ file dir } { read write getattr };
allow myloginuser_gvfsd_recent_t user_home_t:dir search;

########################################
#
# gvfsd_network
# 

type myloginuser_gvfsd_network_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_network_t domain;
role myloginuser_r types myloginuser_gvfsd_network_t;

type gvfsd_network_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_network_exec_t file_type;
typeattribute gvfsd_network_exec_t non_security_file_type;
typeattribute gvfsd_network_exec_t non_auth_file_type;
typeattribute gvfsd_network_exec_t exec_type;
typeattribute gvfsd_network_exec_t application_exec_type;

allow myloginuser_gvfsd_network_t gvfsd_network_exec_t:file { read entrypoint };

typeattribute gvfsd_network_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_network_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_network_exec_t:process myloginuser_gvfsd_network_t;

typeattribute myloginuser_gvfsd_network_t traverses_user_tmp; 
typeattribute myloginuser_gvfsd_network_t creates_dconf_runtime_files; 

typeattribute myloginuser_gvfsd_network_t traverses_user_home_dir; 

typeattribute myloginuser_gvfsd_network_t traverses_config_home; 
typeattribute myloginuser_gvfsd_network_t reads_dconf_config_home_files; 

typeattribute myloginuser_gvfsd_network_t traverses_cache_home; 

typeattribute myloginuser_gvfsd_network_t traverses_thumb_home;
typeattribute myloginuser_gvfsd_network_t lists_thumb_home;
typeattribute myloginuser_gvfsd_network_t gets_attributes_of_thumb_home_files;

typeattribute myloginuser_gvfsd_network_t reads_passwd_files;

typeattribute myloginuser_gvfsd_network_t reads_urandom_device;

typeattribute myloginuser_gvfsd_network_t connects_to_user_session_bus; 
typeattribute myloginuser_gvfsd_network_t chats_with_gvfsd; 
typeattribute myloginuser_gvfsd_network_t chats_with_naut; 

allow myloginuser_gvfsd_network_t myloginuser_gvfsd_dnssd_t:unix_stream_socket connectto;

########################################
#
# gvfsd_smbbrowse
# 

type myloginuser_gvfsd_smbbrowse_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_smbbrowse_t domain;
role myloginuser_r types myloginuser_gvfsd_smbbrowse_t;

type gvfsd_smbbrowse_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_smbbrowse_exec_t file_type;
typeattribute gvfsd_smbbrowse_exec_t non_security_file_type;
typeattribute gvfsd_smbbrowse_exec_t non_auth_file_type;
typeattribute gvfsd_smbbrowse_exec_t exec_type;
typeattribute gvfsd_smbbrowse_exec_t application_exec_type;

allow myloginuser_gvfsd_smbbrowse_t gvfsd_smbbrowse_exec_t:file { read entrypoint };

typeattribute gvfsd_smbbrowse_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_smbbrowse_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_smbbrowse_exec_t:process myloginuser_gvfsd_smbbrowse_t;

typeattribute myloginuser_gvfsd_smbbrowse_t traverses_user_tmp;
typeattribute myloginuser_gvfsd_smbbrowse_t creates_dconf_runtime_files;

typeattribute myloginuser_gvfsd_smbbrowse_t traverses_user_home_dir;

typeattribute myloginuser_gvfsd_smbbrowse_t traverses_config_home;
typeattribute myloginuser_gvfsd_smbbrowse_t reads_dconf_config_home_files;

typeattribute myloginuser_gvfsd_smbbrowse_t traverses_cache_home;

typeattribute myloginuser_gvfsd_smbbrowse_t traverses_var_lib;

typeattribute myloginuser_gvfsd_smbbrowse_t reads_passwd_files;

typeattribute myloginuser_gvfsd_smbbrowse_t reads_network_config_files;

typeattribute myloginuser_gvfsd_smbbrowse_t reads_urandom_device;

typeattribute myloginuser_gvfsd_smbbrowse_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_smbbrowse_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_smbbrowse_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_smbbrowse_t chats_with_naut;

allow myloginuser_gvfsd_smbbrowse_t self:netlink_route_socket { write getattr read bind create nlmsg_read };
allow myloginuser_gvfsd_smbbrowse_t self:udp_socket { write getattr setopt read bind create connect };
allow myloginuser_gvfsd_smbbrowse_t self:tcp_socket { create connect };

allow myloginuser_gvfsd_smbbrowse_t smbd_port_t:tcp_socket name_connect;
allow myloginuser_gvfsd_smbbrowse_t node_t:udp_socket node_bind;

optional_policy(`
	gen_require(`
		type samba_etc_t, samba_var_t, smbd_var_run_t;
	')

	allow myloginuser_gvfsd_smbbrowse_t samba_etc_t:dir { getattr search };
	allow myloginuser_gvfsd_smbbrowse_t samba_etc_t:file { read getattr open };

	allow myloginuser_gvfsd_smbbrowse_t samba_var_t:dir { getattr search };
	allow myloginuser_gvfsd_smbbrowse_t smbd_var_run_t:dir { search getattr };
')

########################################
#
# gvfsd_dnssd
# 

type myloginuser_gvfsd_dnssd_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_dnssd_t domain;
role myloginuser_r types myloginuser_gvfsd_dnssd_t;

type gvfsd_dnssd_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_dnssd_exec_t file_type;
typeattribute gvfsd_dnssd_exec_t non_security_file_type;
typeattribute gvfsd_dnssd_exec_t non_auth_file_type;
typeattribute gvfsd_dnssd_exec_t exec_type;
typeattribute gvfsd_dnssd_exec_t application_exec_type;

allow myloginuser_gvfsd_dnssd_t gvfsd_dnssd_exec_t:file { read entrypoint };

typeattribute gvfsd_dnssd_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_dnssd_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_dnssd_exec_t:process myloginuser_gvfsd_dnssd_t;

typeattribute myloginuser_gvfsd_dnssd_t reads_urandom_device;

typeattribute myloginuser_gvfsd_dnssd_t connects_to_system_bus;
typeattribute myloginuser_gvfsd_dnssd_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_dnssd_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_dnssd_t chats_with_gvfsd_network;

########################################
#
# gvfsd_sftp
# 

type myloginuser_gvfsd_sftp_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_sftp_t domain;
role myloginuser_r types myloginuser_gvfsd_sftp_t;

type gvfsd_sftp_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_sftp_exec_t file_type;
typeattribute gvfsd_sftp_exec_t non_security_file_type;
typeattribute gvfsd_sftp_exec_t non_auth_file_type;
typeattribute gvfsd_sftp_exec_t exec_type;
typeattribute gvfsd_sftp_exec_t application_exec_type;

allow myloginuser_gvfsd_sftp_t gvfsd_sftp_exec_t:file { read entrypoint };

typeattribute gvfsd_sftp_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_sftp_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_sftp_exec_t:process myloginuser_gvfsd_sftp_t;

typeattribute myloginuser_gvfsd_sftp_t traverses_user_home_dir;

typeattribute myloginuser_gvfsd_sftp_t traverses_cache_home;
typeattribute myloginuser_gvfsd_sftp_t traverses_data_home;

typeattribute myloginuser_gvfsd_sftp_t traverses_thumb_home;

typeattribute myloginuser_gvfsd_sftp_t traverses_devpts;

typeattribute myloginuser_gvfsd_sftp_t reads_passwd_files;

typeattribute myloginuser_gvfsd_sftp_t reads_urandom_device;

typeattribute myloginuser_gvfsd_sftp_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_sftp_t chats_with_hotplugsniff;
typeattribute myloginuser_gvfsd_sftp_t chats_with_gkrd;
typeattribute myloginuser_gvfsd_sftp_t chats_with_gvfsd;
typeattribute myloginuser_gvfsd_sftp_t chats_with_naut;

allow myloginuser_gvfsd_sftp_t devpts_t:chr_file { read write getattr open ioctl };
allow myloginuser_gvfsd_sftp_t devpts_t:filesystem getattr;

allow myloginuser_gvfsd_sftp_t ptmx_t:chr_file { read write ioctl open };

########################################
#
# gvfsd_http
# 

type myloginuser_gvfsd_http_t, myloginuserprocess;
typeattribute myloginuser_gvfsd_http_t domain;
role myloginuser_r types myloginuser_gvfsd_http_t;

type gvfsd_http_exec_t, myloginuser_application_executable_type;
typeattribute gvfsd_http_exec_t file_type;
typeattribute gvfsd_http_exec_t non_security_file_type;
typeattribute gvfsd_http_exec_t non_auth_file_type;
typeattribute gvfsd_http_exec_t exec_type;
typeattribute gvfsd_http_exec_t application_exec_type;

allow myloginuser_gvfsd_http_t gvfsd_http_exec_t:file { read entrypoint };

typeattribute gvfsd_http_exec_t started_by_user_gvfsd_exec_type;
typeattribute myloginuser_gvfsd_http_t started_by_user_gvfsd;
type_transition myloginuser_gvfsd_t gvfsd_http_exec_t:process myloginuser_gvfsd_http_t;

typeattribute myloginuser_gvfsd_http_t traverses_user_tmp;
typeattribute myloginuser_gvfsd_http_t creates_dconf_runtime_files;

typeattribute myloginuser_gvfsd_http_t traverses_user_home_dir;

typeattribute myloginuser_gvfsd_http_t traverses_config_home;
typeattribute myloginuser_gvfsd_http_t reads_dconf_config_home_files;

typeattribute myloginuser_gvfsd_http_t traverses_data_home;
typeattribute myloginuser_gvfsd_http_t traverses_cache_home;

typeattribute myloginuser_gvfsd_http_t reads_passwd_files;

typeattribute myloginuser_gvfsd_http_t reads_network_config_files;

typeattribute myloginuser_gvfsd_http_t reads_urandom_device;

typeattribute myloginuser_gvfsd_http_t connects_to_user_session_bus;
typeattribute myloginuser_gvfsd_http_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gvfsd_http_t chats_with_gvfsd;

allow myloginuser_gvfsd_http_t self:netlink_route_socket { write getattr read bind create nlmsg_read };
allow myloginuser_gvfsd_http_t self:tcp_socket { write getopt create read connect };
allow myloginuser_gvfsd_http_t self:udp_socket { write read create connect getattr };

allow myloginuser_gvfsd_http_t http_port_t:tcp_socket name_connect;

########################################
#
# seahorse
# 

type myloginuser_seahorse_t, myloginuserprocess;
typeattribute myloginuser_seahorse_t domain;
role myloginuser_r types myloginuser_seahorse_t;

type seahorse_exec_t, myloginuser_application_executable_type;
typeattribute seahorse_exec_t file_type;
typeattribute seahorse_exec_t non_security_file_type;
typeattribute seahorse_exec_t non_auth_file_type;
typeattribute seahorse_exec_t exec_type;
typeattribute seahorse_exec_t application_exec_type;

allow myloginuser_seahorse_t seahorse_exec_t:file { read entrypoint };

typeattribute seahorse_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_seahorse_t started_by_user_gshell;
type_transition myloginuser_gshell_t seahorse_exec_t:process myloginuser_seahorse_t;

type seahorse_tmp_t;
typeattribute seahorse_tmp_t file_type;
typeattribute seahorse_tmp_t tmpfile;
typeattribute seahorse_tmp_t user_tmp_type;

typeattribute myloginuser_seahorse_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_seahorse_t reads_xdm_runtime_files;

typeattribute myloginuser_seahorse_t gkrd_reads_state;

typeattribute myloginuser_seahorse_t inherits_user_fd;

typeattribute myloginuser_seahorse_t reads_iceauth_home_files;

typeattribute myloginuser_seahorse_t traverses_user_tmp;
typeattribute myloginuser_seahorse_t creates_dconf_runtime_files;

typeattribute myloginuser_seahorse_t traverses_user_home_dir;
typeattribute myloginuser_seahorse_t manages_ssh_home;

typeattribute myloginuser_seahorse_t traverses_user_home_dir;
typeattribute myloginuser_seahorse_t lists_user_home_dir;
typeattribute myloginuser_seahorse_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_seahorse_t traverses_all_user_home_content_dirs;
typeattribute myloginuser_seahorse_t lists_all_user_home_content_dirs;

typeattribute myloginuser_seahorse_t traverses_config_home;
typeattribute myloginuser_seahorse_t reads_dconf_config_home_files;
typeattribute myloginuser_seahorse_t reads_xdg_config_home_files;

typeattribute myloginuser_seahorse_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_seahorse_t creates_ibus_config_home_dirs;

typeattribute myloginuser_seahorse_t traverses_data_home;
typeattribute myloginuser_seahorse_t lists_data_home;
typeattribute myloginuser_seahorse_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_seahorse_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_seahorse_t manages_recentlyused_data_home_files;
typeattribute myloginuser_seahorse_t manages_gtk_bookmarks;

typeattribute myloginuser_seahorse_t reads_bash_home_files;

typeattribute myloginuser_seahorse_t traverses_tmp;
typeattribute myloginuser_seahorse_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_seahorse_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_seahorse_t traverses_var_lib;
typeattribute myloginuser_seahorse_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_seahorse_t reads_passwd_files;

typeattribute myloginuser_seahorse_t reads_system_state_files;

typeattribute myloginuser_seahorse_t reads_fonts;

typeattribute myloginuser_seahorse_t reads_pulseaudio_home_files;

typeattribute myloginuser_seahorse_t reads_network_config_files;

typeattribute myloginuser_seahorse_t appends_xdm_home_files;

typeattribute myloginuser_seahorse_t reads_urandom_device;
typeattribute myloginuser_seahorse_t reads_random_device;

typeattribute myloginuser_seahorse_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_seahorse_t connects_to_system_bus;
typeattribute myloginuser_seahorse_t connects_to_user_session_bus;
typeattribute myloginuser_seahorse_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_seahorse_t chats_with_gkrd;
typeattribute myloginuser_seahorse_t chats_with_gvfsd;
typeattribute myloginuser_seahorse_t chats_with_atspi2;
typeattribute myloginuser_seahorse_t chats_with_dconf;
typeattribute myloginuser_seahorse_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_seahorse_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_seahorse_t chats_with_gvfsd_afcvolmon;

typeattribute myloginuser_seahorse_t connects_to_user_gkrd;

typeattribute myloginuser_seahorse_t runs_yelp;
typeattribute myloginuser_seahorse_t runs_gpg;

allow myloginuser_seahorse_t self:tcp_socket { getattr setopt getopt bind create connect write read shutdown };
allow myloginuser_seahorse_t self:udp_socket { getattr setopt getopt bind create connect write read };
allow myloginuser_seahorse_t self:netlink_route_socket { write getattr read bind create nlmsg_read };

allow myloginuser_seahorse_t ldap_port_t:tcp_socket name_connect;
allow myloginuser_seahorse_t pgpkeyserver_port_t:tcp_socket name_connect;

allow myloginuser_seahorse_t { user_home_t user_home_dir_t }:dir { write add_name };
allow myloginuser_seahorse_t user_home_t:file { write create open getattr read };
type_transition myloginuser_seahorse_t user_home_dir_t:file user_home_t;

dontaudit myloginuser_seahorse_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_seahorse_t file_type:dir search;

allow myloginuser_seahorse_t seahorse_tmp_t:file { write create unlink open };
type_transition myloginuser_seahorse_t tmp_t:file seahorse_tmp_t;

optional_policy(`
	gen_require(`
		type gpg_secret_t;
	')

	allow myloginuser_seahorse_t gpg_secret_t:dir { getattr search open read };
')

########################################
#
# gpg
# 

type myloginuser_gpg_t, myloginuserprocess;
typeattribute myloginuser_gpg_t domain;
role myloginuser_r types myloginuser_gpg_t;

typeattribute myloginuser_gpg_t inherits_user_fd;

typeattribute myloginuser_gpg_t traverses_user_tmp;

typeattribute myloginuser_gpg_t traverses_user_home_dir;
typeattribute myloginuser_gpg_t adds_entries_to_user_home_dirs;

typeattribute myloginuser_gpg_t traverses_cache_home;

typeattribute myloginuser_gpg_t traverses_data_home;
typeattribute myloginuser_gpg_t reads_metadata_data_home_files;

typeattribute myloginuser_gpg_t reads_system_state_files;

typeattribute myloginuser_gpg_t appends_xdm_home_files;

typeattribute myloginuser_gpg_t reads_urandom_device;
typeattribute myloginuser_gpg_t reads_random_device;

typeattribute myloginuser_gpg_t connects_to_user_gkrd;

allow myloginuser_gpg_t self:process { setrlimit signull };

allow myloginuser_gpg_t runs_gpg:fd use;
allow myloginuser_gpg_t runs_gpg:fifo_file { read write getattr ioctl };
allow myloginuser_gpg_t runs_gpg:process sigchld;

allow runs_gpg myloginuser_gpg_t:process transition;

allow myloginuser_gpg_t myloginuser_dejadup_t:netlink_route_socket { read write };

allow myloginuser_gpg_t dejadup_cache_home_t:dir { getattr search };
allow myloginuser_gpg_t dejadup_cache_home_t:file { read write getattr append };

allow myloginuser_gpg_t dejadup_tmp_t:file write;

optional_policy(`
	gen_require(`
		type gpg_exec_t, gpg_secret_t;
	')

	allow myloginuser_gpg_t gpg_exec_t:file { read entrypoint };
	allow runs_gpg gpg_exec_t:file { getattr open read execute };

	type_transition runs_gpg gpg_exec_t:process myloginuser_gpg_t;

	allow myloginuser_gpg_t gpg_secret_t:dir { write remove_name getattr search create add_name };
	allow myloginuser_gpg_t gpg_secret_t:file { write getattr link read create unlink open rename lock setattr };
	type_transition myloginuser_gpg_t user_home_dir_t:dir gpg_secret_t ".gnupg";
')

########################################
#
# gpgconf
# 

type myloginuser_gpgconf_t, myloginuserprocess;
typeattribute myloginuser_gpgconf_t domain;
role myloginuser_r types myloginuser_gpgconf_t;

type gpgconf_exec_t, myloginuser_application_executable_type;
typeattribute gpgconf_exec_t file_type;
typeattribute gpgconf_exec_t non_security_file_type;
typeattribute gpgconf_exec_t non_auth_file_type;
typeattribute gpgconf_exec_t exec_type;
typeattribute gpgconf_exec_t application_exec_type;

allow myloginuser_gpgconf_t gpgconf_exec_t:file { read entrypoint };

allow myloginuser_gpgconf_t myloginuser_seahorse_t:fd use;
allow myloginuser_gpgconf_t myloginuser_seahorse_t:fifo_file { read write getattr ioctl };
allow myloginuser_gpgconf_t myloginuser_seahorse_t:process sigchld;

allow myloginuser_seahorse_t gpgconf_exec_t:file { getattr open read execute };
allow myloginuser_seahorse_t myloginuser_gpgconf_t:process transition;
type_transition myloginuser_seahorse_t gpgconf_exec_t:process myloginuser_gpgconf_t;

########################################
#
# sshkeygen
# 

type myloginuser_sshkeygen_t, myloginuserprocess;
typeattribute myloginuser_sshkeygen_t domain;
role myloginuser_r types myloginuser_sshkeygen_t;

typeattribute myloginuser_sshkeygen_t traverses_user_home_dir;
typeattribute myloginuser_sshkeygen_t reads_ssh_home_files;
typeattribute myloginuser_sshkeygen_t adds_entries_to_ssh_home_dirs;

typeattribute myloginuser_sshkeygen_t reads_passwd_files;

typeattribute myloginuser_sshkeygen_t reads_system_certificates;

typeattribute myloginuser_sshkeygen_t reads_system_state_files;

typeattribute myloginuser_sshkeygen_t reads_urandom_device;

allow myloginuser_sshkeygen_t myloginuser_seahorse_t:fd use;
allow myloginuser_sshkeygen_t myloginuser_seahorse_t:fifo_file { read write getattr ioctl };
allow myloginuser_sshkeygen_t myloginuser_seahorse_t:process sigchld;

allow myloginuser_seahorse_t myloginuser_sshkeygen_t:process transition;

optional_policy(`
	gen_require(`
		type ssh_keygen_exec_t, ssh_home_t;
	')

	allow myloginuser_sshkeygen_t ssh_keygen_exec_t:file { read entrypoint };
	allow myloginuser_seahorse_t ssh_keygen_exec_t:file { getattr open read execute };

	type_transition myloginuser_seahorse_t ssh_keygen_exec_t:process myloginuser_sshkeygen_t;

	allow myloginuser_sshkeygen_t ssh_home_t:file { write create };
')

########################################
#
# seahorse_askpass
# 

type myloginuser_seahorse_askpass_t, myloginuserprocess;
typeattribute myloginuser_seahorse_askpass_t domain;
role myloginuser_r types myloginuser_seahorse_askpass_t;

type seahorse_askpass_exec_t, myloginuser_application_executable_type;
typeattribute seahorse_askpass_exec_t file_type;
typeattribute seahorse_askpass_exec_t non_security_file_type;
typeattribute seahorse_askpass_exec_t non_auth_file_type;
typeattribute seahorse_askpass_exec_t exec_type;
typeattribute seahorse_askpass_exec_t application_exec_type;

allow myloginuser_seahorse_askpass_t seahorse_askpass_exec_t:file { read entrypoint };

typeattribute myloginuser_seahorse_askpass_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_seahorse_askpass_t reads_xdm_runtime_files;

typeattribute myloginuser_seahorse_askpass_t traverses_user_home_dir;

typeattribute myloginuser_seahorse_askpass_t traverses_data_home;
typeattribute myloginuser_seahorse_askpass_t traverses_gtk_home;

typeattribute myloginuser_seahorse_askpass_t traverses_config_home;

typeattribute myloginuser_seahorse_askpass_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_seahorse_askpass_t creates_ibus_config_home_dirs;

typeattribute myloginuser_seahorse_askpass_t traverses_var_lib;
typeattribute myloginuser_seahorse_askpass_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_seahorse_askpass_t reads_passwd_files;

typeattribute myloginuser_seahorse_askpass_t reads_fonts;

typeattribute myloginuser_seahorse_askpass_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_seahorse_askpass_t connects_to_user_session_bus;
typeattribute myloginuser_seahorse_askpass_t chats_with_gvfsd;
typeattribute myloginuser_seahorse_askpass_t chats_with_atspi2;

allow myloginuser_seahorse_askpass_t myloginuser_sshkeygen_t:fd use;
allow myloginuser_seahorse_askpass_t myloginuser_sshkeygen_t:fifo_file { read write getattr ioctl };
allow myloginuser_seahorse_askpass_t myloginuser_sshkeygen_t:process sigchld;

allow myloginuser_sshkeygen_t seahorse_askpass_exec_t:file { getattr open read execute };
allow myloginuser_sshkeygen_t myloginuser_seahorse_askpass_t:process transition;
type_transition myloginuser_sshkeygen_t seahorse_askpass_exec_t:process myloginuser_seahorse_askpass_t;

allow myloginuser_seahorse_askpass_t myloginuser_seahorse_t:fifo_file write;

########################################
#
# gpgagent
# 

type myloginuser_gpgagent_t, myloginuserprocess;
typeattribute myloginuser_gpgagent_t domain;
role myloginuser_r types myloginuser_gpgagent_t;

type gpgagent_exec_t, myloginuser_application_executable_type;
typeattribute gpgagent_exec_t file_type;
typeattribute gpgagent_exec_t non_security_file_type;
typeattribute gpgagent_exec_t non_auth_file_type;
typeattribute gpgagent_exec_t exec_type;
typeattribute gpgagent_exec_t application_exec_type;

allow myloginuser_gpgagent_t gpgagent_exec_t:file { read entrypoint };

allow myloginuser_gpgagent_t myloginuser_gpg_t:fd use;
allow myloginuser_gpgagent_t myloginuser_gpg_t:fifo_file { read write getattr ioctl };
allow myloginuser_gpgagent_t myloginuser_gpg_t:process sigchld;

allow myloginuser_gpg_t myloginuser_gpgagent_t:process transition;

optional_policy(`
	gen_require(`
		type gpg_agent_exec_t;
	')

	allow myloginuser_gpgagent_t gpg_agent_exec_t:file { read entrypoint };
	allow myloginuser_gpg_t gpg_agent_exec_t:file { getattr open read execute };

	type_transition myloginuser_gpg_t gpg_agent_exec_t:process myloginuser_gpgagent_t;
')

########################################
#
# hotplugsniff
# 

type myloginuser_hotplugsniff_t, myloginuserprocess;
typeattribute myloginuser_hotplugsniff_t domain;
role myloginuser_r types myloginuser_hotplugsniff_t;

type hotplugsniff_exec_t, myloginuser_application_executable_type;
typeattribute hotplugsniff_exec_t file_type;
typeattribute hotplugsniff_exec_t non_security_file_type;
typeattribute hotplugsniff_exec_t non_auth_file_type;
typeattribute hotplugsniff_exec_t exec_type;
typeattribute hotplugsniff_exec_t application_exec_type;

allow myloginuser_hotplugsniff_t hotplugsniff_exec_t:file { read entrypoint };

typeattribute hotplugsniff_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_hotplugsniff_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t hotplugsniff_exec_t:process myloginuser_hotplugsniff_t;

typeattribute myloginuser_hotplugsniff_t reads_passwd_files;

typeattribute myloginuser_hotplugsniff_t connects_to_user_session_bus;
typeattribute myloginuser_hotplugsniff_t aqcuires_service_on_user_session_bus;

allow myloginuser_hotplugsniff_t myloginuser_gvfsd_sftp_t:unix_stream_socket connectto;

########################################
#
# ssh
# 

type myloginuser_ssh_t, myloginuserprocess;
typeattribute myloginuser_ssh_t domain;
role myloginuser_r types myloginuser_ssh_t;

typeattribute myloginuser_ssh_t traverses_user_tmp;

typeattribute myloginuser_ssh_t traverses_user_home_dir;
typeattribute myloginuser_ssh_t reads_ssh_home_files;
typeattribute myloginuser_ssh_t adds_entries_to_ssh_home_dirs;

typeattribute myloginuser_ssh_t reads_passwd_files;

typeattribute myloginuser_ssh_t reads_system_certificates;

typeattribute myloginuser_ssh_t reads_system_state_files;

typeattribute myloginuser_ssh_t reads_network_config_files;

typeattribute myloginuser_ssh_t reads_urandom_device;

typeattribute myloginuser_ssh_t connects_to_user_gkrd;

allow myloginuser_ssh_t myloginuser_gvfsd_sftp_t:fd use;
allow myloginuser_ssh_t myloginuser_gvfsd_sftp_t:fifo_file { read write getattr ioctl };
allow myloginuser_ssh_t myloginuser_gvfsd_sftp_t:process sigchld;

allow myloginuser_gvfsd_sftp_t myloginuser_ssh_t:process transition;

allow myloginuser_ssh_t self:netlink_route_socket { write getattr read bind create nlmsg_read };
allow myloginuser_ssh_t self:tcp_socket { write getattr setopt read getopt create connect shutdown };
allow myloginuser_ssh_t self:udp_socket { write read create connect getattr };

allow myloginuser_ssh_t ssh_port_t:tcp_socket name_connect;

allow myloginuser_ssh_t devpts_t:chr_file { read write };

allow myloginuser_ssh_t krb5cc_tmp_t:dir { getattr search open read };
allow myloginuser_ssh_t primary_tmp_t:file open;

optional_policy(`
	gen_require(`
		type ssh_exec_t, ssh_home_t;
	')

	allow myloginuser_ssh_t ssh_exec_t:file { read entrypoint };
	allow myloginuser_gvfsd_sftp_t ssh_exec_t:file { getattr open read execute };

	type_transition myloginuser_gvfsd_sftp_t ssh_exec_t:process myloginuser_ssh_t;

	allow myloginuser_ssh_t ssh_home_t:file { create append };
')

optional_policy(`
	gen_require(`
		type krb5_conf_t;
	')

	allow myloginuser_ssh_t krb5_conf_t:file { read getattr open };
')

########################################
#
# gedit
# 

type myloginuser_gedit_t, myloginuserprocess;
typeattribute myloginuser_gedit_t domain;
role myloginuser_r types myloginuser_gedit_t;

type gedit_exec_t, myloginuser_application_executable_type;
typeattribute gedit_exec_t file_type;
typeattribute gedit_exec_t non_security_file_type;
typeattribute gedit_exec_t non_auth_file_type;
typeattribute gedit_exec_t exec_type;
typeattribute gedit_exec_t application_exec_type;

allow myloginuser_gedit_t gedit_exec_t:file { read entrypoint };

typeattribute gedit_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_gedit_t started_by_user_gshell;
type_transition myloginuser_gshell_t gedit_exec_t:process myloginuser_gedit_t;

typeattribute gedit_exec_t started_by_user_naut_exec_type;
typeattribute myloginuser_gedit_t started_by_user_naut;
type_transition myloginuser_naut_t gedit_exec_t:process myloginuser_gedit_t;

type gedit_tmp_t;
typeattribute gedit_tmp_t file_type;
typeattribute gedit_tmp_t tmpfile;
typeattribute gedit_tmp_t user_tmp_type;

type enchant_config_home_t;
typeattribute enchant_config_home_t file_type;
typeattribute enchant_config_home_t user_home_type;

type gedit_config_home_t;
typeattribute gedit_config_home_t file_type;
typeattribute gedit_config_home_t user_home_type;

typeattribute myloginuser_gedit_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gedit_t reads_xdm_runtime_files;

typeattribute myloginuser_gedit_t inherits_user_fd;

typeattribute myloginuser_gedit_t reads_iceauth_home_files;

typeattribute myloginuser_gedit_t traverses_user_tmp;
typeattribute myloginuser_gedit_t creates_dconf_runtime_files;

typeattribute myloginuser_gedit_t traverses_user_home_dir;
typeattribute myloginuser_gedit_t lists_user_home_dir;

typeattribute myloginuser_gedit_t traverses_config_home;
typeattribute myloginuser_gedit_t reads_dconf_config_home_files;
typeattribute myloginuser_gedit_t reads_xdg_config_home_files;

typeattribute myloginuser_gedit_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_gedit_t creates_ibus_config_home_dirs;

typeattribute myloginuser_gedit_t traverses_data_home;
typeattribute myloginuser_gedit_t lists_data_home;
typeattribute myloginuser_gedit_t adds_entries_to_data_home_dirs;
typeattribute myloginuser_gedit_t removes_entries_from_data_home_dirs;
typeattribute myloginuser_gedit_t reads_metadata_data_home_files;
typeattribute myloginuser_gedit_t manages_recentlyused_data_home_files;
typeattribute myloginuser_gedit_t manages_gtk_bookmarks;

typeattribute myloginuser_gedit_t reads_bash_home_files;

typeattribute myloginuser_gedit_t traverses_cache_home;

typeattribute myloginuser_gedit_t traverses_tmp;
typeattribute myloginuser_gedit_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_gedit_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_gedit_t reads_passwd_files;

typeattribute myloginuser_gedit_t reads_fonts;

typeattribute myloginuser_gedit_t reads_pulseaudio_home_files;

typeattribute myloginuser_gedit_t reads_urandom_device;
typeattribute myloginuser_gedit_t reads_random_device;

typeattribute myloginuser_gedit_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gedit_t connects_to_user_session_bus;
typeattribute myloginuser_gedit_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gedit_t chats_with_gvfsd;
typeattribute myloginuser_gedit_t chats_with_atspi2;
typeattribute myloginuser_gedit_t chats_with_dconf;
typeattribute myloginuser_gedit_t chats_with_gvfsd_udiskmon;
typeattribute myloginuser_gedit_t chats_with_gvfsd_gphotovolmon;
typeattribute myloginuser_gedit_t chats_with_gvfsd_afcvolmon;
typeattribute myloginuser_gedit_t chats_with_gvfsd_metadata;
typeattribute myloginuser_gedit_t chats_with_trstore;
typeattribute myloginuser_gedit_t chats_with_gshell;

typeattribute myloginuser_gedit_t connects_to_user_gkrd;

typeattribute myloginuser_gedit_t connects_to_cups;
typeattribute myloginuser_gedit_t reads_cups_config_files;

typeattribute myloginuser_gedit_t runs_yelp;

allow myloginuser_gedit_t myloginuser_nautsrchp_t:fd use;
allow myloginuser_gedit_t myloginuser_nautsrchp_t:fifo_file { read write getattr ioctl };
allow myloginuser_gedit_t myloginuser_nautsrchp_t:process sigchld;

allow myloginuser_nautsrchp_t gedit_exec_t:file { getattr open read execute };
allow myloginuser_nautsrchp_t myloginuser_gedit_t:process transition;
type_transition myloginuser_nautsrchp_t gedit_exec_t:process myloginuser_gedit_t;

allow myloginuser_gedit_t gedit_tmp_t:file { write create unlink open setattr };
type_transition myloginuser_gedit_t tmp_t:file gedit_tmp_t;

allow myloginuser_gedit_t { user_home_t user_home_dir_t }:dir { write add_name remove_name };
allow myloginuser_gedit_t user_home_t:file { getattr read write open ioctl create rename unlink setattr link };
allow myloginuser_gedit_t user_home_t:dir { create rmdir setattr read getattr search open };
type_transition myloginuser_gedit_t user_home_dir_t:{ dir file } user_home_t;

dontaudit myloginuser_gedit_t file_type:{ dir lnk_file file fifo_file sock_file chr_file blk_file } { getattr read };
dontaudit myloginuser_gedit_t file_type:dir search;

allow myloginuser_gedit_t ipp_port_t:tcp_socket name_connect;
allow myloginuser_gedit_t self:tcp_socket { create connect setopt };

allow myloginuser_gedit_t myloginuser_gsession_t:unix_stream_socket connectto;

allow myloginuser_gedit_t enchant_config_home_t:dir { create getattr search write add_name remove_name read open };
allow myloginuser_gedit_t enchant_config_home_t:file { getattr read lock create open append };

allow myloginuser_gedit_t gedit_config_home_t:dir { create getattr search write add_name remove_name read open };
allow myloginuser_gedit_t gedit_config_home_t:file { rename write getattr read create open };

optional_policy(`
	gen_require(`
		type config_home_t;
	')

	type_transition myloginuser_gedit_t config_home_t:dir enchant_config_home_t "enchant";
	type_transition myloginuser_gedit_t config_home_t:dir gedit_config_home_t "gedit";
')

########################################
#
# vinopwd
# 

type myloginuser_vinopwd_t, myloginuserprocess;
typeattribute myloginuser_vinopwd_t domain;
role myloginuser_r types myloginuser_vinopwd_t;

type vinopwd_exec_t, myloginuser_application_executable_type;
typeattribute vinopwd_exec_t file_type;
typeattribute vinopwd_exec_t non_security_file_type;
typeattribute vinopwd_exec_t non_auth_file_type;
typeattribute vinopwd_exec_t exec_type;
typeattribute vinopwd_exec_t application_exec_type;

allow myloginuser_vinopwd_t vinopwd_exec_t:file { read entrypoint };

allow myloginuser_vinopwd_t myloginuser_vinoprefs_t:fd use;
allow myloginuser_vinopwd_t myloginuser_vinoprefs_t:fifo_file { read write getattr ioctl };
allow myloginuser_vinopwd_t myloginuser_vinoprefs_t:process sigchld;

allow myloginuser_vinoprefs_t vinopwd_exec_t:file { getattr open read execute };
allow myloginuser_vinoprefs_t myloginuser_vinopwd_t:process transition;
type_transition myloginuser_vinoprefs_t vinopwd_exec_t:process myloginuser_vinopwd_t;

########################################
#
# vinoprefs
# 

type myloginuser_vinoprefs_t, myloginuserprocess;
typeattribute myloginuser_vinoprefs_t domain;
role myloginuser_r types myloginuser_vinoprefs_t;

type vinoprefs_exec_t, myloginuser_application_executable_type;
typeattribute vinoprefs_exec_t file_type;
typeattribute vinoprefs_exec_t non_security_file_type;
typeattribute vinoprefs_exec_t non_auth_file_type;
typeattribute vinoprefs_exec_t exec_type;
typeattribute vinoprefs_exec_t application_exec_type;

allow myloginuser_vinoprefs_t vinoprefs_exec_t:file { read entrypoint };

typeattribute vinoprefs_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_vinoprefs_t started_by_user_gshell;
type_transition myloginuser_gshell_t vinoprefs_exec_t:process myloginuser_vinoprefs_t;

typeattribute myloginuser_vinoprefs_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_vinoprefs_t reads_xdm_runtime_files;

typeattribute myloginuser_vinoprefs_t inherits_user_fd;

typeattribute myloginuser_vinoprefs_t traverses_user_tmp;
typeattribute myloginuser_vinoprefs_t creates_dconf_runtime_files;

typeattribute myloginuser_vinoprefs_t traverses_user_home_dir;

typeattribute myloginuser_vinoprefs_t traverses_config_home;
typeattribute myloginuser_vinoprefs_t reads_dconf_config_home_files;

typeattribute myloginuser_vinoprefs_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_vinoprefs_t creates_ibus_config_home_dirs;

typeattribute myloginuser_vinoprefs_t traverses_data_home;
typeattribute myloginuser_vinoprefs_t manages_gtk_bookmarks;

typeattribute myloginuser_vinoprefs_t traverses_var_lib;
typeattribute myloginuser_vinoprefs_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_vinoprefs_t reads_passwd_files;

typeattribute myloginuser_vinoprefs_t reads_fonts;

typeattribute myloginuser_vinoprefs_t reads_network_config_files;

typeattribute myloginuser_vinoprefs_t reads_urandom_device;

typeattribute myloginuser_vinoprefs_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_vinoprefs_t connects_to_user_session_bus;
typeattribute myloginuser_vinoprefs_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_vinoprefs_t chats_with_gvfsd;
typeattribute myloginuser_vinoprefs_t chats_with_atspi2;
typeattribute myloginuser_vinoprefs_t chats_with_dconf;
typeattribute myloginuser_vinoprefs_t chats_with_vinod;

typeattribute myloginuser_vinoprefs_t runs_yelp;

allow myloginuser_vinoprefs_t myloginuser_vinod_t:fd use;
allow myloginuser_vinoprefs_t myloginuser_vinod_t:fifo_file { read write getattr ioctl };
allow myloginuser_vinoprefs_t myloginuser_vinod_t:process sigchld;

allow myloginuser_vinod_t vinoprefs_exec_t:file { getattr open read execute };
allow myloginuser_vinod_t myloginuser_vinoprefs_t:process transition;
type_transition myloginuser_vinod_t vinoprefs_exec_t:process myloginuser_vinoprefs_t;

allow myloginuser_vinoprefs_t self:netlink_route_socket { write getattr read bind create nlmsg_read };
allow myloginuser_vinoprefs_t self:tcp_socket { write getopt create read connect };
allow myloginuser_vinoprefs_t self:udp_socket { write read create connect getattr };

allow myloginuser_vinoprefs_t http_port_t:tcp_socket name_connect;

########################################
#
# vinod
# 

type myloginuser_vinod_t, myloginuserprocess;
typeattribute myloginuser_vinod_t domain;
role myloginuser_r types myloginuser_vinod_t;

type vinod_exec_t, myloginuser_application_executable_type;
typeattribute vinod_exec_t file_type;
typeattribute vinod_exec_t non_security_file_type;
typeattribute vinod_exec_t non_auth_file_type;
typeattribute vinod_exec_t exec_type;
typeattribute vinod_exec_t application_exec_type;

allow myloginuser_vinod_t vinod_exec_t:file { read entrypoint };

typeattribute vinod_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_vinod_t started_by_user_gsession;
type_transition myloginuser_gsession_t vinod_exec_t:process myloginuser_vinod_t;

typeattribute myloginuser_vinod_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_vinod_t reads_xdm_runtime_files;

typeattribute myloginuser_vinod_t inherits_user_fd;

typeattribute myloginuser_vinod_t reads_iceauth_home_files;

typeattribute myloginuser_vinod_t traverses_user_tmp;
typeattribute myloginuser_vinod_t creates_dconf_runtime_files;

typeattribute myloginuser_vinod_t traverses_user_home_dir;

typeattribute myloginuser_vinod_t traverses_config_home;
typeattribute myloginuser_vinod_t reads_dconf_config_home_files;

typeattribute myloginuser_vinod_t adds_entries_to_config_home_dirs;

typeattribute myloginuser_vinod_t traverses_data_home;
typeattribute myloginuser_vinod_t manages_gtk_bookmarks;

typeattribute myloginuser_vinod_t traverses_var_lib;
typeattribute myloginuser_vinod_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_vinod_t reads_passwd_files;

typeattribute myloginuser_vinod_t reads_system_state_files;

typeattribute myloginuser_vinod_t reads_fonts;

typeattribute myloginuser_vinod_t reads_network_config_files;

typeattribute myloginuser_vinod_t reads_urandom_device;
typeattribute myloginuser_vinod_t reads_random_device;

typeattribute myloginuser_vinod_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_vinod_t connects_to_system_bus;
typeattribute myloginuser_vinod_t connects_to_user_session_bus;
typeattribute myloginuser_vinod_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_vinod_t chats_with_gvfsd;
typeattribute myloginuser_vinod_t chats_with_gshell;
typeattribute myloginuser_vinod_t chats_with_tpmc;
typeattribute myloginuser_vinod_t chats_with_atspi2;
typeattribute myloginuser_vinod_t chats_with_dconf;

typeattribute myloginuser_vinod_t connects_to_user_gkrd;

typeattribute myloginuser_vinod_t runs_yelp;

allow myloginuser_vinod_t self:netlink_route_socket { write getattr read bind create nlmsg_read };
allow myloginuser_vinod_t self:tcp_socket { bind getattr listen create setopt write read accept shutdown };
allow myloginuser_vinod_t self:udp_socket { write read create connect getattr };

allow myloginuser_vinod_t myloginuser_gsession_t:unix_stream_socket connectto;

allow myloginuser_vinod_t vnc_port_t:tcp_socket name_bind;
allow myloginuser_vinod_t node_t:tcp_socket node_bind;

########################################
#
# gsyslog
# 

type myloginuser_gsyslog_t, myloginuserprocess;
typeattribute myloginuser_gsyslog_t domain;
role myloginuser_r types myloginuser_gsyslog_t;

type gsyslog_exec_t, myloginuser_application_executable_type;
typeattribute gsyslog_exec_t file_type;
typeattribute gsyslog_exec_t non_security_file_type;
typeattribute gsyslog_exec_t non_auth_file_type;
typeattribute gsyslog_exec_t exec_type;
typeattribute gsyslog_exec_t application_exec_type;

allow myloginuser_gsyslog_t gsyslog_exec_t:file { read entrypoint };

typeattribute gsyslog_exec_t started_by_user_gshell_exec_type;
typeattribute myloginuser_gsyslog_t started_by_user_gshell;
type_transition myloginuser_gshell_t gsyslog_exec_t:process myloginuser_gsyslog_t;

typeattribute myloginuser_gsyslog_t inherits_user_fd;

typeattribute myloginuser_gsyslog_t reads_system_state_files;

typeattribute myloginuser_gsyslog_t traverses_user_home_dir;

allow myloginuser_gsyslog_t gsyslog_exec_t:file { ioctl open getattr };

########################################
#
# logview
# 

type myloginuser_logview_t, myloginuserprocess;
typeattribute myloginuser_logview_t domain;
role myloginuser_r types myloginuser_logview_t;

type logview_exec_t, myloginuser_application_executable_type;
typeattribute logview_exec_t file_type;
typeattribute logview_exec_t non_security_file_type;
typeattribute logview_exec_t non_auth_file_type;
typeattribute logview_exec_t exec_type;
typeattribute logview_exec_t application_exec_type;

allow myloginuser_logview_t logview_exec_t:file { read entrypoint };

typeattribute myloginuser_logview_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_logview_t reads_xdm_runtime_files;

typeattribute myloginuser_logview_t inherits_user_fd;

typeattribute myloginuser_logview_t traverses_admin_home_dir;
typeattribute myloginuser_logview_t adds_entries_to_admin_home_dirs;

typeattribute myloginuser_logview_t traverses_user_tmp;
typeattribute myloginuser_logview_t creates_dconf_runtime_files;

typeattribute myloginuser_logview_t traverses_config_home;
typeattribute myloginuser_logview_t reads_dconf_config_home_files;

typeattribute myloginuser_logview_t traverses_cache_home;
typeattribute myloginuser_logview_t adds_entries_to_cache_home_dirs;
typeattribute myloginuser_logview_t creates_cache_home_dirs;

typeattribute myloginuser_logview_t traverses_var_lib;
typeattribute myloginuser_logview_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_logview_t reads_passwd_files;

typeattribute myloginuser_logview_t reads_system_state_files;

typeattribute myloginuser_logview_t reads_fonts;

typeattribute myloginuser_logview_t reads_urandom_device;

typeattribute myloginuser_logview_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_logview_t connects_to_user_session_bus;
typeattribute myloginuser_logview_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_logview_t chats_with_atspi2;
typeattribute myloginuser_logview_t chats_with_dconf;

typeattribute myloginuser_logview_t runs_dbuslaunch;

allow myloginuser_logview_t myloginuser_pkexec_t:fd use;
allow myloginuser_logview_t myloginuser_pkexec_t:fifo_file { read write getattr ioctl };
allow myloginuser_logview_t myloginuser_pkexec_t:process sigchld;

allow myloginuser_pkexec_t logview_exec_t:file { getattr open read execute };
allow myloginuser_pkexec_t myloginuser_logview_t:process transition;
type_transition myloginuser_pkexec_t logview_exec_t:process myloginuser_logview_t;

allow myloginuser_logview_t myloginuser_gshell_t:process sigchld;

allow myloginuser_logview_t self:capability dac_override;

allow myloginuser_logview_t logfile:dir { getattr search open read };
allow myloginuser_logview_t logfile:file { read getattr open };
dontaudit myloginuser_logview_t auditd_log_t:dir { read getattr };

allow myloginuser_logview_t dconf_tmp_t:dir create;

optional_policy(`
	gen_require(`
		type cache_home_t;
	')

	type_transition myloginuser_logview_t cache_home_t:dir dconf_tmp_t "dconf";
')

########################################
#
# pkexec
# 

type myloginuser_pkexec_t, myloginuserprocess;
typeattribute myloginuser_pkexec_t domain;
role myloginuser_r types myloginuser_pkexec_t;

type pkexec_exec_t, myloginuser_application_executable_type;
typeattribute pkexec_exec_t file_type;
typeattribute pkexec_exec_t non_security_file_type;
typeattribute pkexec_exec_t non_auth_file_type;
typeattribute pkexec_exec_t exec_type;
typeattribute pkexec_exec_t application_exec_type;

allow myloginuser_pkexec_t pkexec_exec_t:file { read entrypoint };

typeattribute myloginuser_pkexec_t inherits_user_fd;

typeattribute myloginuser_pkexec_t traverses_admin_home_dir;

typeattribute myloginuser_pkexec_t reads_passwd_files;

typeattribute myloginuser_pkexec_t reads_init_state;
typeattribute myloginuser_pkexec_t traverses_init_runtime;

typeattribute myloginuser_pkexec_t appends_xdm_home_files;

typeattribute myloginuser_pkexec_t logs_to_system;

typeattribute myloginuser_pkexec_t connects_to_system_bus;

allow myloginuser_pkexec_t myloginuser_gsyslog_t:fd use;
allow myloginuser_pkexec_t myloginuser_gsyslog_t:fifo_file { read write getattr ioctl };
allow myloginuser_pkexec_t myloginuser_gsyslog_t:process sigchld;

allow myloginuser_gsyslog_t pkexec_exec_t:file { getattr open read execute };
allow myloginuser_gsyslog_t myloginuser_pkexec_t:process transition;
type_transition myloginuser_gsyslog_t pkexec_exec_t:process myloginuser_pkexec_t;

allow myloginuser_pkexec_t self:capability { setuid setgid audit_write };
allow myloginuser_pkexec_t self:netlink_audit_socket { nlmsg_relay write create read };

allow myloginuser_pkexec_t myloginuser_gshell_t:dir { getattr search };
allow myloginuser_pkexec_t myloginuser_gshell_t:file { read getattr open };
allow myloginuser_pkexec_t myloginuser_gshell_t:lnk_file read;

allow myloginuser_pkexec_t myloginuser_gshell_t:process sigchld;

allow myloginuser_pkexec_t myloginuser_t:key search;

optional_policy(`
	gen_require(`
		type systemd_logind_sessions_t;
	')

	allow myloginuser_pkexec_t systemd_logind_sessions_t:fifo_file write;
')

########################################
#
# policykitauth
# 

type myloginuser_policykitauth_t, myloginuserprocess;
typeattribute myloginuser_policykitauth_t domain;
role myloginuser_r types myloginuser_policykitauth_t;

typeattribute myloginuser_policykitauth_t inherits_user_fd;

typeattribute myloginuser_policykitauth_t reads_passwd_files;

typeattribute myloginuser_policykitauth_t appends_xdm_home_files;

typeattribute myloginuser_policykitauth_t connects_to_system_bus;

typeattribute myloginuser_policykitauth_t started_by_user_gshell;

allow myloginuser_policykitauth_t self:capability { setuid audit_write };
allow myloginuser_policykitauth_t self:netlink_audit_socket { nlmsg_relay write create read };

optional_policy(`
	gen_require(`
		type policykit_auth_exec_t;
	')

	typeattribute policykit_auth_exec_t started_by_user_gshell_exec_type;

	allow myloginuser_policykitauth_t policykit_auth_exec_t:file { read entrypoint };

	allow myloginuser_gshell_t policykit_auth_exec_t:file { getattr open read execute };
	type_transition myloginuser_gshell_t policykit_auth_exec_t:process myloginuser_policykitauth_t;
')

########################################
#
# chkpwd
# 

type myloginuser_chkpwd_t, myloginuserprocess;
typeattribute myloginuser_chkpwd_t domain;
role myloginuser_r types myloginuser_chkpwd_t;

typeattribute myloginuser_chkpwd_t reads_passwd_files;

typeattribute myloginuser_chkpwd_t reads_system_state_files;

allow myloginuser_chkpwd_t chkpwd_exec_t:file { read entrypoint };

allow myloginuser_chkpwd_t myloginuser_policykitauth_t:fd use;
allow myloginuser_chkpwd_t myloginuser_policykitauth_t:fifo_file { read write getattr ioctl };
allow myloginuser_chkpwd_t myloginuser_policykitauth_t:process sigchld;

allow myloginuser_policykitauth_t chkpwd_exec_t:file { getattr open read execute };
allow myloginuser_policykitauth_t myloginuser_chkpwd_t:process transition;
type_transition myloginuser_policykitauth_t chkpwd_exec_t:process myloginuser_chkpwd_t;

allow myloginuser_chkpwd_t self:capability dac_override;

allow myloginuser_chkpwd_t shadow_t:file { read getattr open };

########################################
#
# gccsearchp
# 

type myloginuser_gccsearchp_t, myloginuserprocess;
typeattribute myloginuser_gccsearchp_t domain;
role myloginuser_r types myloginuser_gccsearchp_t;

type gccsearchp_exec_t, myloginuser_application_executable_type;
typeattribute gccsearchp_exec_t file_type;
typeattribute gccsearchp_exec_t non_security_file_type;
typeattribute gccsearchp_exec_t non_auth_file_type;
typeattribute gccsearchp_exec_t exec_type;
typeattribute gccsearchp_exec_t application_exec_type;

allow myloginuser_gccsearchp_t gccsearchp_exec_t:file { read entrypoint };

typeattribute gccsearchp_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gccsearchp_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gccsearchp_exec_t:process myloginuser_gccsearchp_t;

typeattribute myloginuser_gccsearchp_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gccsearchp_t reads_xdm_runtime_files;

typeattribute myloginuser_gccsearchp_t traverses_user_home_dir;

typeattribute myloginuser_gccsearchp_t traverses_config_home;

typeattribute myloginuser_gccsearchp_t traverses_data_home;
typeattribute myloginuser_gccsearchp_t traverses_gtk_home;

typeattribute myloginuser_gccsearchp_t reads_urandom_device;

typeattribute myloginuser_gccsearchp_t connects_to_user_session_bus;
typeattribute myloginuser_gccsearchp_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gccsearchp_t chats_with_gvfsd;
typeattribute myloginuser_gccsearchp_t chats_with_gshell;
typeattribute myloginuser_gccsearchp_t chats_with_atspi2;

allow myloginuser_gccsearchp_t gccenter_exec_t:file { execute getattr };

########################################
#
# gsetdlocaleexec
# 

type myloginuser_gsetdlocaleexec_t, myloginuserprocess;
typeattribute myloginuser_gsetdlocaleexec_t domain;
role myloginuser_r types myloginuser_gsetdlocaleexec_t;

type gsetdlocaleexec_exec_t, myloginuser_application_executable_type;
typeattribute gsetdlocaleexec_exec_t file_type;
typeattribute gsetdlocaleexec_exec_t non_security_file_type;
typeattribute gsetdlocaleexec_exec_t non_auth_file_type;
typeattribute gsetdlocaleexec_exec_t exec_type;
typeattribute gsetdlocaleexec_exec_t application_exec_type;

allow myloginuser_gsetdlocaleexec_t gsetdlocaleexec_exec_t:file { read entrypoint };

typeattribute gsetdlocaleexec_exec_t started_by_user_gsession_exec_type;
typeattribute myloginuser_gsetdlocaleexec_t started_by_user_gsession;
type_transition myloginuser_gsession_t gsetdlocaleexec_exec_t:process myloginuser_gsetdlocaleexec_t;

typeattribute myloginuser_gsetdlocaleexec_t traverses_user_home_dir;

typeattribute myloginuser_gsetdlocaleexec_t reads_system_state_files;

allow myloginuser_gsetdlocaleexec_t gsetdlocaleexec_exec_t:file { ioctl open getattr };

allow myloginuser_gsetdlocaleexec_t ibus_exec_t:file { getattr execute };

########################################
#
# gsetdlocaleexec (all user gsetdlocaleexec domains)
#

allow started_by_user_gsetdlocaleexec myloginuser_gsetdlocaleexec_t:fd use;
allow started_by_user_gsetdlocaleexec myloginuser_gsetdlocaleexec_t:fifo_file { read write getattr ioctl };
allow started_by_user_gsetdlocaleexec myloginuser_gsetdlocaleexec_t:process sigchld;

allow myloginuser_gsetdlocaleexec_t started_by_user_gsetdlocaleexec_exec_type:file { getattr open read execute };
allow myloginuser_gsetdlocaleexec_t started_by_user_gsetdlocaleexec:process transition;

########################################
#
# gdocs
# 

type myloginuser_gdocs_t, myloginuserprocess;
typeattribute myloginuser_gdocs_t domain;
role myloginuser_r types myloginuser_gdocs_t;

type gdocs_exec_t, myloginuser_application_executable_type;
typeattribute gdocs_exec_t file_type;
typeattribute gdocs_exec_t non_security_file_type;
typeattribute gdocs_exec_t non_auth_file_type;
typeattribute gdocs_exec_t exec_type;
typeattribute gdocs_exec_t application_exec_type;

allow myloginuser_gdocs_t gdocs_exec_t:file { read entrypoint };

typeattribute gdocs_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gdocs_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gdocs_exec_t:process myloginuser_gdocs_t;

typeattribute myloginuser_gdocs_t runs_gjsconsole;

typeattribute myloginuser_gdocs_t traverses_user_home_dir;

typeattribute myloginuser_gdocs_t reads_system_state_files;

allow myloginuser_gdocs_t gdocs_exec_t:file { ioctl open getattr };

########################################
#
# gsettings
# 

type myloginuser_gsettings_t, myloginuserprocess;
typeattribute myloginuser_gsettings_t domain;
role myloginuser_r types myloginuser_gsettings_t;

type gsettings_exec_t, myloginuser_application_executable_type;
typeattribute gsettings_exec_t file_type;
typeattribute gsettings_exec_t non_security_file_type;
typeattribute gsettings_exec_t non_auth_file_type;
typeattribute gsettings_exec_t exec_type;
typeattribute gsettings_exec_t application_exec_type;

allow myloginuser_gsettings_t gsettings_exec_t:file { read entrypoint };

typeattribute gsettings_exec_t started_by_user_gsetdlocaleexec_exec_type;
typeattribute myloginuser_gsettings_t started_by_user_gsetdlocaleexec;
type_transition myloginuser_gsetdlocaleexec_t gsettings_exec_t:process myloginuser_gsettings_t;

typeattribute myloginuser_gsettings_t traverses_user_tmp;
typeattribute myloginuser_gsettings_t creates_dconf_runtime_files;

typeattribute myloginuser_gsettings_t traverses_user_home_dir;

typeattribute myloginuser_gsettings_t traverses_config_home;
typeattribute myloginuser_gsettings_t reads_dconf_config_home_files;

typeattribute myloginuser_gsettings_t connects_to_user_session_bus;

allow myloginuser_gsettings_t myloginuser_imsetd_t:fd use;
allow myloginuser_gsettings_t myloginuser_imsetd_t:fifo_file { read write getattr ioctl };
allow myloginuser_gsettings_t myloginuser_imsetd_t:process sigchld;

allow myloginuser_imsetd_t gsettings_exec_t:file { getattr open read execute };
allow myloginuser_imsetd_t myloginuser_gsettings_t:process transition;
type_transition myloginuser_imsetd_t gsettings_exec_t:process myloginuser_gsettings_t;

########################################
#
# gdtrackergdatam
# 

type myloginuser_gdtrackergdatam_t, myloginuserprocess;
typeattribute myloginuser_gdtrackergdatam_t domain;
role myloginuser_r types myloginuser_gdtrackergdatam_t;

type gdtrackergdatam_exec_t, myloginuser_application_executable_type;
typeattribute gdtrackergdatam_exec_t file_type;
typeattribute gdtrackergdatam_exec_t non_security_file_type;
typeattribute gdtrackergdatam_exec_t non_auth_file_type;
typeattribute gdtrackergdatam_exec_t exec_type;
typeattribute gdtrackergdatam_exec_t application_exec_type;

allow myloginuser_gdtrackergdatam_t gdtrackergdatam_exec_t:file { read entrypoint };

typeattribute gdtrackergdatam_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gdtrackergdatam_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gdtrackergdatam_exec_t:process myloginuser_gdtrackergdatam_t;

typeattribute myloginuser_gdtrackergdatam_t connects_to_user_session_bus;
typeattribute myloginuser_gdtrackergdatam_t aqcuires_service_on_user_session_bus;

########################################
#
# gdtrackerzpjm
# 

type myloginuser_gdtrackerzpjm_t, myloginuserprocess;
typeattribute myloginuser_gdtrackerzpjm_t domain;
role myloginuser_r types myloginuser_gdtrackerzpjm_t;

type gdtrackerzpjm_exec_t, myloginuser_application_executable_type;
typeattribute gdtrackerzpjm_exec_t file_type;
typeattribute gdtrackerzpjm_exec_t non_security_file_type;
typeattribute gdtrackerzpjm_exec_t non_auth_file_type;
typeattribute gdtrackerzpjm_exec_t exec_type;
typeattribute gdtrackerzpjm_exec_t application_exec_type;

allow myloginuser_gdtrackerzpjm_t gdtrackerzpjm_exec_t:file { read entrypoint };

typeattribute gdtrackerzpjm_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gdtrackerzpjm_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gdtrackerzpjm_exec_t:process myloginuser_gdtrackerzpjm_t;

typeattribute myloginuser_gdtrackerzpjm_t connects_to_user_session_bus;
typeattribute myloginuser_gdtrackerzpjm_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gdtrackerzpjm_t chats_with_goad;
typeattribute myloginuser_gdtrackerzpjm_t chats_with_gjsconsole;

########################################
#
# startpakde
# 

type myloginuser_startpakde_t, myloginuserprocess;
typeattribute myloginuser_startpakde_t domain;
role myloginuser_r types myloginuser_startpakde_t;

type startpakde_exec_t, myloginuser_application_executable_type;
typeattribute startpakde_exec_t file_type;
typeattribute startpakde_exec_t non_security_file_type;
typeattribute startpakde_exec_t non_auth_file_type;
typeattribute startpakde_exec_t exec_type;
typeattribute startpakde_exec_t application_exec_type;

allow myloginuser_startpakde_t startpakde_exec_t:file { read entrypoint };

########################################
#
# chainsaw
# 

type myloginuser_chainsaw_t, myloginuserprocess;
typeattribute myloginuser_chainsaw_t domain;
role myloginuser_r types myloginuser_chainsaw_t;

type chainsaw_exec_t, myloginuser_application_executable_type;
typeattribute chainsaw_exec_t file_type;
typeattribute chainsaw_exec_t non_security_file_type;
typeattribute chainsaw_exec_t non_auth_file_type;
typeattribute chainsaw_exec_t exec_type;
typeattribute chainsaw_exec_t application_exec_type;

allow myloginuser_chainsaw_t chainsaw_exec_t:file { read entrypoint };

########################################
#
# evolution
# 

type myloginuser_evolution_t, myloginuserprocess;
typeattribute myloginuser_evolution_t domain;
role myloginuser_r types myloginuser_evolution_t;

type evolution_exec_t, myloginuser_application_executable_type;
typeattribute evolution_exec_t file_type;
typeattribute evolution_exec_t non_security_file_type;
typeattribute evolution_exec_t non_auth_file_type;
typeattribute evolution_exec_t exec_type;
typeattribute evolution_exec_t application_exec_type;

allow myloginuser_evolution_t evolution_exec_t:file { read entrypoint };

########################################
#
# gccenter
# 

type myloginuser_gccenter_t, myloginuserprocess;
typeattribute myloginuser_gccenter_t domain;
role myloginuser_r types myloginuser_gccenter_t;

type gccenter_exec_t, myloginuser_application_executable_type;
typeattribute gccenter_exec_t file_type;
typeattribute gccenter_exec_t non_security_file_type;
typeattribute gccenter_exec_t non_auth_file_type;
typeattribute gccenter_exec_t exec_type;
typeattribute gccenter_exec_t application_exec_type;

allow myloginuser_gccenter_t gccenter_exec_t:file { read entrypoint };

########################################
#
# gboxes
# 

type myloginuser_gboxes_t, myloginuserprocess;
typeattribute myloginuser_gboxes_t domain;
role myloginuser_r types myloginuser_gboxes_t;

type gboxes_exec_t, myloginuser_application_executable_type;
typeattribute gboxes_exec_t file_type;
typeattribute gboxes_exec_t non_security_file_type;
typeattribute gboxes_exec_t non_auth_file_type;
typeattribute gboxes_exec_t exec_type;
typeattribute gboxes_exec_t application_exec_type;

allow myloginuser_gboxes_t gboxes_exec_t:file { read entrypoint };

########################################
#
# scprintappl
# 

type myloginuser_scprintappl_t, myloginuserprocess;
typeattribute myloginuser_scprintappl_t domain;
role myloginuser_r types myloginuser_scprintappl_t;

type scprintappl_exec_t, myloginuser_application_executable_type;
typeattribute scprintappl_exec_t file_type;
typeattribute scprintappl_exec_t non_security_file_type;
typeattribute scprintappl_exec_t non_auth_file_type;
typeattribute scprintappl_exec_t exec_type;
typeattribute scprintappl_exec_t application_exec_type;

allow myloginuser_scprintappl_t scprintappl_exec_t:file { read entrypoint };

########################################
#
# gpksvcpk
# 

type myloginuser_gpksvcpk_t, myloginuserprocess;
typeattribute myloginuser_gpksvcpk_t domain;
role myloginuser_r types myloginuser_gpksvcpk_t;

type gpksvcpk_exec_t, myloginuser_application_executable_type;
typeattribute gpksvcpk_exec_t file_type;
typeattribute gpksvcpk_exec_t non_security_file_type;
typeattribute gpksvcpk_exec_t non_auth_file_type;
typeattribute gpksvcpk_exec_t exec_type;
typeattribute gpksvcpk_exec_t application_exec_type;

allow myloginuser_gpksvcpk_t gpksvcpk_exec_t:file { read entrypoint };

########################################
#
# gcontacts
# 

type myloginuser_gcontacts_t, myloginuserprocess;
typeattribute myloginuser_gcontacts_t domain;
role myloginuser_r types myloginuser_gcontacts_t;

type gcontacts_exec_t, myloginuser_application_executable_type;
typeattribute gcontacts_exec_t file_type;
typeattribute gcontacts_exec_t non_security_file_type;
typeattribute gcontacts_exec_t non_auth_file_type;
typeattribute gcontacts_exec_t exec_type;
typeattribute gcontacts_exec_t application_exec_type;

allow myloginuser_gcontacts_t gcontacts_exec_t:file { read entrypoint };

########################################
#
# gtermmigr
# 

type myloginuser_gtermmigr_t, myloginuserprocess;
typeattribute myloginuser_gtermmigr_t domain;
role myloginuser_r types myloginuser_gtermmigr_t;

type gtermmigr_exec_t, myloginuser_application_executable_type;
typeattribute gtermmigr_exec_t file_type;
typeattribute gtermmigr_exec_t non_security_file_type;
typeattribute gtermmigr_exec_t non_auth_file_type;
typeattribute gtermmigr_exec_t exec_type;
typeattribute gtermmigr_exec_t application_exec_type;

allow myloginuser_gtermmigr_t gtermmigr_exec_t:file { read entrypoint };

typeattribute myloginuser_gtermmigr_t traverses_user_tmp;
typeattribute myloginuser_gtermmigr_t creates_dconf_runtime_files;

typeattribute myloginuser_gtermmigr_t traverses_user_home_dir;

typeattribute myloginuser_gtermmigr_t traverses_config_home;
typeattribute myloginuser_gtermmigr_t reads_dconf_config_home_files;

typeattribute myloginuser_gtermmigr_t connects_to_user_session_bus;
typeattribute myloginuser_gtermmigr_t chats_with_dconf;
typeattribute myloginuser_gtermmigr_t chats_with_gconfd2;

allow myloginuser_gtermmigr_t myloginuser_gtermd_t:fd use;
allow myloginuser_gtermmigr_t myloginuser_gtermd_t:fifo_file { read write getattr ioctl };
allow myloginuser_gtermmigr_t myloginuser_gtermd_t:process sigchld;

allow myloginuser_gtermd_t gtermmigr_exec_t:file { getattr open read execute };
allow myloginuser_gtermd_t myloginuser_gtermmigr_t:process transition;
type_transition myloginuser_gtermd_t gtermmigr_exec_t:process myloginuser_gtermmigr_t;

########################################
#
# gtermd
# 

type myloginuser_gtermd_t, myloginuserprocess;
typeattribute myloginuser_gtermd_t domain;
role myloginuser_r types myloginuser_gtermd_t;

type gtermd_exec_t, myloginuser_application_executable_type;
typeattribute gtermd_exec_t file_type;
typeattribute gtermd_exec_t non_security_file_type;
typeattribute gtermd_exec_t non_auth_file_type;
typeattribute gtermd_exec_t exec_type;
typeattribute gtermd_exec_t application_exec_type;

allow myloginuser_gtermd_t gtermd_exec_t:file { read entrypoint };

typeattribute gtermd_exec_t started_by_user_session_bus_exec_type;
typeattribute myloginuser_gtermd_t started_by_user_session_bus;
type_transition myloginuser_dbusd_t gtermd_exec_t:process myloginuser_gtermd_t;

type gtermd_tmp_t;
typeattribute gtermd_tmp_t file_type;
typeattribute gtermd_tmp_t tmpfile;
typeattribute gtermd_tmp_t user_tmp_type;

typeattribute myloginuser_gtermd_t runs_gptyhelper;

typeattribute myloginuser_gtermd_t connects_to_server_with_unix_stream_socket;
typeattribute myloginuser_gtermd_t reads_xdm_runtime_files;

typeattribute myloginuser_gtermd_t traverses_user_tmp;
typeattribute myloginuser_gtermd_t creates_dconf_runtime_files;

typeattribute myloginuser_gtermd_t traverses_user_home_dir;

typeattribute myloginuser_gtermd_t traverses_tmp;
typeattribute myloginuser_gtermd_t adds_entries_to_tmp_dirs;
typeattribute myloginuser_gtermd_t removes_entries_from_tmp_dirs;

typeattribute myloginuser_gtermd_t traverses_config_home;
typeattribute myloginuser_gtermd_t reads_dconf_config_home_files;

typeattribute myloginuser_gtermd_t adds_entries_to_config_home_dirs;
typeattribute myloginuser_gtermd_t creates_ibus_config_home_dirs;

typeattribute myloginuser_gtermd_t traverses_data_home;
typeattribute myloginuser_gtermd_t traverses_gtk_home;

typeattribute myloginuser_gtermd_t traverses_var_lib;
typeattribute myloginuser_gtermd_t traverses_system_dbusd_var_lib;

typeattribute myloginuser_gtermd_t traverses_devpts;

typeattribute myloginuser_gtermd_t reads_fonts;

typeattribute myloginuser_gtermd_t reads_urandom_device;

typeattribute myloginuser_gtermd_t gets_attributes_of_xattr_fs;

typeattribute myloginuser_gtermd_t connects_to_user_session_bus;
typeattribute myloginuser_gtermd_t aqcuires_service_on_user_session_bus;
typeattribute myloginuser_gtermd_t chats_with_gvfsd;
typeattribute myloginuser_gtermd_t chats_with_gshell;
typeattribute myloginuser_gtermd_t chats_with_atspi2;
typeattribute myloginuser_gtermd_t chats_with_dconf;

allow myloginuser_gtermd_t myloginuser_gptyhelper_t:process signal;
allow myloginuser_gtermd_t myloginuser_t:process { signal getpgid };

type_transition myloginuser_gtermd_t shell_exec_t:process myloginuser_t;
allow myloginuser_gtermd_t shell_exec_t:file { getattr open read execute };
allow myloginuser_gtermd_t myloginuser_t:process transition;

allow myloginuser_gtermd_t gtermd_tmp_t:file { create open read write unlink };
type_transition myloginuser_gtermd_t tmp_t:file gtermd_tmp_t;

allow myloginuser_gtermd_t ptmx_t:chr_file { read write getattr ioctl };
allow myloginuser_gtermd_t user_devpts_t:chr_file { read write ioctl open getattr };

########################################
#
# xdm
#

optional_policy(`
	gen_require(`
		type xdm_t, xdm_dbusd_t;
	')

	allow xdm_t { xrdb_exec_t dbuslaunch_exec_t gsession_exec_t gsession_chkaccel_exec_t xmodmap_exec_t }:file { read ioctl open execute execute_no_trans };
	allow xdm_t { gshell_exec_t gsetdlocaleexec_exec_t gsettings_exec_t gsetd_exec_t }:file { read ioctl open execute execute_no_trans };

	allow xdm_dbusd_t { atspi_exec_t dconf_exec_t gvfsd_afcvolmon_exec_t gvfsd_exec_t atspi2_exec_t }:file { read open execute };
	allow xdm_dbusd_t { gvfsd_udiskmon_exec_t goad_exec_t goad_exec_t gvfsd_gphotovolmon_exec_t }:file { read open execute };

	type_transition xdm_dbusd_t { atspi_exec_t dconf_exec_t gvfsd_afcvolmon_exec_t gvfsd_exec_t atspi2_exec_t }:process xdm_t;
	type_transition xdm_dbusd_t { gvfsd_udiskmon_exec_t goad_exec_t gvfsd_gphotovolmon_exec_t }:process xdm_t;

	allow xdm_t { atspi_exec_t dconf_exec_t gvfsd_afcvolmon_exec_t gvfsd_exec_t atspi2_exec_t }:file { read entrypoint };
	allow xdm_t { gvfsd_udiskmon_exec_t goad_exec_t gvfsd_gphotovolmon_exec_t }:file { read entrypoint };

	allow xdm_t { eog_exec_t nautcs_exec_t transmissiongtk_exec_t gsysmon_exec_t evince_exec_t }:file execute;
	allow xdm_t { dejadup_exec_t froller_exec_t naut_exec_t baobab_exec_t nautautor_exec_t dejadupprefs_exec_t }:file execute;
	allow xdm_t { chainsaw_exec_t dnssecmon_exec_t evinceprev_exec_t evolution_exec_t gterm_exec_t }:file execute;
	allow xdm_t { gccenter_exec_t gcontacts_exec_t gdocs_exec_t gedit_exec_t gpksvcpk_exec_t gboxes_exec_t }:file execute;
	allow xdm_t { ibus_exec_t nmappl_exec_t seahorse_exec_t vinoprefs_exec_t yelp_exec_t gsyslog_exec_t }:file execute;

	optional_policy(`
		gen_require(`
			type telepathy_mission_control_exec_t;
		')

		allow xdm_dbusd_t telepathy_mission_control_exec_t:file { read open execute };
		type_transition xdm_dbusd_t telepathy_mission_control_exec_t:process xdm_t;
		allow xdm_t telepathy_mission_control_exec_t:file { read entrypoint };
	')

	optional_policy(`
		gen_require(`
			type consolehelper_exec_t;
		')

		allow xdm_t consolehelper_exec_t:file execute;
	')

	optional_policy(`
		gen_require(`
			type games_exec_t;
		')

		allow xdm_t games_exec_t:file execute;
	')
')

optional_policy(`
        gen_require(`
                type xdm_t, xsession_exec_t;
        ')

        tunable_policy(`myloginuser_enable_xdm_login',`
	        allow xdm_t myloginuser_t:process transition;

		allow xdm_t xsession_exec_t:file { getattr open read execute };
		allow xdm_t myloginuser_t:process transition;
		dontaudit xdm_t myloginuser_t:process { noatsecure siginh rlimitinh };

		allow myloginuser_t xdm_t:fd use;
		allow myloginuser_t xdm_t:fifo_file { read write getattr ioctl };
		allow myloginuser_t xdm_t:process sigchld;

		allow xdm_t myloginuser_t:key { create search link write };

		allow myloginuser_t textrel_shlib_t:file { read open getattr execute };
	')
')

optional_policy(`
	gen_require(`
		type xdm_var_run_t;
	')

	allow reads_xdm_runtime_files xdm_var_run_t:dir { getattr search };
	allow reads_xdm_runtime_files xdm_var_run_t:file { read getattr open };
')

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	typeattribute xdm_t connects_to_user_gkrd;
	typeattribute xdm_t chats_with_gshell;
')

optional_policy(`
	gen_require(`
		type xdm_t, xdm_dbusd_t;
	')

	dontaudit { xdm_dbusd_t myloginuserprocess } xdm_t:unix_stream_socket { read write };
')

optional_policy(`
	gen_require(`
		type xdm_t;
	')

	allow xdm_t myloginuser_gkrd_t:process transition;
	allow { myloginuser_dbuslaunch_t myloginuser_gkrd_t } xdm_t:process sigchld;
')

optional_policy(`
        gen_require(`
                type iceauth_home_t, xdm_home_t;
        ')

	allow reads_iceauth_home_files iceauth_home_t:file { read getattr open };
	allow appends_xdm_home_files xdm_home_t:file { ioctl getattr lock append open };

	dontaudit myloginuserprocess xdm_home_t:file { read write };
')

########################################
#
# init
#

typeattribute init_t reads_user_state_files;
typeattribute init_t chats_with_gsetd;
typeattribute init_t gsysmon_reads_process_state;

allow reads_initrc_runtime_files initrc_var_run_t:file { getattr open read };

allow reads_init_state init_t:dir { getattr search };
allow reads_init_state init_t:file { read getattr open };
allow reads_init_state init_t:lnk_file read;

allow traverses_init_runtime init_var_run_t:dir { getattr search };

########################################
#
# xserver
#

optional_policy(`
	gen_require(`
		type xserver_t;
	')

	typeattribute xserver_t reads_user_state_files;

	allow xserver_t myloginuser_t:shm { read write unix_read unix_write getattr associate };

	allow connects_to_server_with_unix_stream_socket xserver_t:unix_stream_socket connectto;

	optional_policy(`
		gen_require(`
			type tmpfs_t;
		')

		allow connects_to_server_with_unix_stream_socket tmpfs_t:file { read write };
	')
')

########################################
#
# thumb
#

optional_policy(`
        gen_require(`
                type thumb_t, thumb_home_t;
        ')

        typeattribute thumb_t inherits_user_fd;
	typeattribute thumb_t connects_to_user_session_bus;
	typeattribute thumb_t chats_with_gvfsd;
	typeattribute thumb_t chats_with_gvfsd_metadata;
	typeattribute thumb_t chats_with_gvfsd_trash;

	allow thumb_t myloginuser_dbusd_t:dbus send_msg;

	allow traverses_thumb_home thumb_home_t:dir { getattr search };
	allow lists_thumb_home thumb_home_t:dir { read open };

	allow gets_attributes_of_thumb_home_files thumb_home_t:file getattr;

	allow manages_thumb_home thumb_home_t:dir { read write getattr search create add_name remove_name };
	allow manages_thumb_home thumb_home_t:file { rename setattr read create write getattr unlink open };

	optional_policy(`
		gen_require(`
			type cache_home_t;
		')

		type_transition manages_thumb_home cache_home_t:dir thumb_home_t "thumbnails";
	')
')

########################################
#
# numad
#

optional_policy(`
	gen_require(`
		type numad_t;
	')

	tunable_policy(`myloginuser_numad_support',`
                allow numad_t myloginuser_t:process setsched;
                allow numad_t myloginuser_t:dir { getattr search };
                allow numad_t myloginuser_t:file { read getattr open };
                allow numad_t myloginuser_t:lnk_file read;
	')
')

########################################
#
# cgred
#

optional_policy(`
        gen_require(`
                type cgred_t;
        ')

        tunable_policy(`myloginuser_cgred_support',`
                allow cgred_t myloginuser_t:dir { getattr search };
                allow cgred_t myloginuser_t:file { read getattr open };
                allow cgred_t myloginuser_t:lnk_file read;
	')
')

########################################
# 
# unconfined
#

optional_policy(`
        gen_require(`
                attribute unconfined_domain_type;
        ')

        tunable_policy(`myloginuser_unconfined_support',`
		allow unconfined_domain_type myloginuser_t:process *;
                allow unconfined_domain_type myloginuser_t:dir *;
                allow unconfined_domain_type myloginuser_t:file *;
                allow unconfined_domain_type myloginuser_t:lnk_file *;
        ')
')

########################################
# 
# ksmtuned
#

optional_policy(`
        gen_require(`
                type ksmtuned_t;
        ')

        tunable_policy(`myloginuser_ksmtuned_support',`
                allow ksmtuned_t myloginuser_t:dir { getattr search };
                allow ksmtuned_t myloginuser_t:file { read getattr open };
                allow ksmtuned_t myloginuser_t:lnk_file read;
        ')

	typeattribute ksmtuned_t gsysmon_reads_process_state;
')

########################################
#
# sshd
#

optional_policy(`
        gen_require(`
                type sshd_t, sshd_devpts_t;
        ')

        tunable_policy(`myloginuser_enable_ssh_login',`
		allow sshd_t myloginuser_t:process { dyntransition transition };

	        allow myloginuser_t sshd_t:fd use;
	        allow sshd_t myloginuser_t:key { create search link write };

	        type_change myloginuser_t sshd_devpts_t:chr_file user_devpts_t;

		allow myloginuser_t sshd_t:tcp_socket { read write getattr setopt getopt };
        	allow myloginuser_t sshd_t:unix_dgram_socket write;
        	allow myloginuser_t sshd_t:unix_stream_socket { write read };
	')
')

########################################
#
# login
#

tunable_policy(`myloginuser_enable_local_login',`
        allow local_login_t myloginuser_t:process transition;

        allow local_login_t myloginuser_t:process { siginh noatsecure rlimitinh };
        allow local_login_t myloginuser_t:key { create search link write };

        type_change myloginuser_t { tty_device_t console_device_t }:chr_file user_tty_device_t;

        allow myloginuser_t local_login_t:fd use;
        allow myloginuser_t local_login_t:fifo_file { read write getattr ioctl };
        allow myloginuser_t local_login_t:process sigchld;

        # /etc/profile.d/.* and /etc/rc.d/init.d
        allow myloginuser_t { etc_t bin_t }:dir { open read };
')

########################################
#
# miscfiles
#

dontaudit reads_fonts fonts_cache_t:dir setattr;

allow reads_fonts fonts_cache_t:dir { search getattr };
allow reads_fonts fonts_cache_t:file { read getattr open };

allow reads_fonts fonts_t:dir { read getattr open search };
allow reads_fonts fonts_t:file { read getattr open };

allow lists_system_certificates cert_t:dir { read open };

allow reads_system_certificates cert_t:dir { getattr search };
allow reads_system_certificates cert_t:file { read getattr open };
allow reads_system_certificates cert_t:lnk_file read;

allow reads_hwdata hwdata_t:dir { getattr search };
allow reads_hwdata hwdata_t:file { read getattr open };
allow reads_hwdata hwdata_t:lnk_file read;

########################################
#
# vdagent
#

optional_policy(`
	gen_require(`
		type vdagent_t, vdagent_var_run_t, mtrr_device_t;
	')

	allow vdagent_t self:capability sys_admin;

	allow myloginuser_svdagent_t vdagent_t:unix_stream_socket connectto;
	allow myloginuser_svdagent_t vdagent_var_run_t:dir { getattr search };
	allow myloginuser_svdagent_t vdagent_var_run_t:sock_file { write };

	allow vdagent_t myloginuser_svdagent_t:dir { getattr search };
	allow vdagent_t myloginuser_svdagent_t:file { getattr read open };
	allow vdagent_t myloginuser_svdagent_t:lnk_file read;

	allow vdagent_t mtrr_device_t:file { write open };
')

########################################
#
# realm
#

optional_policy(`
	gen_require(`
		type realmd_t;
	')

	typeattribute realmd_t chats_with_gshell;
')

########################################
#
# fprint
#

optional_policy(`
        gen_require(`
                type fprintd_t;
        ')

        typeattribute fprintd_t chats_with_gshell;
        typeattribute fprintd_t chats_with_policykitauth;
')

########################################
#
# networkmanager
#

optional_policy(`
        gen_require(`
                type NetworkManager_t;
        ')

        typeattribute NetworkManager_t chats_with_gshell;
        typeattribute NetworkManager_t chats_with_nmappl;
        typeattribute NetworkManager_t chats_with_tpmc;
')

########################################
#
# accountsd
#

optional_policy(`
        gen_require(`
                type accountsd_t;
        ')

        typeattribute accountsd_t chats_with_gshell;
')

########################################
#
# bluetooth
#

optional_policy(`
        gen_require(`
                type bluetooth_t;
        ')

        typeattribute bluetooth_t chats_with_gshell;
        typeattribute bluetooth_t chats_with_pulseaudio;
')

########################################
#
# devicekit
#

optional_policy(`
        gen_require(`
                type devicekit_power_t, devicekit_disk_t;
        ')

        typeattribute devicekit_power_t chats_with_gshell;
        typeattribute devicekit_power_t chats_with_gsetd;
        typeattribute devicekit_power_t chats_with_trminerfs;
	typeattribute devicekit_power_t chats_with_tpmc;

        typeattribute devicekit_disk_t chats_with_gsetd;
        typeattribute devicekit_disk_t chats_with_gvfsd_udiskmon;
')

########################################
#
# policykit
#

optional_policy(`
        gen_require(`
                type policykit_t;
        ')

        typeattribute policykit_t chats_with_gshell;
        typeattribute policykit_t chats_with_pkexec;
        typeattribute policykit_t chats_with_policykitauth;
')

########################################
#
# systemd
#

optional_policy(`
        gen_require(`
                type systemd_logind_t, systemd_localed_t, systemd_hostnamed_t;
        ')

        typeattribute systemd_logind_t chats_with_gshell;
        typeattribute systemd_logind_t chats_with_gsession;
        typeattribute systemd_logind_t chats_with_gsetd;
        typeattribute systemd_logind_t chats_with_pkexec;

        typeattribute systemd_localed_t chats_with_gsetd;

        typeattribute systemd_hostnamed_t chats_with_naut;
        typeattribute systemd_hostnamed_t chats_with_baobab;

	allow systemd_logind_t gvfs_tmp_t:dir { read getattr open rmdir };
')

########################################
#
# rtkit
#

optional_policy(`
        gen_require(`
                type rtkit_daemon_t;  
        ')

        typeattribute rtkit_daemon_t chats_with_pulseaudio;

	allow rtkit_daemon_t myloginuser_pulseaudio_t:process setsched;
')

########################################
#
# colord
#

optional_policy(`
        gen_require(`
                type colord_t;
        ')

        typeattribute colord_t chats_with_gsetd;

	allow colord_t myloginuser_gsetd_t:dir { getattr search };
	allow colord_t myloginuser_gsetd_t:file { read getattr open };
	allow colord_t myloginuser_gsetd_t:lnk_file read;
')

########################################
# 
# rpm
#

optional_policy(`
        gen_require(`
                type rpm_t;
        ')

        typeattribute rpm_t chats_with_gsetd;
')

########################################
#
# setroubleshoot
#

optional_policy(`
        gen_require(`
                type setroubleshootd_t;
        ')

        typeattribute setroubleshootd_t chats_with_seappl;
        typeattribute setroubleshootd_t gsysmon_reads_process_state;
')

########################################
#
# abrt
#

optional_policy(`
        gen_require(`
                type abrt_t;
        ')

        typeattribute abrt_t chats_with_abrtappl;
')

########################################
#
# avahi
#

optional_policy(`
        gen_require(`
                type avahi_t;
        ')

        typeattribute avahi_t chats_with_vinod;
        typeattribute avahi_t chats_with_gvfsd_dnssd;
')

########################################
#
# files
#

allow traverses_var_lib var_lib_t:dir { getattr search };

allow traverses_tmp tmp_t:dir { getattr search };
allow lists_tmp tmp_t:dir { read open };
allow adds_entries_to_tmp_dirs tmp_t:dir { write add_name };
allow removes_entries_from_tmp_dirs tmp_t:dir { write remove_name };

########################################
#
# auth
#

allow reads_passwd_files passwd_file_t:file { getattr read open };

########################################
#
# kernel
#

allow reads_system_state_files proc_t:dir { getattr search };
allow reads_system_state_files proc_t:file { getattr read open };
allow reads_system_state_files proc_t:lnk_file read;

allow reads_kernel_sysctl_files sysctl_kernel_t:file { getattr read open };
allow reads_cpu_online_files cpu_online_t:file { getattr open read };

allow lists_sysfs sysfs_t:dir { read open };

allow reads_sysfs sysfs_t:dir { getattr search };
allow reads_sysfs sysfs_t:file { read getattr open };
allow reads_sysfs sysfs_t:lnk_file read;

allow logs_to_system kernel_t:unix_dgram_socket sendto;

typeattribute kernel_t gsysmon_reads_process_state;

########################################
#
# sysnetwork
#

allow reads_network_config_files net_conf_t:file { getattr open read };

########################################
#
# devices
#

allow reads_urandom_device urandom_device_t:chr_file { getattr read open };
allow reads_random_device random_device_t:chr_file { getattr read open };

allow traverses_devpts { device_t devpts_t }:dir { getattr search };

########################################
#
# udev
#

optional_policy(`
        gen_require(`
                type udev_var_run_t;
        ')

	allow reads_udev_runtime_files udev_var_run_t:dir { read search };
	allow reads_udev_runtime_files udev_var_run_t:file { read getattr open };
')

########################################
#
# logging
#

allow logs_to_system devlog_t:sock_file write;
allow logs_to_system self:unix_dgram_socket { create connect write };

allow logs_to_system syslogd_var_run_t:dir { getattr search };
allow logs_to_system syslogd_var_run_t:sock_file write;

typeattribute syslogd_t reads_user_state_files;

########################################
# 
# filesystems
#

allow gets_attributes_of_xattr_fs fs_t:filesystem getattr;

allow traverses_cgroup cgroup_t:dir { getattr search };
allow lists_cgroup cgroup_t:dir { read open };

########################################
#
# ssh
#

optional_policy(`
	gen_require(`
		type ssh_home_t;
	')

	allow reads_ssh_home_files ssh_home_t:dir { getattr search };
	allow reads_ssh_home_files ssh_home_t:file { read getattr open };

	allow lists_ssh_home ssh_home_t:dir { read open };

        allow manages_ssh_home ssh_home_t:dir { read open getattr search create setattr write link unlink rename add_name remove_name reparent rmdir lock ioctl };
        allow manages_ssh_home ssh_home_t:file { getattr read open create setattr write append rename link unlink ioctl lock };
        type_transition manages_ssh_home user_home_dir_t:dir ssh_home_t ".ssh";

	allow adds_entries_to_ssh_home_dirs ssh_home_t:dir { write add_name };
')

########################################
#
# cups
#

optional_policy(`
	gen_require(`
		type cupsd_t, cupsd_var_run_t, cupsd_etc_t;
		type cupsd_rw_etc_t;
	')

	allow connects_to_cups cupsd_t:unix_stream_socket connectto;

	allow connects_to_cups cupsd_var_run_t:dir { getattr search };
	allow connects_to_cups cupsd_var_run_t:sock_file { write getattr };

	allow reads_cups_config_files cupsd_etc_t:dir { getattr search };
	allow reads_cups_config_files cupsd_rw_etc_t:file { read getattr open };
')

########################################
#
# systemd
#

optional_policy(`
	gen_require(`
		type systemd_logind_sessions_t, systemd_logind_var_run_t;
	')

	allow reads_logind_sessions systemd_logind_sessions_t:dir { getattr search open read };
	allow reads_logind_sessions systemd_logind_sessions_t:file { read getattr open };
	allow reads_logind_sessions systemd_logind_sessions_t:lnk_file read;

        allow reads_logind_runtime systemd_logind_var_run_t:dir { getattr search open read };
        allow reads_logind_runtime systemd_logind_var_run_t:file { read getattr open };
        allow reads_logind_runtime systemd_logind_var_run_t:lnk_file read;
')

########################################
#
# modemmanager
#

optional_policy(`
	gen_require(`
		type modemmanager_t;
	')

	typeattribute modemmanager_t chats_with_gshell;
	typeattribute modemmanager_t chats_with_nmappl;
')
